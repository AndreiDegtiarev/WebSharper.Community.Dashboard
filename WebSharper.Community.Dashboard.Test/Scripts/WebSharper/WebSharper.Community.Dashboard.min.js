(function(){"use strict";var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,_0,_1,_2,_3,_4,_5,_6,_7,_8,_9,_,$,ba,bb,bc,bd,be,bf,bg,bh,bi,bj;a=window;b=a.WebSharper=a.WebSharper||{};c=b.Community=b.Community||{};d=c.Dashboard=c.Dashboard||{};e=d.DshBase=d.DshBase||{};f=d.DshBaseReact=d.DshBaseReact||{};g=d.InPort=d.InPort||{};h=d.OutPort=d.OutPort||{};i=d.InPortNum=d.InPortNum||{};j=d.InPortStr=d.InPortStr||{};k=d.OutPortNum=d.OutPortNum||{};l=d.PortConnector=d.PortConnector||{};m=d.Worker=d.Worker||{};n=d.Sources=d.Sources||{};o=n.RandomValueSource=n.RandomValueSource||{};p=d.SrcOpenWeather=d.SrcOpenWeather||{};q=p.Forecast=p.Forecast||{};r=p.Create=p.Create||{};s=d.Widget=d.Widget||{};t=d.Widgets=d.Widgets||{};u=t.TextBox=t.TextBox||{};v=t.Chart=t.Chart||{};w=d.WorkerItem=d.WorkerItem||{};x=d.Factory=d.Factory||{};y=d.PortConnectorItem=d.PortConnectorItem||{};z=d.DshData=d.DshData||{};A=d.DshEditorCellItem=d.DshEditorCellItem||{};B=d.DshEditorRowItem=d.DshEditorRowItem||{};C=d.DshEditor=d.DshEditor||{};D=d.SourceProperty=d.SourceProperty||{};E=d.Dashboard=d.Dashboard||{};F=a.IntelliFactory;G=F&&F.Runtime;H=b&&b.UI;I=H&&H.Next;J=I&&I.Var;K=c&&c.PropertyGrid;L=K&&K.Properties;M=b&&b.Control;N=M&&M.FSharpEvent;O=b&&b.List;P=b&&b.Random;Q=b&&b.Concurrency;R=b&&b.PrintfHelpers;S=b&&b.Data;T=S&&S.TxtRuntime;U=a.FSharp;V=U&&U.Data;W=V&&V.Runtime;X=W&&W.IO;Y=b&&b.Unchecked;Z=b&&b.Arrays;_0=I&&I.View;_1=I&&I.AttrModule;_2=I&&I.Doc;_3=b&&b.Seq;_4=b&&b.Charting;_5=_4&&_4.Renderers;_6=_5&&_5.ChartJs;_7=b&&b.Operators;_8=_4&&_4.Chart;_9=_4&&_4.Pervasives;_=I&&I.Key;$=I&&I.ListModel;ba=b&&b.Option;bb=c&&c.Panel;bc=bb&&bb.Helper;bd=b&&b.Enumerator;be=bb&&bb.PanelContainer;bf=bb&&bb.LayoutManagers;bg=bb&&bb.Panel;bh=bb&&bb.TitleButton;bi=bb&&bb.Dialog;bj=K&&K.PropertyGrid;e=d.DshBase=G.Class({get_Name:function(){return this.name;}},null,e);e.New=G.Ctor(function(bk){this.name=bk;},e);f=d.DshBaseReact=G.Class({get_Name:function(){return this.name;}},null,f);f.New=G.Ctor(function(bk){this.name=J.Create$1(bk);},f);g=d.InPort=G.Class({get_Property:function(){return L.group("empty");},Disconnect:function(){var bk;this.Disconnector();bk="Port "+this.name$1+" disconnected";a.console.log(bk);this.Disconnector=function(){};},RegisterDisconnector:function(bk,bl){this._outPort=bk;this.Disconnector=bl;},get_OutPort:function(){return this._outPort;}},e,g);g.New=G.Ctor(function(bk){e.New.call(this,bk);this.name$1=bk;this.Disconnector=function(){};this._outPort=new h.New("No connection");},g);h=d.OutPort=G.Class({IsCompatible:function(bk){return false;},Connect:function(bk){return function(){};}},e,h);h.New=G.Ctor(function(bk){e.New.call(this,bk);},h);i=d.InPortNum=G.Class({get_Value:function(){return this.value;},get_Property:function(){return L["double"](this.name$2,this.value);}},g,i);i.New=G.Ctor(function(bk,bl){g.New.call(this,bk);this.name$2=bk;this.value=J.Create$1(bl);},i);j=d.InPortStr=G.Class({get_Value:function(){return this.value;},get_Property:function(){return L.string(this.name$2,this.value);}},g,j);j.New=G.Ctor(function(bk,bl){g.New.call(this,bk);this.name$2=bk;this.value=J.Create$1(bl);},j);k=d.OutPortNum=G.Class({Trigger:function(bk){this.event.event.Trigger(bk);},Connect:function(bk){var bl,bm,bn;bl=this;bm="Port "+this.name$1+" connect";a.console.log(bm);bk.Disconnect();bn=function(bo,bp){var bq;bq=bk.get_Value();return J.Set(bq,bp);};this.event.event.AddHandler(bn);return function(){bl.event.event.RemoveHandler(bn);};},IsCompatible:function(bk){return bk instanceof i;}},h,k);k.New=G.Ctor(function(bk){h.New.call(this,bk);this.name$1=bk;this.event=new N.New();},k);l=d.PortConnector=G.Class({Disconnect:function(){this.disconnector();}},e,l);l.New=G.Ctor(function(bk,bl){e.New.call(this,bk.get_Name()+"->"+bl.get_Name());this.disconnector=bk.Connect(bl);},l);m=d.Worker=G.Class({get_OutPorts:function(){return O.T.Empty;},get_InPorts:function(){return O.T.Empty;},Run:function(){},get_Properties:function(){var bk;bk=function(bl){return bl.get_Property();};return function(bl){return O.map(bk,bl);}(this.get_InPorts());}},f,m);m.New=G.Ctor(function(bk){f.New.call(this,bk);},m);o=n.RandomValueSource=G.Class({Run:function(){var bk,bl;bk=this;bl=new P.New();Q.Start(Q.Delay(function(){return Q.While(function(){return true;},Q.Delay(function(){return Q.Bind(Q.Sleep(600),function(){var bm;bm=a.Math.random()*bk.inDispersionValue.get_Value().c+bk.inMiddleValue.get_Value().c;bk.outRandomNumber.Trigger(bm);return Q.Return(null);});}));}),null);},Clone:function(){return new o.New(this.middleValue,this.dispersion);},get_OutPorts:function(){return O.ofArray([this.outRandomNumber]);},get_InPorts:function(){return O.ofArray([this.inMiddleValue,this.inDispersionValue]);}},m,o);o.New=G.Ctor(function(bk,bl){m.New.call(this,"Random");this.middleValue=bk;this.dispersion=bl;this.inMiddleValue=new i.New("Middle value",this.middleValue);this.inDispersionValue=new i.New("Dispersion",this.dispersion);this.outRandomNumber=new k.New("Random value");},o);q.New=function(bk,bl,bm,bn,bo){return{Title:bk,Description:bl,ImageUrl:bm,Temperature:bn,TemparatureMinMax:bo};};r=p.Create=G.Class({Run:function(){var bk,bl;bk=this;bl=new P.New();Q.Start(Q.Delay(function(){return Q.While(function(){return true;},Q.Delay(function(){var bm;bm=p.get(bk.inApiKey.get_Value().c,bk.inCity.get_Value().c);return Q.Bind(bm,function(bn){var bo,bp;bo=bn==null?Q.Return(null):(bp="Value generated:"+bn.$0.Title,a.console.log(bp),bk.outTempearatur.Trigger(+bn.$0.Temperature),Q.Return(null));return Q.Combine(bo,Q.Delay(function(){return Q.Bind(Q.Sleep(1000*15),function(){return Q.Return(null);});}));});}));}),null);},Clone:function(){return new r.New(this.city);},get_OutPorts:function(){return O.ofArray([this.outTempearatur]);},get_InPorts:function(){return O.ofArray([this.inApiKey,this.inCity]);}},m,r);r.New=G.Ctor(function(bk){m.New.call(this,"OpenWeatherMap");this.city=bk;this.inApiKey=new j.New("ApiKey","");this.inCity=new j.New("City",this.city);this.outTempearatur=new k.New("Temperature");},r);p.get=function(bk,bl){return Q.Delay(function(){var bm,bn;bm=((bn=function(bo,bp,bq){return bo("http://api.openweathermap.org/data/2.5/weather?q="+R.toSafe(bp)+"&units=metric&appid="+R.toSafe(bq));},(G.Curried3(bn))(a.id))(bl))(bk);a.console.log("get key city "+bm);return Q.TryWith(Q.Delay(function(){var bo;bo=T.AsyncMap(X.asyncReadTextAtRuntime(false,"C:\\Users\\Andrey\\Private\\VS_Projects\\WebSharper.Community.Dashboard\\WebSharper.Community.Dashboard","","JSON","",bm),function(bp){return Y.Equals(typeof bp,"string")?a.JSON.parse(bp):bp;});return Q.Bind(bo,function(bp){var bq;a.console.log("get key city 2");return Q.Return((bq=function(br){var bs,bt,bu,bv,bw,bx,by,bz,bA,bB,bC,bD,bE,bF,bG,bH,bI,bJ,bK,bL,bM,bN,bO;return q.New(((bs=function(bP,bQ,bR){return bP(R.toSafe(bQ)+", "+R.toSafe(bR));},(G.Curried3(bs))(a.id))((bt=(bu="name",bu in bp?{$:1,$0:bp[bu]}:null),bt==null?null:bt.$0)))((bv=bp.sys,(bw=(bx="country",bx in bv?{$:1,$0:bv[bx]}:null),bw==null?null:bw.$0))),(by=(bz="main",bz in br?{$:1,$0:br[bz]}:null),by==null?null:by.$0),(bA=function(bP,bQ){return bP("http://openweathermap.org/img/w/"+R.toSafe(bQ)+".png");},(function(bP){return function(bQ){return bA(bP,bQ);};}(a.id))((bB=(bC="icon",bC in br?{$:1,$0:br[bC]}:null),bB==null?null:bB.$0))),(bD=bp.main,(bE=(bF="temp",bF in bD?{$:1,$0:bD[bF]}:null),(bG=bE==null?null:{$:1,$0:1*bE.$0},bG==null?null:bG.$0))),[(bH=bp.main,(bI=(bJ="temp_min",bJ in bH?{$:1,$0:bH[bJ]}:null),(bK=bI==null?null:{$:1,$0:1*bI.$0},bK==null?null:bK.$0))),(bL=bp.main,(bM=(bN="temp_max",bN in bL?{$:1,$0:bL[bN]}:null),(bO=bM==null?null:{$:1,$0:1*bM.$0},bO==null?null:bO.$0)))]);},function(br){return br==null?null:{$:1,$0:bq(br.$0)};}(Z.tryHead(bp.weather))));});}),function(bo){var bp;bp=bo.message;a.console.log(bp);return Q.Return(null);});});};s=d.Widget=G.Class({},m,s);s.New=G.Ctor(function(bk){m.New.call(this,bk);},s);u=t.TextBox=G.Class({get_Number:function(){return this.inPortNumber;},Render:function(){var bk,bl,bm,bn;bk=(bl=this.get_Number().get_Value().v,_0.Map(function(bo){var bp;bp=bo<<0;return a.String(bp);},bl));bm=[_1.Class("bigvalue")];bn=[_2.TextView(bk)];return _2.Element("div",bm,bn);},Clone:function(){return new u.New();},get_InPorts:function(){return O.ofArray([this.inPortNumber]);}},s,u);u.New=G.Ctor(function(){s.New.call(this,"Text");this.inPortNumber=new i.New("in Value",0);},u);v=t.Chart=G.Class({observe:function(bk){var bl,bm,bn;bl=this;this.values.push(bk);this.values.length>this.chartBufferSize?bm=this.values.shift():void 0;bn=function(bo,bp){return bl.chart.__UpdateData(bo,function(){return bp;});};(function(bo){_3.iteri(bn,bo);}(this.values));},get_Cy:function(){return this.inPortCy;},get_Cx:function(){return this.inPortCx;},get_Chart:function(){return this.chart;},Render:function(){return _6.Render$8(this.get_Chart(),{$:1,$0:{$:0,$0:this.get_Cx().get_Value().c<<0,$1:this.get_Cy().get_Value().c<<0}},null,null);},Clone:function(){return new v.New(this.cx,this.cy,this.chartBufferSize);},get_InPorts:function(){return O.ofArray([this.inPortNumber,this.inPortCx,this.inPortCy]);}},s,v);v.New=G.Ctor(function(bk,bl,bm){var bn,bo,bp,bq,br;bn=this;s.New.call(this,"Chart");this.cx=bk;this.cy=bl;this.chartBufferSize=bm;bo=O.ofSeq(_3.delay(function(){return _3.map(function(){return 0;},_7.range(0,bn.chartBufferSize-1));}));this.values=(bp=[],(bq=function(bs){bp.push(bs);},function(bs){_3.iter(bq,bs);}(bo),bp));this.chart=_8.Line(bo).__WithFillColor(new _9.Color({$:2,$0:"white"}));this.inPortCx=new i.New("cx",this.cx);this.inPortCy=new i.New("cy",this.cy);this.inPortNumber=new i.New("in Value",0);br=this.inPortNumber.get_Value().v;_0.Sink(function(bs){bn.observe(bs);},br);},v);w.Create=function(bk){return w.New(_.Fresh(),bk);};w.New=function(bk,bl){return{Key:bk,Worker:bl};};x=d.Factory=G.Class({RegisterEvent:function(bk){this.EventItems.Append(w.Create(bk));},RegisterWidget:function(bk){this.WidgetItems.Append(w.Create(bk));}},null,x);x.get_Create=function(){var bk,bl;return x.New((bk=O.T.Empty,$.Create(function(bm){return bm.Key;},bk)),(bl=O.T.Empty,$.Create(function(bm){return bm.Key;},bl)));};x.New=function(bk,bl){return new x({EventItems:bk,WidgetItems:bl});};y.Create=function(bk){return y.New(_.Fresh(),bk);};y.New=function(bk,bl){return{Key:bk,PortConnector:bl};};z=d.DshData=G.Class({ConnectPorts:function(bk,bl){var bm;bm=new l.New(bk,bl);this.PortConnectorItems.Append(y.Create(bm));},RegisterWidget:function(bk){var bl;bl=w.Create(bk);this.WidgetItems.Append(bl);this.WorkItems.Append(bl);},RegisterEvent:function(bk){var bl;bl=w.Create(bk);this.EventItems.Append(bl);this.WorkItems.Append(bl);}},null,z);z.get_Create=function(){var bk,bl,bm,bn;return z.New((bk=O.T.Empty,$.Create(function(bo){return bo.Key;},bk)),(bl=O.T.Empty,$.Create(function(bo){return bo.Key;},bl)),(bm=O.T.Empty,$.Create(function(bo){return bo.Key;},bm)),(bn=O.T.Empty,$.Create(function(bo){return bo.Key;},bn)));};z.New=function(bk,bl,bm,bn){return new z({WorkItems:bk,WidgetItems:bl,EventItems:bm,PortConnectorItems:bn});};A=d.DshEditorCellItem=G.Class({Render:function(bk,bl){var bm,bn,bo,bp,bq,br,bs,bt,bu,bv,bw,bx,by,bz,bA,bB,bC,bD,bE,bF,bG,bH,bI,bJ,bK,bL,bM,bN,bO;bm=this;bn=this.OptWorker.v;_0.Sink(function(bP){var bQ,bR,bS,bT,bU;if(bP==null);else{bQ=bP.$0;bR=bm.OptInPort;bS=O.tryHead(bQ.Worker.get_InPorts());J.Set(bR,bS);bT=bm.OptOutPort;bU=O.tryHead(bQ.Worker.get_OutPorts());J.Set(bT,bU);bl();}},bn);bo=this.OptInPort.v;_0.Sink(function(){bl();},bo);bp=this.OptOutPort.v;_0.Sink(function(){bl();},bp);bq=(br=(bs=this.OptWorker.v,_0.Map(function(bP){var bQ,bR,bS;return bP==null?O.ofArray([null]):(bQ=bP.$0,(bR=(bS=function(bT){return{$:1,$0:bT};},function(bT){return O.map(bS,bT);}(bQ.Worker.get_InPorts())),bR.get_Length()>0?bR:O.ofArray([null])));},bs)),(bt=(bu=this.OptWorker.v,_0.Map(function(bP){var bQ,bR,bS;return bP==null?O.ofArray([null]):(bQ=bP.$0,(bR=(bS=function(bT){return{$:1,$0:bT};},function(bT){return O.map(bS,bT);}(bQ.Worker.get_OutPorts())),bR.get_Length()>0?bR:O.ofArray([null])));},bu)),(bv=(bw=bk.WorkItems.v,_0.Map(function(bP){var bQ;return new O.T({$:1,$0:null,$1:(bQ=function(bR){return{$:1,$0:bR};},function(bR){return O.map(bQ,bR);}(O.ofSeq(bP)))});},bw)),(bx=[(by=[(bz=[(bA=[_1.Class("form-control")],(bB=this.OptInPort,_2.SelectDyn(bA,function(bP){var bQ;bQ=function(bR,bS){return bS.get_Name();};return function(bR){return ba.fold(bQ," ",bR);}(bP);},br,bB)))],_2.Element("td",[],bz)),(bC=[(bD=[_1.Class("form-control")],(bE=this.OptWorker,_2.SelectDyn(bD,function(bP){var bQ;bQ=function(bR,bS){return bS.Worker.get_Name().c;};return function(bR){return ba.fold(bQ," ",bR);}(bP);},bv,bE)))],_2.Element("td",[],bC)),(bF=[(bG=[_1.Class("form-control")],(bH=this.OptOutPort,_2.SelectDyn(bG,function(bP){var bQ;bQ=function(bR,bS){return bS.get_Name();};return function(bR){return ba.fold(bQ," ",bR);}(bP);},bt,bH)))],_2.Element("td",[],bF))],_2.Element("tr",[],by))],_2.Element("table",[],bx)))));bI=[_1.Class("td DshEditorCell")];bJ=[(bK=[_1.Class("div DshEditorCell")],(bL=[(bM=[(bN=[(bO=[bc.IconNormal("add",function(){})],_2.Element("td",[],bO)),_2.Element("td",[],[bq])],_2.Element("tr",[],bN))],_2.Element("table",[],bM))],_2.Element("div",bK,bL)))];return _2.Element("td",bI,bJ);}},null,A);A.get_Create=function(){return A.New(_.Fresh(),J.Create$1(null),J.Create$1(null),J.Create$1(null));};A.New=function(bk,bl,bm,bn){return new A({Key:bk,OptInPort:bl,OptWorker:bm,OptOutPort:bn});};B=d.DshEditorRowItem=G.Class({Render:function(bk,bl){var bm,bn,bo,bp,bq;bm=this;bn=(bo=function(br){return br.Key;},(bp=function(br){return br.Render(bk,bl);},function(br){return _2.ConvertBy(bo,bp,br);})(this.CellItems.v));bq=[bn,bc.IconNormal("add",function(){bm.CellItems.Append(A.get_Create());})];return _2.Element("tr",[],bq);}},null,B);B.get_Create=function(){var bk;return B.New(_.Fresh(),(bk=O.T.Empty,$.Create(function(bl){return bl.Key;},bk)));};B.New=function(bk,bl){return new B({Key:bk,CellItems:bl});};C=d.DshEditor=G.Class({Render:function(bk){var bl,bm,bn,bo,bp,bq,br;bl=this;bm=(bn=function(bs){return bs.Key;},(bo=function(bs){var bt;bt=[bs.Render(bk,function(){bl.Reconnect(bk,void 0);})];return _2.Element("tr",[],bt);},function(bs){return _2.ConvertBy(bn,bo,bs);})(this.RowItems.v));bp=[bm,(bq=[(br=[bc.IconNormal("add",function(){bl.RowItems.Append(B.get_Create());})],_2.Element("td",[],br))],_2.Element("tr",[],bq))];return _2.Element("table",[],bp);},Reconnect:function(bk,bl){var bm,bn;bm=function(bo){bo.PortConnector.Disconnect();};(function(bo){_3.iter(bm,bo);}(bk.PortConnectorItems));bk.PortConnectorItems.Clear();bn=function(bo){var bp,bq,br;bp=O.ofSeq(bo.CellItems);bq=O.ofSeq(_7.range(1,bp.get_Length()-1));br=bd.Get(bq);try{while(br.MoveNext())(function(){var bs,bt,bu,bv,bw;bs=br.Current();bt=bp.get_Item(bs-1);bu=bp.get_Item(bs);bv=(bw=function(bx){var by;by=function(bz){bk.ConnectPorts(bx,bz);};return function(bz){return bz==null?null:{$:1,$0:by(bz.$0)};}(bu.OptInPort.c);},function(bx){return bx==null?null:{$:1,$0:bw(bx.$0)};}(bt.OptOutPort.c));}());}finally{if("Dispose"in br)br.Dispose();}};(function(bo){O.iter(bn,bo);}(O.ofSeq(this.RowItems)));}},null,C);C.get_Create=function(){var bk;return C.New((bk=O.T.Empty,$.Create(function(bl){return bl.Key;},bk)));};C.New=function(bk){return new C({RowItems:bk});};D=d.SourceProperty=G.Class({WebSharper_Community_PropertyGrid_IProperty$get_Render:function(){var bk,bl,bm,bn,bo,bp,bq,br,bs,bt,bu;bk=this;bl=O.concat((bm=function(bv){var bw;bw=function(bx){return[bv,bx];};return function(bx){return O.map(bw,bx);}(bv.Worker.get_OutPorts());},function(bv){return O.map(bm,bv);}(O.ofSeq(this.data.WorkItems))));return bl.get_Length()>0?(bn=(bo=(bp=function(bv,bw){return Y.Equals(bw,bk.receiver.get_InPorts().get_Item(0).get_OutPort());},function(bv){return _3.tryFind(function(bw){return bp(bw[0],bw[1]);},bv);}(bl)),(bo!=null?bo.$==1:false)?bo.$0:O.head(bl)),(bq=J.Create$1(bn),(br=function(bv,bw){bk.data.ConnectPorts(bw,bk.receiver.get_InPorts().get_Item(0));},(bs=bq.v,_0.Sink(function(bv){return br(bv[0],bv[1]);},bs),bt=[_1.Class("form-control")],bu=function(bv,bw){return bv.Worker.get_Name().c+"\\"+bw.get_Name();},_2.Select(bt,function(bv){return bu(bv[0],bv[1]);},bl,bq))))):_2.TextNode("No sources defined");},WebSharper_Community_PropertyGrid_IProperty$get_Name:function(){return"Source";}},null,D);D.New=G.Ctor(function(bk,bl){this.data=bk;this.receiver=bl;},D);E=d.Dashboard=G.Class({get_Render:function(){var bk,bl,bm,bn,bo,bp,bq,br,bs,bt,bu,bv,bw,bx,by,bz,bA,bB,bC,bD,bE,bF,bG,bH;function bI(bJ,bK){var bL,bM,bN;bL=J.Create$1(bJ);return[bL,(bM=[_1.DynamicStyle("display",(bN=bL.v,_0.Map(function(bO){return bO?"initial":"none";},bN)))],_2.Element("div",bM,[bK]))];}bk=this;bl=(bm=[(bn=function(bJ){return bJ.Key;},(bo=function(bJ){var bK,bL,bM;bK=[(bL=bc.AttrsClick(function(){bk.PropertyGrid.Edit(bJ.Worker.get_Properties());}),(bM=[_2.TextView(bJ.Worker.get_Name().v)],_2.Element("i",bL,bM)))];return _2.Element("tr",[],bK);},function(bJ){return _2.ConvertBy(bn,bo,bJ);})(this.Data.EventItems.v))],_2.Element("table",[],bm));bp=O.ofArray([["Board",bI(true,this.PanelContainer.get_Render())],["Events",bI(false,bl)],["Rules",bI(false,this.DshEditor.Render(this.Data))]]);bq=(br=function(bJ,bK){var bL,bM,bN,bO,bP;bL=bK[0];bM=[(bN=[_1.DynamicStyle("Color",(bO=bL.v,_0.Map(function(bQ){return bQ?"#FB8C00":"#7D4600";},bO))),_1.Style("cursor","pointer"),_1.Handler("click",function(){return function(){var bQ;bk.PropertyGrid.Edit(O.T.Empty);bQ=function(bR,bS){var bT;bT=bS[0];!Y.Equals(bT,bL)?J.Set(bT,false):J.Set(bT,true);};return function(bR){O.iter(function(bS){return bQ(bS[0],bS[1]);},bR);}(bp);};})],(bP=[_2.TextNode(bJ)],_2.Element("td",bN,bP)))];return _2.Element("tr",[],bM);},function(bJ){return O.map(function(bK){return br(bK[0],bK[1]);},bJ);}(bp));bs=(bt=function(bJ,bK){return bK[1];},function(bJ){return O.map(function(bK){return bt(bK[0],bK[1]);},bJ);}(bp));bu=[(bv=[(bw=[(bx=[_1.Style("vertical-align","top")],(by=[(bz=_3.concat([O.ofArray([(bA=[(bB=[bc.IconNormal("dehaze",function(){})],_2.Element("td",[],bB))],_2.Element("tr",[],bA)),(bC=[(bD=[bc.IconNormal("add",function(){var bJ,bK,bL,bM,bN,bO,bP,bQ,bR,bS,bT;bJ=bp.get_Item(0);bK=bJ[1][0];bL=bp.get_Item(1);bM=bL[1][0];bM.c?(bN=O.ofSeq(bk.Factory.EventItems),bO=J.Create$1(O.head(bN)),bP=bk.Dialog,bQ=(bR=[(bS=[_1.Class("form-control")],_2.Select(bS,function(bU){return bU.Worker.get_Name().c;},bN,bO))],_2.Element("div",[],bR)),bP.ShowDialog("Select source",bQ,function(){var bU;bU=bO.c.Worker.Clone();bk.Data.RegisterEvent(bU);bU.Run();})):bK.c?bT=bk.CreatePanel("Panel",700,{$:1,$0:function(){}}):void 0;})],_2.Element("td",[],bD))],_2.Element("tr",[],bC)),(bE=[_2.Element("td",[],[])],_2.Element("tr",[],bE)),(bF=[(bG=[this.PropertyGrid.get_Render()],_2.Element("td",[],bG))],_2.Element("tr",[],bF))]),bq]),_2.Element("table",[],bz))],_2.Element("td",bx,by))),_2.Element("td",[],bs)],_2.Element("tr",[],bw))],_2.Element("table",[],bv)),(bH=[this.Dialog.get_Render()],_2.Element("div",[],bH))];return _2.Element("div",[],bu);},CreatePanel:function(bk,bl,bm){var bn,bo,bp,bq,br;bn=this;bo=(bp=this.Factory.WidgetItems.v,(bq=this.Data.WidgetItems.key,_2.ConvertBy(bq,function(bs){var bt,bu;bt=bs.Worker.get_Name().v;bu=[_2.TextView(bt)];return _2.Element("div",[],bu);},bp)));br=be.get_Create().WithLayoutManager(bf.StackPanelLayoutManager()).WithAttributes([_1.Style("border","1px solid white"),_1.Style("display","flex")]);this.PanelContainer.AddPanel(bg.get_Create().WithPannelAttrs([_1.Style("Width",a.String(bl)+"px"),_1.Style("position","absolute")]).WithTitleContent(_2.TextNode(bk)).WithTitleButtons(O.ofArray([bh.New("add",function(bs){var bt,bu,bv,bw,bx,by;bt=O.ofSeq(bn.Factory.WidgetItems);bu=J.Create$1(O.head(bt));bv=bn.Dialog;bw=(bx=[(by=[_1.Class("form-control")],_2.Select(by,function(bz){return bz.Worker.get_Name().c;},bt,bu))],_2.Element("div",[],bx));bv.ShowDialog("Select widget",bw,function(){a.console.log("Dialog.IsOK");bn.RegisterWidget(bs.Children,bu.c.Worker.Clone());});}),bh.New("edit",function(bs){a.console.log("Edit");bs.EditProperties(bn.PropertyGrid);}),bh.New("clear",function(bs){bn.PanelContainer.PanelItems.Remove(bn.PanelContainer.FindPanelItem(bs));})])).WithChildPanelContainer(br).WithOnAfterRender(_7.DefaultArg(bm,function(){})));return br;},RegisterWidget:function(bk,bl){this.Data.RegisterWidget(bl);bk.AddPanel(bg.get_Create().WithTitle(false).WithPanelContent(bl instanceof s?bl.Render():_2.Element("div",[],[])).WithProperties(new O.T({$:1,$0:new D.New(this.Data,bl),$1:bl.get_Properties()})));}},null,E);E.Create=function(bk){var bl,bm,bn;bl=bi.get_Create();bm=x.get_Create();bn=z.get_Create();return E.New(bm,bn,bk,C.get_Create(),bj.get_Create(),bl);};E.New=function(bk,bl,bm,bn,bo,bp){return new E({Factory:bk,Data:bl,PanelContainer:bm,DshEditor:bn,PropertyGrid:bo,Dialog:bp});};}());
