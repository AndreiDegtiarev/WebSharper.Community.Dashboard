(function(){"use strict";var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F;a=window;b=a.WebSharper=a.WebSharper||{};c=b.Community=b.Community||{};d=c.Dashboard=c.Dashboard||{};e=d.Test=d.Test||{};f=e.AppModel=e.AppModel||{};g=e.AppData=e.AppData||{};h=e.Client=e.Client||{};i=a.IntelliFactory;j=i&&i.Runtime;k=d&&d.AppModelLib;l=b&&b.Operators;m=b&&b.List;n=d&&d.MessageBus;o=b&&b.Remoting;p=o&&o.AjaxRemotingProvider;q=d&&d.RuleEntry;r=c&&c.Panel;s=r&&r.Helper;t=d&&d.RandomRunner;u=d&&d.TextBoxRenderer;v=d&&d.ChartRenderer;w=r&&r.PanelData;x=d&&d.RuleContainer;y=d&&d.RuleChain;z=d&&d.App;A=b&&b.UI;B=A&&A.Next;C=B&&B.Doc;D=a.console;E=B&&B.Var;F=b&&b.Strings;f=e.AppModel=j.Class({get_Worker:function(){return this.$0.get_Worker();}},null,f);f.ToWorker=function(G){return f.FromDataContext(G).get_Worker();};f.FromWorker=function(G){var H;H=k.FromWorker(G);return H!=null&&H.$==1?new f({$:0,$0:H.$0}):l.FailWith("AllTypes FromWorker unknown type");};f.FromDataContext=function(G){var H;H=k.FromDataContext(G);return H!=null&&H.$==1?H.$0:l.FailWith("AllTypes FromDataContext unknown type");};g=e.AppData=j.Class({get_RecreateOnServer:function(){var G;function H(M,N){return N;}function I(M,N){return N;}function J(M,N,O){return O;}function K(M,N,O){return O;}function L(M,N){N.Reconnect(G);}G=m.map(function(M){return M.WithStartRunner();},m.append(m.map(function(M){return H(M[0],M[1]);},m.concat(m.map(function(M){return I(M[0],M[1]);},this.RecreateEvents(a.id)))),m.map(function(M){return J(M[0],M[1],M[2]);},m.concat(m.map(function(M){return K(M[0],M[1],M[2]);},this.get_RecreateWidgets())))));m.iter(function(M){return L(M[0],M[1]);},this.Rules);},RecreateOnClient:function(G,H){var I;n.set_Role(n.Role.Client);I=n.Agent();I.mailbox.AddLast({$:3,$0:function(J){(new p.New()).Send("WebSharper.Community.Dashboard:WebSharper.Community.Dashboard.MessageBus.SendToServer:-1358505674",[J]);}});I.resume();G.Restore(H,this.RecreateEvents(a.id),this.get_RecreateWidgets(),this.Rules);},Recreate:function(G,H){G.Restore(H,this.RecreateEvents(function(I){return I.WithStartRunner();}),this.get_RecreateWidgets(),this.Rules);},get_RecreateWidgets:function(){function G(H,I,J){function K(L,M,N){return[L,M,N.get_Worker()];}return[H,I,m.map(function(L){return K(L[0],L[1],L[2]);},J)];}return m.map(function(H){return G(H[0],H[1],H[2]);},this.Widgets);},RecreateEvents:function(G){function H(I,J){function K(L,M){return[L,G(M.get_Worker())];}return[I,m.map(function(L){return K(L[0],L[1]);},J)];}return m.map(function(I){return H(I[0],I[1]);},this.Events);}},null,g);g.Create=function(G){var H;H=G.Store(f.FromWorker);return g.New(H[0],H[1],H[2]);};g.New=function(G,H,I){return new g({Events:G,Widgets:H,Rules:I});};h.Main=function(G){var H,I;function J(){var M,N,O,P,Q,R;function S(T){var U;U=T.get_Worker();return[[U.Key,M,T],q.New(U.InPorts.get_Item(0).Key,"",U.Key)];}g.Create(I);M=s.UniqueKey();N=new f({$:0,$0:new k({$:0,$0:t.Create(100,50)})});O=N.get_Worker();P=S(new f({$:0,$0:new k({$:3,$0:u.get_Create()})}));Q=S(new f({$:0,$0:new k({$:4,$0:v.Create(300,150,50)})}));R=m.ofArray([w.Create(M,0,0,m.T.Empty)]);g.New(m.ofArray([["main",m.ofArray([[O.Key,N]])]]),m.ofArray([["main",R,m.ofArray([P[0],Q[0]])]]),m.ofArray([["main",x.New(m.ofArray([y.New(m.ofArray([q.New(O.InPorts.get_Item(0).Key,O.OutPorts.get_Item(0).Key,O.Key),P[1]])),y.New(m.ofArray([q.New(O.InPorts.get_Item(0).Key,O.OutPorts.get_Item(0).Key,O.Key),Q[1]]))]))]])).Recreate(I,function(){return z.PanelContainerCreator();});}function K(M){var N;N=(new p.New()).Sync("WebSharper.Community.Dashboard.Test:WebSharper.Community.Dashboard.Test.Server.LoadFromFile:-133840407",[M]);N.RecreateOnClient(I,function(){return z.PanelContainerCreator();});(new p.New()).Send("WebSharper.Community.Dashboard.Test:WebSharper.Community.Dashboard.Test.Server.RecreateOnServer:-1126735520",[N]);n.RunServerRequests();}function L(M){return C.Element("td",[],M);}n.set_Log(function(M){D.log(M);});H=E.Create$1("Dashboard");I=z.CreateDashboard();return C.Element("div",[],[I.Render(C.Element("div",[],[L(m.ofArray([s.TxtIconNormal("build","Sample configuration",function(){J();})])),L(m.ofArray([C.TextNode("File name"),C.Input([],H)])),L(m.ofArray([s.TxtIconNormal("archive","Upload",function(){(new p.New()).Send("WebSharper.Community.Dashboard.Test:WebSharper.Community.Dashboard.Test.Server.SaveToFile:-1567987319",[H.c,g.Create(I)]);})])),L(m.ofArray([s.TxtIconNormal("unarchive","Download  and run on client",function(){(new p.New()).Sync("WebSharper.Community.Dashboard.Test:WebSharper.Community.Dashboard.Test.Server.LoadFromFile:-133840407",[H.c]).Recreate(I,function(){return z.PanelContainerCreator();});})])),L(m.ofArray([s.TxtIconNormal("cloud_upload","Download and run on server",function(){K(H.c);})]))]))]).OnAfterRender(function(){if(!F.IsNullOrWhiteSpace(G.ConfigurationName))K(G.ConfigurationName);});};}());
