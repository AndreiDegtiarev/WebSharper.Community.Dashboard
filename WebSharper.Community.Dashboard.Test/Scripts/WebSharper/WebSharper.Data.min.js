(function(){"use strict";var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D;a=window;b=a.WebSharper=a.WebSharper||{};c=b.Data=b.Data||{};d=c.Pervasives=c.Pervasives||{};e=c.WBRuntime=c.WBRuntime||{};f=e.WorldBankCountry=e.WorldBankCountry||{};g=e.WorldBankRuntime=e.WorldBankRuntime||{};h=b&&b.Obj;i=a.FSharp=a.FSharp||{};j=i.Data=i.Data||{};k=j.Runtime=j.Runtime||{};l=k.WorldBank=k.WorldBank||{};m=l.Indicator=l.Indicator||{};n=c.JSRuntime=c.JSRuntime||{};o=c.TxtRuntime=c.TxtRuntime||{};p=k.IO=k.IO||{};q=b&&b.Strings;r=a.System;s=r&&r.Guid;t=b&&b.Concurrency;u=a.jQuery;v=b&&b.List;w=b&&b.JavaScript;x=w&&w.Pervasives;y=b&&b.Arrays;z=a.IntelliFactory;A=z&&z.Runtime;B=b&&b.Operators;C=a.Array;D=b&&b.Unchecked;d.randomFunctionName=function(){var E;return q.ReplaceChar((E=s.NewGuid(),a.String(E)).toLowerCase(),"-","_");};f.New=function(E,F,G){return{Context:E,Code:F,Name:G};};g.AsyncGetIndicator=function(E,F){return t.FromContinuations(function(G,H){var I,J;I=d.randomFunctionName();u.ajax((J={},J.url=e.worldBankUrl(E.Context,v.ofArray(["countries",E.Code,"indicators",F]),v.ofArray([["date","1900:2050"],["format","jsonp"]])),J.dataType="jsonp",J.jsonp="prefix",J.jsonpCallback="jsonp"+I,J.error=function(K,L,M){return H(a.Error(L+M));},J.success=function(K){return G(x.NewFromSeq(y.choose(function(L){return L.value==null?null:{$:1,$0:[L.date,L.value]};},y.get(K,1)).slice().reverse()));},J));});};g.GetIndicators=a.id;g.GetCountry=function(E,F,G){return f.New(E,F,G);};e.worldBankUrl=function(E,F,G){function H(I,J){return"&"+I+"="+a.encodeURIComponent(J);}return E.serviceUrl+"/"+q.concat("",v.map(function(I){return"/"+a.encodeURIComponent(I);},F))+"?per_page=1000"+q.concat("",v.map(function(I){return H(I[0],I[1]);},G));};m=l.Indicator=A.Class({TryGetValueAt:function(E){var F;F=this[a.String(E)];return F==void 0?null:{$:1,$0:F};}},h,m);n.GetArrayChildByTypeTag=function(E,F,G){var H;H=n.GetArrayChildrenByTypeTag(E,F,G,a.id);return y.length(H)===1?y.get(H,0):B.FailWith("JSON mismatch: Expected single value, but found multiple.");};n.TryGetArrayChildByTypeTag=function(E,F,G,H){var I;I=n.GetArrayChildrenByTypeTag(E,F,G,H);return y.length(I)===1?{$:1,$0:y.get(I,0)}:y.length(I)===0?null:B.FailWith("JSON mismatch: Expected Array with single or no elements.");};n.TryGetValueByTypeTag=function(E,F,G,H){var I;I=n.matchTag(G,E);return I==null?null:{$:1,$0:H(I.$0)};};n.GetArrayChildrenByTypeTag=function(E,F,G,H){return C.isArray(E)?y.map(function(I){return H(a.id(I));},y.choose(function(I){return n.matchTag(G,I);},E)):B.FailWith("JSON mismatch: Expected Array node");};n.matchTag=function(E,F){var G;return F==null?null:D.Equals(typeof F,"boolean")&&E==="Boolean"?{$:1,$0:F}:D.Equals(typeof F,"number")&&E==="Number"?{$:1,$0:F}:D.Equals(typeof F,"string")&&E==="Number"?(G=1*F,a.isNaN(G)?null:{$:1,$0:G}):D.Equals(typeof F,"string")&&E==="String"?{$:1,$0:F}:C.isArray(F)&&E==="Array"?{$:1,$0:F}:D.Equals(typeof F,"object")&&E==="Record"?{$:1,$0:F}:null;};o.AsyncMap=function(E,F){var G;G=null;return t.Delay(function(){return t.Bind(E,function(H){return t.Return(F(H));});});};p.asyncReadTextAtRuntimeWithDesignTimeRules=function(E,F,G,H,I){return p.asyncReadTextAtRuntime(false,E,F,G,H,I);};p.asyncReadTextAtRuntime=function(E,F,G,H,I,J){function K(L,M){var N,O,P,Q,R;N=(O=J.toLowerCase(),q.StartsWith(O,"jsonp|")?[J.substring(6),true]:q.StartsWith(O,"json|")?[J.substring(5),false]:[J,false]);P=(Q={},Q.dataType="json",Q.success=function(S){return L(S);},Q.error=function(S,T,U){return M(a.Error(U));},Q);N[1]?(R=d.randomFunctionName(),P.dataType="jsonp",P.jsonp="prefix",P.jsonpCallback="jsonp"+R):void 0;u.ajax(N[0],P);}return t.FromContinuations(function(L,M,N){return K.apply(null,[L,M,N]);});};}());
