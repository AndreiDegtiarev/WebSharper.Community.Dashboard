(function(){"use strict";var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F;a=window;b=a.WebSharper=a.WebSharper||{};c=b.Community=b.Community||{};d=c.Panel=c.Panel||{};e=d.Helper=d.Helper||{};f=d.WrapControlsAligment=d.WrapControlsAligment||{};g=d.WrapControls=d.WrapControls||{};h=d.PanelData=d.PanelData||{};i=d.TitleButton=d.TitleButton||{};j=d.Panel=d.Panel||{};k=d.PanelContainer=d.PanelContainer||{};l=d.Rect=d.Rect||{};m=d.LayoutManagers=d.LayoutManagers||{};n=a.StartupCode$WebSharper_Community_Panel$LayoutManagers=a.StartupCode$WebSharper_Community_Panel$LayoutManagers||{};o=d.Dialog=d.Dialog||{};p=b&&b.List;q=b&&b.Seq;r=b&&b.Unchecked;s=a.System;t=s&&s.Guid;u=b&&b.UI;v=u&&u.Next;w=v&&v.Doc;x=v&&v.AttrModule;y=v&&v.Var;z=v&&v.View;A=a.IntelliFactory;B=A&&A.Runtime;C=v&&v.Input;D=C&&C.Mouse;E=v&&v.ListModel;F=a.console;e.MoveItemInModelList=function(G,H,I){var J,K,L,M;J=p.ofSeq(G);K=H?q.findIndex(function(N){return r.Equals(N,I);},J)+1:q.findIndex(function(N){return r.Equals(N,I);},J)-1;K>=0&&K<J.get_Length()?(G.Clear(),L=p.splitAt(K,p.filter(function(N){return!r.Equals(N,I);},J)),M=L[0],p.iter(function(N){G.Append(N);},p.append(M,new p.T({$:1,$0:I,$1:L[1]}))),p.iter(function(N){G.Append(N);},M)):void 0;};e.UniqueKey=function(){var G;G=t.NewGuid();return a.String(G);};e.TxtIconNormal=function(G,H,I){return e.TxtIcon("material-icons orange600",G,H,I);};e.TxtIcon=function(G,H,I,J){return w.Element("div",e.AttrsClick(J),[w.Element("table",[],[w.Element("tr",[],[w.Element("td",[],[w.Element("i",[x.Class(G)],[w.TextNode(H)])]),w.Element("td",[x.Style("vertical-align","middle")],[w.TextNode(I)])])])]);};e.IconSmall=function(G,H){return e.Icon("material-icons orange600 small",G,H);};e.IconNormal=function(G,H){return e.Icon("material-icons orange600",G,H);};e.Icon=function(G,H,I){return w.Element("i",new p.T({$:1,$0:x.Class(G),$1:e.AttrsClick(I)}),[w.TextNode(H)]);};e.AttrsClick=function(G){return p.ofArray([x.Style("Color","#FB8C00"),x.Style("cursor","pointer"),x.Handler("click",function(){return function(){return G();};})]);};f.Horizontal={$:1};f.Vertical={$:0};g.Render=function(G,H,I){var J,K;J=y.Create$1(false);K=w.Element("div",[x.DynamicStyle("display",z.Map(function(L){return!L?"none":"block";},J.v))],G);return H.$==1?w.Element("table",[],[w.Element("tr",[],[w.Element("td",[],[I]),w.Element("td",[],[K])])]).on("mouseenter",function(){return y.Set(J,true);}).on("mouseleave",function(){return y.Set(J,false);}):w.Element("div",[],[K,I]);};h.Create=function(G,H,I,J){return h.New(G,H,I,J);};h.New=function(G,H,I,J){return{Key:G,Left:H,Top:I,Children:J};};i=d.TitleButton=B.Class({Render:function(G){var H;H=this;return e.IconSmall(this.Icon,function(){H.Action(G);});}},null,i);i.New=function(G,H){return new i({Icon:G,Action:H});};j=d.Panel=B.Class({get_Render:function(){var G,H,I,J,K,L,M,N,O,P;function Q(T,U){var V,W,X,Y,Z,_0,_1,_2,_3,_4,_5,_6;return H.c?(V=G.Element.c.getBoundingClientRect(),(W=G.Element.c.parentElement.getBoundingClientRect(),(X=W.width-V.width,(Y=W.height-V.height,(Z=(_0=(_1=0,(_2=+T-J.c,r.Compare(_1,_2)===1?_1:_2)),r.Compare(X,_0)===-1?X:_0),(_3=(_4=(_5=0,(_6=+U-K.c,r.Compare(_5,_6)===1?_5:_6)),r.Compare(Y,_4)===-1?Y:_4),(y.Set(G.Left,Z),y.Set(G.Top,_3),G.Relayout(G),[Z,_3]))))))):[G.Left.c,G.Top.c];}function R(T,U){return(function(V){return function(W){return V(W.toFixed(6)+"px");};}(a.id))(T);}function S(T,U){return(function(V){return function(W){return V(W.toFixed(6)+"px");};}(a.id))(U);}G=this;H=y.Create$1(false);I=y.Create$1(false);J=y.Create$1(0);K=y.Create$1(0);L=z.Map(function(T){return Q(T[0],T[1]);},z.UpdateWhile([0,0],z.Map(function(T){return T&&H.c;},D.get_LeftPressed()),D.get_Position()));M=q.concat([this.TitleAttrs,p.ofArray([x.Style("cursor","grab"),x.Handler("mouseenter",function(){return function(){return y.Set(I,true);};}),x.Handler("mouseleave",function(){return function(){return!H.c?y.Set(I,false):null;};}),x.Handler("mouseup",function(){return function(){y.Set(I,false);return y.Set(H,false);};}),x.Handler("mousedown",function(){return function(T){I.c&&!r.Equals(G.Element.c.parentElement,null)&&!r.Equals(G.Element.c.parentElement.parentElement,null)?y.Set(H,true):void 0;y.Set(J,+T.clientX-G.Left.c);return y.Set(K,+T.clientY-G.Top.c);};})])]);N=w.Element("table",[x.Style("width","100%")],[w.Element("tr",[],[w.Element("td",[],[this.TitleContent]),w.Element("td",[x.Style("text-align","right"),x.Style("vertical-align","middle")],p.map(function(T){return T.Render(G);},this.TitleButtons))])]);O=this.Width>0?p.ofArray([x.Style("width",(function(T){return function(U){return T(U.toFixed(6)+"px");};}(a.id))(this.Width))]):p.T.Empty;P=w.Element("div",q.concat([this.PannelAttrs,q.concat([O,this.Height>0?p.ofArray([x.Style("height",(function(T){return function(U){return T(U.toFixed(6)+"px");};}(a.id))(this.Height))]):p.T.Empty]),p.ofArray([x.DynamicStyle("left",z.Map(function(T){return(function(U){return function(V){return U(V.toFixed(6)+"px");};}(a.id))(T);},this.Left.v)),x.DynamicStyle("left",z.Map(function(T){return R(T[0],T[1]);},L)),x.DynamicStyle("top",z.Map(function(T){return S(T[0],T[1]);},L)),x.DynamicStyle("top",z.Map(function(T){return(function(U){return function(V){return U(V.toFixed(6)+"px");};}(a.id))(T);},this.Top.v))])]),[w.Element("table",[],[w.Element("tr",[],[w.Element("td",O,[w.EmbedView(z.Map(function(T){return T?w.Element("div",M,[N]):w.Element("div",[],[]);},this.IsWithTitle.v))])]),w.Element("tr",[],[w.Element("td",[],[this.PanelContent,this.Children.get_Render()])])])]);y.Set(this.Element,P.elt);return P.OnAfterRender(function(){G.onAfterRender(G);});},get_PanelData:function(){return h.Create(this.Key,this.Left.c,this.Top.c,p.map(function(G){return G.get_PanelData();},p.ofSeq(this.Children.PanelItems)));},EditProperties:function(G){G.Edit(p.concat([this.Properties,p.concat(p.map(function(H){return H.Properties;},p.ofSeq(this.Children.PanelItems)))]));},WithInitialAutoLayout:function(){return j.New(this.Key,this.Left,this.Top,this.Width,this.Height,this.Element,this.Relayout,this.PannelAttrs,this.IsWithTitle,this.TitleAttrs,this.TitleContent,this.TitleButtons,this.PanelContent,this.Children,this.InternalName,this.onAfterRender,this.Properties,y.Create$1(true));},WithHeight:function(G){return j.New(this.Key,this.Left,this.Top,this.Width,G,this.Element,this.Relayout,this.PannelAttrs,this.IsWithTitle,this.TitleAttrs,this.TitleContent,this.TitleButtons,this.PanelContent,this.Children,this.InternalName,this.onAfterRender,this.Properties,this.IsWithInitialAutoLayout);},WithWidth:function(G){return j.New(this.Key,this.Left,this.Top,G,this.Height,this.Element,this.Relayout,this.PannelAttrs,this.IsWithTitle,this.TitleAttrs,this.TitleContent,this.TitleButtons,this.PanelContent,this.Children,this.InternalName,this.onAfterRender,this.Properties,this.IsWithInitialAutoLayout);},WithProperties:function(G){return j.New(this.Key,this.Left,this.Top,this.Width,this.Height,this.Element,this.Relayout,this.PannelAttrs,this.IsWithTitle,this.TitleAttrs,this.TitleContent,this.TitleButtons,this.PanelContent,this.Children,this.InternalName,this.onAfterRender,G,this.IsWithInitialAutoLayout);},WithOnAfterRender:function(G){return j.New(this.Key,this.Left,this.Top,this.Width,this.Height,this.Element,this.Relayout,this.PannelAttrs,this.IsWithTitle,this.TitleAttrs,this.TitleContent,this.TitleButtons,this.PanelContent,this.Children,this.InternalName,G,this.Properties,this.IsWithInitialAutoLayout);},WithInternalName:function(G){return j.New(this.Key,this.Left,this.Top,this.Width,this.Height,this.Element,this.Relayout,this.PannelAttrs,this.IsWithTitle,this.TitleAttrs,this.TitleContent,this.TitleButtons,this.PanelContent,this.Children,G,this.onAfterRender,this.Properties,this.IsWithInitialAutoLayout);},WithTitle:function(G){return j.New(this.Key,this.Left,this.Top,this.Width,this.Height,this.Element,this.Relayout,this.PannelAttrs,G,this.TitleAttrs,this.TitleContent,this.TitleButtons,this.PanelContent,this.Children,this.InternalName,this.onAfterRender,this.Properties,this.IsWithInitialAutoLayout);},WithChildPanelContainer:function(G){return j.New(this.Key,this.Left,this.Top,this.Width,this.Height,this.Element,this.Relayout,this.PannelAttrs,this.IsWithTitle,this.TitleAttrs,this.TitleContent,this.TitleButtons,this.PanelContent,G,this.InternalName,this.onAfterRender,this.Properties,this.IsWithInitialAutoLayout);},WithRelayoutFnc:function(G){return j.New(this.Key,this.Left,this.Top,this.Width,this.Height,this.Element,G,this.PannelAttrs,this.IsWithTitle,this.TitleAttrs,this.TitleContent,this.TitleButtons,this.PanelContent,this.Children,this.InternalName,this.onAfterRender,this.Properties,this.IsWithInitialAutoLayout);},WithPanelContent:function(G){return j.New(this.Key,this.Left,this.Top,this.Width,this.Height,this.Element,this.Relayout,this.PannelAttrs,this.IsWithTitle,this.TitleAttrs,this.TitleContent,this.TitleButtons,G,this.Children,this.InternalName,this.onAfterRender,this.Properties,this.IsWithInitialAutoLayout);},WithTitleButtons:function(G){return j.New(this.Key,this.Left,this.Top,this.Width,this.Height,this.Element,this.Relayout,this.PannelAttrs,this.IsWithTitle,this.TitleAttrs,this.TitleContent,G,this.PanelContent,this.Children,this.InternalName,this.onAfterRender,this.Properties,this.IsWithInitialAutoLayout);},WithTitleContent:function(G){return j.New(this.Key,this.Left,this.Top,this.Width,this.Height,this.Element,this.Relayout,this.PannelAttrs,this.IsWithTitle,this.TitleAttrs,G,this.TitleButtons,this.PanelContent,this.Children,this.InternalName,this.onAfterRender,this.Properties,this.IsWithInitialAutoLayout);},WithTitleAttrs:function(G){return j.New(this.Key,this.Left,this.Top,this.Width,this.Height,this.Element,this.Relayout,this.PannelAttrs,this.IsWithTitle,G,this.TitleContent,this.TitleButtons,this.PanelContent,this.Children,this.InternalName,this.onAfterRender,this.Properties,this.IsWithInitialAutoLayout);},WithPannelAttrs:function(G){return j.New(this.Key,this.Left,this.Top,this.Width,this.Height,this.Element,this.Relayout,G,this.IsWithTitle,this.TitleAttrs,this.TitleContent,this.TitleButtons,this.PanelContent,this.Children,this.InternalName,this.onAfterRender,this.Properties,this.IsWithInitialAutoLayout);},WithKey:function(G){return j.New(G,this.Left,this.Top,this.Width,this.Height,this.Element,this.Relayout,this.PannelAttrs,this.IsWithTitle,this.TitleAttrs,this.TitleContent,this.TitleButtons,this.PanelContent,this.Children,this.InternalName,this.onAfterRender,this.Properties,this.IsWithInitialAutoLayout);}},null,j);j.get_Create=function(){var G;return j.New((G=t.NewGuid(),a.String(G)),y.Create$1(0),y.Create$1(0),0,0,y.Create$1(null),a.ignore,p.T.Empty,y.Create$1(true),p.ofArray([x.Class("panelTitle")]),w.Element("div",[],[]),p.T.Empty,w.Element("div",[],[]),k.get_Create(),"",a.ignore,p.T.Empty,y.Create$1(false));};j.New=function(G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X){return new j({Key:G,Left:H,Top:I,Width:J,Height:K,Element:L,Relayout:M,PannelAttrs:N,IsWithTitle:O,TitleAttrs:P,TitleContent:Q,TitleButtons:R,PanelContent:S,Children:T,InternalName:U,onAfterRender:V,Properties:W,IsWithInitialAutoLayout:X});};k=d.PanelContainer=B.Class({get_Render:function(){var G;G=this;return w.Element("div",q.concat([this.ContainerAttributes,this.Width>0?p.ofArray([x.Style("width",(function(H){return function(I){return H(I.toFixed(6)+"px");};}(a.id))(this.Width))]):p.T.Empty,this.Height>0?p.ofArray([x.Style("height",(function(H){return function(I){return H(I.toFixed(6)+"px");};}(a.id))(this.Height))]):p.T.Empty,p.ofArray([x.Style("position","relative")])]),[w.ConvertBy(function(H){return H.Key;},function(H){return H.get_Render().OnAfterRender(function(){if(H.IsWithInitialAutoLayout.c){G.LayoutManager.WebSharper_Community_Panel_ILayoutManager$PlacePanel(G,H);y.Set(H.IsWithInitialAutoLayout,false);}});},this.PanelItems.v)]);},AddPanel:function(G){var H,I;this.PanelItems.Append(G.WithRelayoutFnc((H=this.LayoutManager,(I=this,function(J){H.WebSharper_Community_Panel_ILayoutManager$Relayout(I,J);}))));},FindPanelItem:function(G){return q.find(function(H){return r.Equals(H.Element,G.Element);},p.ofSeq(this.PanelItems));},WithHeight:function(G){return k.New(this.Width,G,this.PanelItems,this.LayoutManager,this.ContainerAttributes);},WithWidth:function(G){return k.New(G,this.Height,this.PanelItems,this.LayoutManager,this.ContainerAttributes);},WithLayoutManager:function(G){return k.New(this.Width,this.Height,this.PanelItems,G,this.ContainerAttributes);},WithAttributes:function(G){return k.New(this.Width,this.Height,this.PanelItems,this.LayoutManager,G);}},null,k);k.get_Create=function(){return k.New(0,0,E.Create(function(G){return G.Key;},p.T.Empty),{WebSharper_Community_Panel_ILayoutManager$Relayout:function(){return null;},WebSharper_Community_Panel_ILayoutManager$PlacePanel:function(){return null;}},p.T.Empty);};k.New=function(G,H,I,J,K){return new k({Width:G,Height:H,PanelItems:I,LayoutManager:J,ContainerAttributes:K});};l=d.Rect=B.Class({toString:function(){return"left:"+a.String(this.left)+" "+" top:"+a.String(this.top)+" right:"+a.String(this.right)+" bottom:"+a.String(this.bottom);},inflate:function(G,H){return l.New(this.left-G,this.right+G,this.top-H,this.bottom+H);},get_minSize:function(){var G,H;G=this.get_width();H=this.get_height();return r.Compare(G,H)===-1?G:H;},get_height:function(){return this.bottom-this.top;},get_width:function(){return this.right-this.left;},intersect:function(G){var H,I,J,K,L,M,N,O,P,Q,R,S;H=(I=this.left,(J=G.left,r.Compare(I,J)===1?I:J));K=(L=this.right,(M=G.right,r.Compare(L,M)===-1?L:M));N=(O=this.top,(P=G.top,r.Compare(O,P)===1?O:P));Q=(R=this.bottom,(S=G.bottom,r.Compare(R,S)===-1?R:S));return l.New(H,r.Compare(H,K)===1?H:K,N,r.Compare(N,Q)===1?N:Q);},offset:function(G,H){return l.New(this.left+G,this.right+G,this.top+H,this.bottom+H);},get_isEmpty:function(){return this.left>=this.right||this.top>=this.bottom;}},null,l);l.fromPanel=function(G){return l.fromDomRect(G.Element.c).offset(G.Left.c,G.Top.c);};l.fromDomRect=function(G){var H;return!r.Equals(G,null)?(H=G.getBoundingClientRect(),l.New(0,H.width,0,H.height)):l.Create(0,0,0,0);};l.Create=function(G,H,I,J){return l.New(G,I,H,J);};l.New=function(G,H,I,J){return new l({left:G,right:H,top:I,bottom:J});};m.StackPanelLayoutManager=function(){n.$cctor();return n.StackPanelLayoutManager;};m.FloatingPanelLayoutManager=function(G){return{WebSharper_Community_Panel_ILayoutManager$Relayout:function(H,I){return m.relayout(H,I,G);},WebSharper_Community_Panel_ILayoutManager$PlacePanel:function(H,I){return m.placePanel(H,I,G);}};};m.relayout=function(G,H,I){var J,K,L;J=G.PanelItems;K=q.find(function(M){return M.Key===H.Key;},p.ofSeq(J));L=q.tryFind(function(M){return M.Key!==K.Key&&l.fromPanel(M).intersect(l.fromPanel(K)).get_minSize()>15;},p.ofSeq(J));L!=null&&L.$==1?m.movePanelToFreeSpace(J,L.$0,I):void 0;};m.placePanel=function(G,H,I){var J,K,L;J=l.fromPanel(H);K=q.tryFind(function(M){return M.get_width()>=J.get_width()&&M.get_height()>=J.get_height();},m.collectFreeSpace(G.PanelItems,l.Create(0,0,G.Width,G.Height),H,I));K!=null&&K.$==1?(L=K.$0,y.Set(H.Left,L.left+I),y.Set(H.Top,L.top+I)):void 0;};m.movePanelToFreeSpace=function(G,H,I){var J,K,L;J=l.fromPanel(H);K=q.tryFind(function(M){return M.get_width()>=J.get_width()&&M.get_height()>=J.get_height();},m.collectFreeSpace(G,l.fromDomRect(H.Element.c.parentElement),H,I));K!=null&&K.$==1?(L=K.$0,y.Set(H.Left,L.left+I),y.Set(H.Top,L.top+I)):void 0;};m.collectFreeSpace=function(G,H,I,J){var K;K=p.filter(function(L){return L.Key!==I.Key;},p.ofSeq(G));return q.fold(function(L,M){var N,O,P;N=m.panelRect(M,0);O=l.New(0,H.right,0,N.top);P=l.New(0,N.left,0,H.bottom);return p.concat(p.map(function(Q){return p.filter(function(R){return!R.get_isEmpty();},p.map(function(R){return R.intersect(Q);},L));},p.ofArray([O,P,l.New(N.right,H.right,P.top,P.bottom),l.New(O.left,O.right,N.bottom,H.bottom)])));},p.ofArray([H]),K);};m.calcClientArea=function(G,H,I){var J;J=p.map(function(K){F.log(K.InternalName);return m.panelRect(K,I);},function(K,L){var M,N;while(true)if(L.$==1){M=L.$1;N=L.$0;if(N.Key===H.Key)return K;else{K=new p.T({$:1,$0:N,$1:K});L=M;}}else return K;}(p.T.Empty,p.ofSeq(G)));return J.$==0?l.Create(0,0,0,0):l.Create(p.min(p.map(function(K){return K.left;},J)),p.min(p.map(function(K){return K.top;},J)),p.max(p.map(function(K){return K.right;},J)),p.max(p.map(function(K){return K.bottom;},J)));};m.panelRect=function(G,H){return l.fromPanel(G).inflate(H,H);};n.$cctor=function(){n.$cctor=a.ignore;n.StackPanelLayoutManager={WebSharper_Community_Panel_ILayoutManager$Relayout:function(G,H){return m.relayout(G,H,0);},WebSharper_Community_Panel_ILayoutManager$PlacePanel:function(){return null;}};};o=d.Dialog=B.Class({get_Render:function(){var G;G=this;return w.Element("div",[x.Style("position","absolute"),x.Style("left","250px"),x.Style("top","200px"),x.Style("z-index","1"),x.Style("background-color","white"),x.Style("min-height","100px"),x.Style("min-width","200px"),x.DynamicStyle("display",z.Map(function(H){return H?"block":"none";},this.Visibility.v))],[w.Element("table",[x.Style("background-color","grey"),x.Style("display","block"),x.Style("min-height","100px"),x.Style("min-width","200px")],[w.Element("table",[],[w.Element("tr",[],[w.Element("td",[x.Style("border-style","hidden"),x.Style("background","#404040"),x.Style("color","rgb(200,200,200)"),x.Style("padding","0px 2px 5px 2px"),x.Style("Width","200px"),x.Style("font-size","medium")],[w.TextView(this.Title.v)])])]),w.Element("table",[],[w.Element("tr",[],[w.Element("td",[x.Style("padding","5px 0px 0px 2px")],[w.BindView(a.id,this.Content.v)])]),w.Element("tr",[],[w.Element("td",[x.Style("padding","20px 12px 2px 20px")],[w.Element("button",[x.Style("border-radius","2px"),x.Handler("click",function(){return function(){y.Set(G.Visibility,false);return G.OKCallback.c();};})],[w.TextNode("OK")])]),w.Element("td",[x.Style("padding","20px 12px 2px 50px")],[w.Element("button",[x.Style("border-radius","2px"),x.Handler("click",function(){return function(){return y.Set(G.Visibility,false);};})],[w.TextNode("Cancel")])])])])])]);},ShowDialog:function(G,H,I){y.Set(this.Title,G);y.Set(this.Content,H);y.Set(this.Visibility,true);y.Set(this.OKCallback,I);}},null,o);o.get_Create=function(){return o.New(y.Create$1(""),y.Create$1(w.Element("div",[],[])),y.Create$1(false),y.Create$1(a.ignore));};o.New=function(G,H,I,J){return new o({Title:G,Content:H,Visibility:I,OKCallback:J});};}());
