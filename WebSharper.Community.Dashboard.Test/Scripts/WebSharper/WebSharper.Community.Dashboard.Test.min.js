(function(){"use strict";var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G;a=window;b=a.WebSharper=a.WebSharper||{};c=b.Community=b.Community||{};d=c.Dashboard=c.Dashboard||{};e=d.Test=d.Test||{};f=e.AppModel=e.AppModel||{};g=e.AppData=e.AppData||{};h=e.Client=e.Client||{};i=a.IntelliFactory;j=i&&i.Runtime;k=d&&d.AppModelLib;l=b&&b.Operators;m=b&&b.List;n=d&&d.Environment;o=d&&d.MessageBus;p=b&&b.Remoting;q=p&&p.AjaxRemotingProvider;r=d&&d.RuleEntry;s=c&&c.Panel;t=s&&s.Helper;u=d&&d.RandomRunner;v=d&&d.TextBoxRenderer;w=d&&d.ChartRenderer;x=s&&s.PanelData;y=d&&d.RuleContainer;z=d&&d.RuleChain;A=d&&d.App;B=b&&b.UI;C=B&&B.Next;D=C&&C.Doc;E=a.console;F=C&&C.Var;G=b&&b.Strings;f=e.AppModel=j.Class({get_Worker:function(){return this.$0.get_Worker();}},null,f);f.ToWorker=function(H){return f.FromDataContext(H).get_Worker();};f.FromWorker=function(H){var I;I=k.FromWorker(H);return I!=null&&I.$==1?new f({$:0,$0:I.$0}):l.FailWith("AllTypes FromWorker unknown type");};f.FromDataContext=function(H){var I;I=k.FromDataContext(H);return I!=null&&I.$==1?I.$0:l.FailWith("AllTypes FromDataContext unknown type");};g=e.AppData=j.Class({get_RecreateOnServer:function(){var H,I;function J(O,P){return P;}function K(O,P){return P;}function L(O,P,Q){return Q;}function M(O,P,Q){return Q;}function N(O,P){P.Reconnect(I);}H=m.map(function(O){return J(O[0],O[1]);},m.concat(m.map(function(O){return K(O[0],O[1]);},this.RecreateEvents(a.id))));I=m.map(function(O){return O.WithStartRunner();},m.append(H,m.map(function(O){return L(O[0],O[1],O[2]);},m.concat(m.map(function(O){return M(O[0],O[1],O[2]);},this.get_RecreateWidgets())))));m.iter(function(O){return N(O[0],O[1]);},this.Rules);return H;},RecreateOnClient:function(H,I){var J;n.set_Role(n.Role.Client);J=o.Agent();J.mailbox.AddLast({$:3,$0:function(K){(new q.New()).Send("WebSharper.Community.Dashboard:WebSharper.Community.Dashboard.MessageBus.SendToServer:-1358505674",[K]);}});J.resume();H.Restore(I,this.RecreateEvents(a.id),this.get_RecreateWidgets(),this.Rules);},Recreate:function(H,I){H.Restore(I,this.RecreateEvents(function(J){return J.WithStartRunner();}),this.get_RecreateWidgets(),this.Rules);},get_RecreateWidgets:function(){function H(I,J,K){function L(M,N,O){return[M,N,O.get_Worker()];}return[I,J,m.map(function(M){return L(M[0],M[1],M[2]);},K)];}return m.map(function(I){return H(I[0],I[1],I[2]);},this.Widgets);},RecreateEvents:function(H){function I(J,K){function L(M,N){return[M,H(N.get_Worker())];}return[J,m.map(function(M){return L(M[0],M[1]);},K)];}return m.map(function(J){return I(J[0],J[1]);},this.Events);}},null,g);g.Create=function(H){var I;I=H.Store(f.FromWorker);return g.New(I[0],I[1],I[2]);};g.get_empty=function(){return g.New(m.T.Empty,m.T.Empty,m.T.Empty);};g.New=function(H,I,J){return new g({Events:H,Widgets:I,Rules:J});};h.Main=function(H){var I,J;function K(){var N,O,P,Q,R,S;function T(U){var V;V=U.get_Worker();return[[V.Key,N,U],r.New(V.InPorts.get_Item(0).Key,"",V.Key)];}g.Create(J);N=t.UniqueKey();O=new f({$:0,$0:new k({$:0,$0:u.Create(100,50)})});P=O.get_Worker();Q=T(new f({$:0,$0:new k({$:3,$0:v.get_Create()})}));R=T(new f({$:0,$0:new k({$:4,$0:w.Create(300,150,50)})}));S=m.ofArray([x.Create(N,0,0,m.T.Empty)]);g.New(m.ofArray([["main",m.ofArray([[P.Key,O]])]]),m.ofArray([["main",S,m.ofArray([Q[0],R[0]])]]),m.ofArray([["main",y.New(m.ofArray([z.New(m.ofArray([r.New(P.InPorts.get_Item(0).Key,P.OutPorts.get_Item(0).Key,P.Key),Q[1]])),z.New(m.ofArray([r.New(P.InPorts.get_Item(0).Key,P.OutPorts.get_Item(0).Key,P.Key),R[1]]))]))]])).Recreate(J,function(){return A.PanelContainerCreator();});}function L(N){var O;O=(new q.New()).Sync("WebSharper.Community.Dashboard.Test:WebSharper.Community.Dashboard.Test.Server.LoadFromFile:-133840407",[N]);O.RecreateOnClient(J,function(){return A.PanelContainerCreator();});(new q.New()).Sync("WebSharper.Community.Dashboard.Test:WebSharper.Community.Dashboard.Test.Server.RecreateOnServer:1994187327",[O]);o.RunServerRequests();}function M(N){return D.Element("td",[],N);}n.set_Log(function(N){E.log(N);});I=F.Create$1("Dashboard");J=A.CreateDashboard();return D.Element("div",[],[J.Render(D.Element("div",[],[M(m.ofArray([t.TxtIconNormal("build","Sample configuration",function(){K();})])),M(m.ofArray([D.TextNode("File name"),D.Input([],I)])),M(m.ofArray([t.TxtIconNormal("archive","Upload",function(){(new q.New()).Send("WebSharper.Community.Dashboard.Test:WebSharper.Community.Dashboard.Test.Server.SaveToFile:-1567987319",[I.c,g.Create(J)]);})])),M(m.ofArray([t.TxtIconNormal("unarchive","Download  and run on client",function(){(new q.New()).Sync("WebSharper.Community.Dashboard.Test:WebSharper.Community.Dashboard.Test.Server.LoadFromFile:-133840407",[I.c]).Recreate(J,function(){return A.PanelContainerCreator();});})])),M(m.ofArray([t.TxtIconNormal("cloud_upload","Download and run on server",function(){L(I.c);})]))]))]).OnAfterRender(function(){try{!G.IsNullOrWhiteSpace(H.ConfigurationName)?L(H.ConfigurationName):null;}catch(N){null;}});};}());
