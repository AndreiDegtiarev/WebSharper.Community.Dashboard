(function(){"use strict";var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z;a=window;b=a.WebSharper=a.WebSharper||{};c=b.Community=b.Community||{};d=c.Panel=c.Panel||{};e=d.TitleButton=d.TitleButton||{};f=d.Panel=d.Panel||{};g=d.PanelContainer=d.PanelContainer||{};h=d.Rect=d.Rect||{};i=d.LayoutManagers=d.LayoutManagers||{};j=a.StartupCode$WebSharper_Community_Panel$LayoutManagers=a.StartupCode$WebSharper_Community_Panel$LayoutManagers||{};k=a.IntelliFactory;l=k&&k.Runtime;m=b&&b.UI;n=m&&m.Next;o=n&&n.AttrModule;p=n&&n.Doc;q=n&&n.Var;r=n&&n.Input;s=r&&r.Mouse;t=n&&n.View;u=b&&b.Operators;v=b&&b.Seq;w=b&&b.List;x=b&&b.Unchecked;y=n&&n.Key;z=n&&n.ListModel;e=d.TitleButton=l.Class({Render:function(A){var B,C,D;B=this;C=[o.Class("material-icons orange600 small"),o.Style("cursor","pointer"),o.Handler("click",function(){return function(){return B.Action(A);};})];D=[p.TextNode(this.Icon)];return p.Element("i",C,D);}},null,e);e.New=function(A,B){return new e({Icon:A,Action:B});};f=d.Panel=l.Class({get_Render:function(){var A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,_0,_1,_2,_3,_4,_5,_6,_7,_8,_9,_,$;A=this;B=q.Create$1(false);C=q.Create$1(false);D=q.Create$1(0);E=q.Create$1(0);F=(G=s.get_LeftPressed(),t.Map(function(ba){return ba?B.c:false;},G));H=(I=s.get_Position(),t.UpdateWhile([0,0],F,I));J=(K=function(ba,bb){var bc,bd,be,bf,bg,bh,bi,bj;return B.c?(bc=A.Element.c.getBoundingClientRect(),(bd=A.Element.c.parentElement.getBoundingClientRect(),(be=bd.width-bc.width,(bf=bd.height-bc.height,(bg=u.Min(be,u.Max(0,+ba-D.c)),(bh=u.Min(bf,u.Max(0,+bb-E.c)),(bi=A.Left,q.Set(bi,bg),bj=A.Top,q.Set(bj,bh),A.Relayout(A),[bg,bh]))))))):[A.Left.c,A.Top.c];},t.Map(function(ba){return K(ba[0],ba[1]);},H));L=v.concat([this.TitleAttrs,w.ofArray([o.Style("cursor","grab"),o.Handler("mouseenter",function(){return function(){return q.Set(C,true);};}),o.Handler("mouseleave",function(){return function(){return!B.c?q.Set(C,false):null;};}),o.Handler("mouseup",function(){return function(){q.Set(C,false);return q.Set(B,false);};}),o.Handler("mousedown",function(){return function(ba){var bb,bc;((C.c?!x.Equals(A.Element.c.parentElement,null):false)?!x.Equals(A.Element.c.parentElement.parentElement,null):false)?q.Set(B,true):void 0;bb=+ba.clientX-A.Left.c;q.Set(D,bb);bc=+ba.clientY-A.Top.c;return q.Set(E,bc);};})])]);M=(N=[o.Style("width","100%")],(O=[(P=[(Q=[this.TitleContent],p.Element("td",[],Q)),(R=[o.Style("text-align","right"),o.Style("vertical-align","middle")],(S=(T=function(ba){return ba.Render(A);},function(ba){return w.map(T,ba);}(this.TitleButtons)),p.Element("td",R,S)))],p.Element("tr",[],P))],p.Element("table",N,O)));U=this.Width>0?w.ofArray([o.Style("width",(V=function(ba,bb){return ba(bb.toFixed(6)+"px");},(function(ba){return function(bb){return V(ba,bb);};}(a.id))(this.Width)))]):w.T.Empty;W=this.Height>0?w.ofArray([o.Style("height",(X=function(ba,bb){return ba(bb.toFixed(6)+"px");},(function(ba){return function(bb){return X(ba,bb);};}(a.id))(this.Height)))]):w.T.Empty;Y=v.concat([this.PannelAttrs,v.concat([U,W]),w.ofArray([o.DynamicStyle("left",(Z=this.Left.v,t.Map(function(ba){var bb;bb=function(bc,bd){return bc(bd.toFixed(6)+"px");};return(function(bc){return function(bd){return bb(bc,bd);};}(a.id))(ba);},Z))),o.DynamicStyle("left",(_0=function(ba){var bb;bb=function(bc,bd){return bc(bd.toFixed(6)+"px");};return(function(bc){return function(bd){return bb(bc,bd);};}(a.id))(ba);},t.Map(function(ba){return _0(ba[0],ba[1]);},J))),o.DynamicStyle("top",(_1=function(ba,bb){var bc;bc=function(bd,be){return bd(be.toFixed(6)+"px");};return(function(bd){return function(be){return bc(bd,be);};}(a.id))(bb);},t.Map(function(ba){return _1(ba[0],ba[1]);},J))),o.DynamicStyle("top",(_2=this.Top.v,t.Map(function(ba){var bb;bb=function(bc,bd){return bc(bd.toFixed(6)+"px");};return(function(bc){return function(bd){return bb(bc,bd);};}(a.id))(ba);},_2)))])]);_3=(_4=[(_5=[(_6=[(_7=[this.IsWithTitle?p.Element("div",L,[M]):p.Element("div",[],[])],p.Element("td",U,_7))],p.Element("tr",[],_6)),(_8=[(_9=[this.PanelContent,this.Children.get_Render()],p.Element("td",[],_9))],p.Element("tr",[],_8))],p.Element("table",[],_5))],p.Element("div",Y,_4));_=this.Element;$=_3.elt;q.Set(_,$);return _3.OnAfterRender(function(){A.onAfterRender(A);});},WithHeight:function(A){return f.New(this.Key,this.Left,this.Top,this.Width,A,this.Element,this.Relayout,this.PannelAttrs,this.IsWithTitle,this.TitleAttrs,this.TitleContent,this.TitleButtons,this.PanelContent,this.Children,this.InternalName,this.onAfterRender,this.Properties);},WithWidth:function(A){return f.New(this.Key,this.Left,this.Top,A,this.Height,this.Element,this.Relayout,this.PannelAttrs,this.IsWithTitle,this.TitleAttrs,this.TitleContent,this.TitleButtons,this.PanelContent,this.Children,this.InternalName,this.onAfterRender,this.Properties);},WithProperties:function(A){return f.New(this.Key,this.Left,this.Top,this.Width,this.Height,this.Element,this.Relayout,this.PannelAttrs,this.IsWithTitle,this.TitleAttrs,this.TitleContent,this.TitleButtons,this.PanelContent,this.Children,this.InternalName,this.onAfterRender,A);},WithOnAfterRender:function(A){return f.New(this.Key,this.Left,this.Top,this.Width,this.Height,this.Element,this.Relayout,this.PannelAttrs,this.IsWithTitle,this.TitleAttrs,this.TitleContent,this.TitleButtons,this.PanelContent,this.Children,this.InternalName,A,this.Properties);},WithInternalName:function(A){return f.New(this.Key,this.Left,this.Top,this.Width,this.Height,this.Element,this.Relayout,this.PannelAttrs,this.IsWithTitle,this.TitleAttrs,this.TitleContent,this.TitleButtons,this.PanelContent,this.Children,A,this.onAfterRender,this.Properties);},WithTitle:function(A){return f.New(this.Key,this.Left,this.Top,this.Width,this.Height,this.Element,this.Relayout,this.PannelAttrs,A,this.TitleAttrs,this.TitleContent,this.TitleButtons,this.PanelContent,this.Children,this.InternalName,this.onAfterRender,this.Properties);},WithChildPanelContainer:function(A){return f.New(this.Key,this.Left,this.Top,this.Width,this.Height,this.Element,this.Relayout,this.PannelAttrs,this.IsWithTitle,this.TitleAttrs,this.TitleContent,this.TitleButtons,this.PanelContent,A,this.InternalName,this.onAfterRender,this.Properties);},WithRelayoutFnc:function(A){return f.New(this.Key,this.Left,this.Top,this.Width,this.Height,this.Element,A,this.PannelAttrs,this.IsWithTitle,this.TitleAttrs,this.TitleContent,this.TitleButtons,this.PanelContent,this.Children,this.InternalName,this.onAfterRender,this.Properties);},WithPanelContent:function(A){return f.New(this.Key,this.Left,this.Top,this.Width,this.Height,this.Element,this.Relayout,this.PannelAttrs,this.IsWithTitle,this.TitleAttrs,this.TitleContent,this.TitleButtons,A,this.Children,this.InternalName,this.onAfterRender,this.Properties);},WithTitleButtons:function(A){return f.New(this.Key,this.Left,this.Top,this.Width,this.Height,this.Element,this.Relayout,this.PannelAttrs,this.IsWithTitle,this.TitleAttrs,this.TitleContent,A,this.PanelContent,this.Children,this.InternalName,this.onAfterRender,this.Properties);},WithTitleContent:function(A){return f.New(this.Key,this.Left,this.Top,this.Width,this.Height,this.Element,this.Relayout,this.PannelAttrs,this.IsWithTitle,this.TitleAttrs,A,this.TitleButtons,this.PanelContent,this.Children,this.InternalName,this.onAfterRender,this.Properties);},WithTitleAttrs:function(A){return f.New(this.Key,this.Left,this.Top,this.Width,this.Height,this.Element,this.Relayout,this.PannelAttrs,this.IsWithTitle,A,this.TitleContent,this.TitleButtons,this.PanelContent,this.Children,this.InternalName,this.onAfterRender,this.Properties);},WithPannelAttrs:function(A){return f.New(this.Key,this.Left,this.Top,this.Width,this.Height,this.Element,this.Relayout,A,this.IsWithTitle,this.TitleAttrs,this.TitleContent,this.TitleButtons,this.PanelContent,this.Children,this.InternalName,this.onAfterRender,this.Properties);}},null,f);f.get_Create=function(){return f.New(y.Fresh(),q.Create$1(0),q.Create$1(0),0,0,q.Create$1(null),function(){},w.T.Empty,true,w.ofArray([o.Class("panelTitle")]),p.Element("div",[],[]),w.T.Empty,p.Element("div",[],[]),g.get_Create(),"",function(){},w.T.Empty);};f.New=function(A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q){return new f({Key:A,Left:B,Top:C,Width:D,Height:E,Element:F,Relayout:G,PannelAttrs:H,IsWithTitle:I,TitleAttrs:J,TitleContent:K,TitleButtons:L,PanelContent:M,Children:N,InternalName:O,onAfterRender:P,Properties:Q});};g=d.PanelContainer=l.Class({get_Render:function(){var A,B,C,D,E,F,G,H,I;A=this;B=this.Width>0?w.ofArray([o.Style("width",(C=function(J,K){return J(K.toFixed(6)+"px");},(function(J){return function(K){return C(J,K);};}(a.id))(this.Width)))]):w.T.Empty;D=this.Height>0?w.ofArray([o.Style("height",(E=function(J,K){return J(K.toFixed(6)+"px");},(function(J){return function(K){return E(J,K);};}(a.id))(this.Height)))]):w.T.Empty;F=v.concat([this.ContainerAttributes,B,D,w.ofArray([o.Style("position","relative")])]);G=[(H=function(J){return J.Key;},(I=function(J){var K;K=J.get_Render();return K.OnAfterRender(function(){A.LayoutManager.WebSharper_Community_Panel_ILayoutManager$PlacePanel(A,J);});},function(J){return p.ConvertBy(H,I,J);})(this.PanelItems.v))];return p.Element("div",F,G);},AddPanel:function(A){var B,C;this.PanelItems.Append(A.WithRelayoutFnc((B=this.LayoutManager,(C=this,function(D){B.WebSharper_Community_Panel_ILayoutManager$Relayout(C,D);}))));},FindPanelItem:function(A){var B;B=function(C){return x.Equals(C.Element,A.Element);};return function(C){return v.find(B,C);}(w.ofSeq(this.PanelItems));},WithHeight:function(A){return g.New(this.Width,A,this.PanelItems,this.LayoutManager,this.ContainerAttributes);},WithWidth:function(A){return g.New(A,this.Height,this.PanelItems,this.LayoutManager,this.ContainerAttributes);},WithLayoutManager:function(A){return g.New(this.Width,this.Height,this.PanelItems,A,this.ContainerAttributes);},WithAttributes:function(A){return g.New(this.Width,this.Height,this.PanelItems,this.LayoutManager,A);}},null,g);g.get_Create=function(){var A;return g.New(0,0,(A=w.T.Empty,z.Create(function(B){return B.Key;},A)),{WebSharper_Community_Panel_ILayoutManager$PlacePanel:function(){return null;},WebSharper_Community_Panel_ILayoutManager$Relayout:function(){return null;}},w.T.Empty);};g.New=function(A,B,C,D,E){return new g({Width:A,Height:B,PanelItems:C,LayoutManager:D,ContainerAttributes:E});};h=d.Rect=l.Class({toString:function(){return"left:"+a.String(this.left)+" "+" top:"+a.String(this.top)+" right:"+a.String(this.right)+" bottom:"+a.String(this.bottom);},inflate:function(A,B){var C,D;C=this.left-A;D=this.top-B;return h.New(C,this.right+A,D,this.bottom+B);},get_height:function(){return this.bottom-this.top;},get_width:function(){return this.right-this.left;},intersect:function(A){var B,C,D,E;B=u.Max(this.left,A.left);C=u.Min(this.right,A.right);D=u.Max(this.top,A.top);E=u.Min(this.bottom,A.bottom);return h.New(B,u.Max(B,C),D,u.Max(D,E));},offset:function(A,B){var C,D;C=this.left+A;D=this.top+B;return h.New(C,this.right+A,D,this.bottom+B);},get_isEmpty:function(){return this.left>=this.right?true:this.top>=this.bottom;}},null,h);h.fromPanel=function(A){return h.fromDomRect(A.Element.c).offset(A.Left.c,A.Top.c);};h.fromDomRect=function(A){var B;return!x.Equals(A,null)?(B=A.getBoundingClientRect(),h.New(0,B.width,0,B.height)):h.Create(0,0,0,0);};h.Create=function(A,B,C,D){return h.New(A,C,B,D);};h.New=function(A,B,C,D){return new h({left:A,right:B,top:C,bottom:D});};i.StackPanelLayoutManager=function(){j.$cctor();return j.StackPanelLayoutManager;};i.FloatingPanelLayoutManager=function(A){return{WebSharper_Community_Panel_ILayoutManager$PlacePanel:function(B,C){return i.placePanel(B,C,A);},WebSharper_Community_Panel_ILayoutManager$Relayout:function(B,C){return i.relayout(B,C,A);}};};i.relayout=function(A,B,C){var D,E,F,G,H,I,J;D=A.PanelItems;E=w.ofSeq(D);F=(G=function(K){return x.Equals(K.Key,B.Key);},function(K){return v.find(G,K);}(E));H=(I=function(K){return!x.Equals(K.Key,F.Key)?!h.fromPanel(K).intersect(h.fromPanel(F)).get_isEmpty():false;},function(K){return v.tryFind(I,K);}(w.ofSeq(D)));(H!=null?H.$==1:false)?(J=H.$0,i.movePanelToFreeSpace(D,J,C)):void 0;};i.placePanel=function(A,B,C){var D,E,F,G,H,I,J,K,L,M,N;D=h.fromPanel(B);E=(F=A.Width,(G=A.Height,h.Create(0,0,F,G)));H=(I=function(O){return O.get_width()>=D.get_width()?O.get_height()>=D.get_height():false;},function(O){return v.tryFind(I,O);}(i.collectFreeSpace(A.PanelItems,E,B,C)));(H!=null?H.$==1:false)?(J=H.$0,K=B.Left,L=J.left+C,q.Set(K,L),M=B.Top,N=J.top+C,q.Set(M,N)):void 0;};i.movePanelToFreeSpace=function(A,B,C){var D,E,F,G,H,I,J,K,L;D=h.fromPanel(B);E=h.fromDomRect(B.Element.c.parentElement);F=(G=function(M){return M.get_width()>=D.get_width()?M.get_height()>=D.get_height():false;},function(M){return v.tryFind(G,M);}(i.collectFreeSpace(A,E,B,C)));(F!=null?F.$==1:false)?(H=F.$0,I=B.Left,J=H.left+C,q.Set(I,J),K=B.Top,L=H.top+C,q.Set(K,L)):void 0;};i.collectFreeSpace=function(A,B,C,D){var E,F,G;E=(F=function(H){return!x.Equals(H.Key,C.Key);},function(H){return w.filter(F,H);}(w.ofSeq(A)));G=w.ofArray([B]);return v.fold(function(H,I){var J,K,L,M,N,O;J=i.panelRect(I,0);K=h.New(0,B.right,0,J.top);L=h.New(0,J.left,0,B.bottom);return w.concat((M=function(P){var Q,R;Q=function(S){return!S.get_isEmpty();};return function(S){return w.filter(Q,S);}((R=function(S){return S.intersect(P);},function(S){return w.map(R,S);}(H)));},function(P){return w.map(M,P);}(w.ofArray([K,L,h.New(J.right,B.right,L.top,L.bottom),(N=J.bottom,(O=B.bottom,h.New(K.left,K.right,N,O)))]))));},G,E);};i.calcClientArea=function(A,B,C){var D,E,F,G,H,I,J,K,L,M,N,O,P;D=function(Q,R){var S,T;while(true)if(R.$==1){S=R.$1;T=R.$0;if(x.Equals(T.Key,B.Key))return Q;else{Q=new w.T({$:1,$0:T,$1:Q});R=S;}}else return Q;};E=(F=function(Q){var R;R=Q.InternalName;a.console.log(R);return i.panelRect(Q,C);},function(Q){return w.map(F,Q);}((G=w.ofSeq(A),(H=w.T.Empty,function(Q){return D(H,Q);}(G)))));return E.$==0?h.Create(0,0,0,0):(I=w.min((J=function(Q){return Q.left;},function(Q){return w.map(J,Q);}(E))),(K=w.min((L=function(Q){return Q.top;},function(Q){return w.map(L,Q);}(E))),(M=w.max((N=function(Q){return Q.right;},function(Q){return w.map(N,Q);}(E))),(O=w.max((P=function(Q){return Q.bottom;},function(Q){return w.map(P,Q);}(E))),h.Create(I,K,M,O)))));};i.panelRect=function(A,B){return h.fromPanel(A).inflate(B,B);};j.$cctor=l.Cctor(function(){j.StackPanelLayoutManager={WebSharper_Community_Panel_ILayoutManager$PlacePanel:function(){return null;},WebSharper_Community_Panel_ILayoutManager$Relayout:function(A,B){return i.relayout(A,B,0);}};j.$cctor=a.ignore;});}());
