(function(){"use strict";var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z;a=window;b=a.WebSharper=a.WebSharper||{};c=b.Community=b.Community||{};d=c.Dashboard=c.Dashboard||{};e=d.IInPortNumber=d.IInPortNumber||{};f=d.IOutPortNumber=d.IOutPortNumber||{};g=d.Sources=d.Sources||{};h=d.SrcOpenWeather=d.SrcOpenWeather||{};i=h.Forecast=h.Forecast||{};j=d.Widgets=d.Widgets||{};k=d.SourceItem=d.SourceItem||{};l=d.ReceiverItem=d.ReceiverItem||{};m=d.Dashboard=d.Dashboard||{};n=a.IntelliFactory;o=n&&n.Runtime;p=b&&b.Util;q=b&&b.Control;r=q&&q.FSharpEvent;s=b&&b.Random;t=b&&b.Concurrency;u=b&&b.List;v=b&&b.PrintfHelpers;w=b&&b.Data;x=w&&w.TxtRuntime;y=a.FSharp;z=y&&y.Data;A=z&&z.Runtime;B=A&&A.IO;C=b&&b.Unchecked;D=b&&b.Arrays;E=b&&b.Seq;F=b&&b.Operators;G=b&&b.Charting;H=G&&G.Chart;I=G&&G.Pervasives;J=G&&G.Renderers;K=J&&J.ChartJs;L=b&&b.UI;M=L&&L.Next;N=M&&M.Var;O=M&&M.AttrProxy;P=M&&M.Doc;Q=M&&M.Key;R=c&&c.Panel;S=R&&R.PanelContainer;T=R&&R.LayoutManagers;U=M&&M.AttrModule;V=R&&R.Panel;W=R&&R.TitleButton;X=M&&M.ListModel;Y=c&&c.PropertyGrid;Z=Y&&Y.PropertyGrid;e=d.IInPortNumber=o.Class({get_Callback:function(){return this.callback;},WebSharper_Community_Dashboard_IInPort$get_Name:function(){return this.name;}},null,e);e.New=o.Ctor(function(_0,_1){this.name=_0;this.callback=_1;},e);f=d.IOutPortNumber=o.Class({Trigger:function(_0){this.event.event.Trigger(_0);},WebSharper_Community_Dashboard_IOutPort$Connect:function(_0){p.addListener(this.event.event,_0.get_Callback());},WebSharper_Community_Dashboard_IOutPort$IsCompatible:function(_0){return _0 instanceof e;},WebSharper_Community_Dashboard_IOutPort$get_Name:function(){return this.name;}},null,f);f.New=o.Ctor(function(_0){this.name=_0;this.event=new r.New();},f);g.RandomValueSource=function(_0,_1){var _2;_2=new f.New("Random value");return{WebSharper_Community_Dashboard_ISource$Run:function(){var _3;_3=new s.New();return t.Start(t.Delay(function(){return t.While(function(){return true;},t.Delay(function(){return t.Bind(t.Sleep(600),function(){var _4;_4=a.Math.random()*_1+_0;_2.Trigger(_4);return t.Return(null);});}));}),null);},WebSharper_Community_Dashboard_ISource$get_OutPorts:function(){return u.ofArray([_2]);}};};i.New=function(_0,_1,_2,_3,_4){return{Title:_0,Description:_1,ImageUrl:_2,Temperature:_3,TemparatureMinMax:_4};};h.Create=function(_0){var _1;_1=new f.New("Temperature");return{WebSharper_Community_Dashboard_ISource$Run:function(){var _2;_2=new s.New();return t.Start(t.Delay(function(){return t.While(function(){return true;},t.Delay(function(){var _3;_3=h.get("971df4ae03b507bfbe817a171a3f2bc7",_0);return t.Bind(_3,function(_4){var _5;_5="Value generated:"+_4.$0.Title;a.console.log(_5);_1.Trigger(+_4.$0.Temperature);return t.Bind(t.Sleep(1000*15),function(){return t.Return(null);});});}));}),null);},WebSharper_Community_Dashboard_ISource$get_OutPorts:function(){return u.ofArray([_1]);}};};h.get=function(_0,_1){return t.Delay(function(){var _2,_3,_4;_2=((_3=function(_5,_6,_7){return _5("http://api.openweathermap.org/data/2.5/weather?q="+v.toSafe(_6)+"&units=metric&appid="+v.toSafe(_7));},(o.Curried3(_3))(a.id))(_1))(_0);a.console.log("get key city "+_2);_4=x.AsyncMap(B.asyncReadTextAtRuntime(false,"C:\\Users\\Andrey\\Private\\VS_Projects\\WebSharper.Community.Dashboard\\WebSharper.Community.Dashboard","","JSON","",_2),function(_5){return C.Equals(typeof _5,"string")?a.JSON.parse(_5):_5;});return t.Bind(_4,function(_5){var _6;a.console.log("get key city 2");return t.Return((_6=function(_7){var _8,_9,_,$,ba,bb,bc,bd,be,bf,bg,bh,bi,bj,bk,bl,bm,bn,bo,bp,bq,br,bs;return i.New(((_8=function(bt,bu,bv){return bt(v.toSafe(bu)+", "+v.toSafe(bv));},(o.Curried3(_8))(a.id))((_9=(_="name",_ in _5?{$:1,$0:_5[_]}:null),_9==null?null:_9.$0)))(($=_5.sys,(ba=(bb="country",bb in $?{$:1,$0:$[bb]}:null),ba==null?null:ba.$0))),(bc=(bd="main",bd in _7?{$:1,$0:_7[bd]}:null),bc==null?null:bc.$0),(be=function(bt,bu){return bt("http://openweathermap.org/img/w/"+v.toSafe(bu)+".png");},(function(bt){return function(bu){return be(bt,bu);};}(a.id))((bf=(bg="icon",bg in _7?{$:1,$0:_7[bg]}:null),bf==null?null:bf.$0))),(bh=_5.main,(bi=(bj="temp",bj in bh?{$:1,$0:bh[bj]}:null),(bk=bi==null?null:{$:1,$0:1*bi.$0},bk==null?null:bk.$0))),[(bl=_5.main,(bm=(bn="temp_min",bn in bl?{$:1,$0:bl[bn]}:null),(bo=bm==null?null:{$:1,$0:1*bm.$0},bo==null?null:bo.$0))),(bp=_5.main,(bq=(br="temp_max",br in bp?{$:1,$0:bp[br]}:null),(bs=bq==null?null:{$:1,$0:1*bq.$0},bs==null?null:bs.$0)))]);},function(_7){return _7==null?null:{$:1,$0:_6(_7.$0)};}(D.tryHead(_5.weather))));});});};j.chart=function(_0,_1,_2){var _3,_4,_5,_6,_7,_8;_3=u.ofSeq(E.delay(function(){return E.map(function(){return 0;},F.range(0,_2-1));}));_4=(_5=[],(_6=function(_9){_5.push(_9);},function(_9){E.iter(_6,_9);}(_3),_5));_7=H.Line(_3).__WithFillColor(new I.Color({$:2,$0:"white"}));_8=new e.New("in Value",function(_9){var _,$;_4.push(_9);_4.length>_2?_=_4.shift():void 0;$=function(ba,bb){return _7.__UpdateData(ba,function(){return bb;});};(function(ba){E.iteri($,ba);}(_4));});return{WebSharper_Community_Dashboard_IReceiver$Render:function(){return K.Render$8(_7,{$:1,$0:{$:0,$0:_0,$1:_1}},null,null);},WebSharper_Community_Dashboard_IReceiver$get_InPorts:function(){return u.ofArray([_8]);}};};j.text=function(){var _0,_1;_0=N.Create$1("");_1=new e.New("in Value",function(_2){var _3,_4;_3=(_4=_2<<0,a.String(_4));N.Set(_0,_3);});return{WebSharper_Community_Dashboard_IReceiver$Render:function(){var _2,_3;_2=[O.Create("class","bigvalue")];_3=[P.TextView(_0.v)];return P.Element("div",_2,_3);},WebSharper_Community_Dashboard_IReceiver$get_InPorts:function(){return u.ofArray([_1]);}};};k.Create=function(_0,_1){return k.New(Q.Fresh(),_0,_1);};k.New=function(_0,_1,_2){return{Key:_0,Id:_1,Source:_2};};l.Create=function(_0){return l.New(Q.Fresh(),_0);};l.New=function(_0,_1){return{Key:_0,Receiver:_1};};m=d.Dashboard=o.Class({CreatePanel:function(_0,_1,_2){var _3,_4;_3=this;_4=S.get_Create().WithLayoutManager(T.StackPanelLayoutManager()).WithAttributes([U.Style("border","1px solid white"),U.Style("display","flex")]);this.PanelContainer.AddPanel(V.get_Create().WithPannelAttrs([U.Style("Width",a.String(_1)+"px"),U.Style("position","absolute")]).WithTitleContent(P.TextNode(_0)).WithTitleButtons(u.ofArray([W.New("add",function(){}),W.New("edit",function(_5){_3.PropertyGrid.Edit(_5.Properties);}),W.New("clear",function(_5){_3.PanelContainer.PanelItems.Remove(_3.PanelContainer.FindPanelItem(_5));})])).WithChildPanelContainer(_4).WithOnAfterRender(F.DefaultArg(_2,function(){})));return _4;},RegisterReceiver:function(_0,_1){this.ReceiverItems.Append(l.Create(_1));_0.AddPanel(V.get_Create().WithTitle(false).WithPanelContent(_1.WebSharper_Community_Dashboard_IReceiver$Render()));},RegisterSource:function(_0,_1){this.SourceItems.Append(k.Create(_0,_1));_1.WebSharper_Community_Dashboard_ISource$Run();},get_Render:function(){var _0,_1,_2,_3,_4,_5,_6,_7,_8,_9,_,$,ba,bb,bc,bd,be,bf,bg;_0=[(_1=[(_2=[(_3=[U.Style("vertical-align","top")],(_4=[(_5=[(_6=[U.Style("Height","100%")],(_7=[(_8=[U.Style("Height","100%")],(_9=[(_=[U.Class("material-icons orange600")],($=[P.TextNode("dehaze")],P.Element("i",_,$)))],P.Element("td",_8,_9)))],P.Element("tr",_6,_7))),(ba=[(bb=[(bc=[U.Class("material-icons orange600"),U.Style("cursor","pointer")],(bd=[P.TextNode("add")],P.Element("i",bc,bd)))],P.Element("td",[],bb))],P.Element("tr",[],ba)),(be=[(bf=[this.PropertyGrid.get_Render()],P.Element("td",[],bf))],P.Element("tr",[],be))],P.Element("table",[],_5))],P.Element("td",_3,_4))),(bg=[this.PanelContainer.get_Render()],P.Element("td",[],bg))],P.Element("tr",[],_2))],P.Element("table",[],_1))];return P.Element("div",[],_0);}},null,m);m.Create=function(_0){var _1,_2;return m.New((_1=u.T.Empty,X.Create(function(_3){return _3.Key;},_1)),(_2=u.T.Empty,X.Create(function(_3){return _3.Key;},_2)),_0,Z.get_Create());};m.New=function(_0,_1,_2,_3){return new m({SourceItems:_0,ReceiverItems:_1,PanelContainer:_2,PropertyGrid:_3});};}());
