(function(){"use strict";var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B;a=window;b=a.WebSharper=a.WebSharper||{};c=b.Community=b.Community||{};d=c.Panel=c.Panel||{};e=d.Helper=d.Helper||{};f=d.TitleButton=d.TitleButton||{};g=d.Panel=d.Panel||{};h=d.PanelContainer=d.PanelContainer||{};i=d.Rect=d.Rect||{};j=d.LayoutManagers=d.LayoutManagers||{};k=a.StartupCode$WebSharper_Community_Panel$LayoutManagers=a.StartupCode$WebSharper_Community_Panel$LayoutManagers||{};l=d.Dialog=d.Dialog||{};m=b&&b.List;n=b&&b.UI;o=n&&n.Next;p=o&&o.AttrModule;q=o&&o.Doc;r=a.IntelliFactory;s=r&&r.Runtime;t=o&&o.Var;u=o&&o.Input;v=u&&u.Mouse;w=o&&o.View;x=b&&b.Operators;y=b&&b.Seq;z=b&&b.Unchecked;A=o&&o.Key;B=o&&o.ListModel;e.IconSmall=function(C,D){return e.Icon("material-icons orange600 small",C,D);};e.IconNormal=function(C,D){return e.Icon("material-icons orange600",C,D);};e.Icon=function(C,D,E){var F,G;F=new m.T({$:1,$0:p.Class(C),$1:e.AttrsClick(E)});G=[q.TextNode(D)];return q.Element("i",F,G);};e.AttrsClick=function(C){return m.ofArray([p.Style("Color","#FB8C00"),p.Style("cursor","pointer"),p.Handler("click",function(){return function(){return C();};})]);};f=d.TitleButton=s.Class({Render:function(C){var D;D=this;return e.IconSmall(this.Icon,function(){D.Action(C);});}},null,f);f.New=function(C,D){return new f({Icon:C,Action:D});};g=d.Panel=s.Class({get_Render:function(){var C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,_0,_1,_2,_3,_4,_5,_6,_7,_8,_9,_,$,ba,bb;C=this;D=t.Create$1(false);E=t.Create$1(false);F=t.Create$1(0);G=t.Create$1(0);H=(I=v.get_LeftPressed(),w.Map(function(bc){return bc?D.c:false;},I));J=(K=v.get_Position(),w.UpdateWhile([0,0],H,K));L=(M=function(bc,bd){var be,bf,bg,bh,bi,bj,bk,bl;return D.c?(be=C.Element.c.getBoundingClientRect(),(bf=C.Element.c.parentElement.getBoundingClientRect(),(bg=bf.width-be.width,(bh=bf.height-be.height,(bi=x.Min(bg,x.Max(0,+bc-F.c)),(bj=x.Min(bh,x.Max(0,+bd-G.c)),(bk=C.Left,t.Set(bk,bi),bl=C.Top,t.Set(bl,bj),C.Relayout(C),[bi,bj]))))))):[C.Left.c,C.Top.c];},w.Map(function(bc){return M(bc[0],bc[1]);},J));N=y.concat([this.TitleAttrs,m.ofArray([p.Style("cursor","grab"),p.Handler("mouseenter",function(){return function(){return t.Set(E,true);};}),p.Handler("mouseleave",function(){return function(){return!D.c?t.Set(E,false):null;};}),p.Handler("mouseup",function(){return function(){t.Set(E,false);return t.Set(D,false);};}),p.Handler("mousedown",function(){return function(bc){var bd,be;((E.c?!z.Equals(C.Element.c.parentElement,null):false)?!z.Equals(C.Element.c.parentElement.parentElement,null):false)?t.Set(D,true):void 0;bd=+bc.clientX-C.Left.c;t.Set(F,bd);be=+bc.clientY-C.Top.c;return t.Set(G,be);};})])]);O=(P=[p.Style("width","100%")],(Q=[(R=[(S=[this.TitleContent],q.Element("td",[],S)),(T=[p.Style("text-align","right"),p.Style("vertical-align","middle")],(U=(V=function(bc){return bc.Render(C);},function(bc){return m.map(V,bc);}(this.TitleButtons)),q.Element("td",T,U)))],q.Element("tr",[],R))],q.Element("table",P,Q)));W=this.Width>0?m.ofArray([p.Style("width",(X=function(bc,bd){return bc(bd.toFixed(6)+"px");},(function(bc){return function(bd){return X(bc,bd);};}(a.id))(this.Width)))]):m.T.Empty;Y=this.Height>0?m.ofArray([p.Style("height",(Z=function(bc,bd){return bc(bd.toFixed(6)+"px");},(function(bc){return function(bd){return Z(bc,bd);};}(a.id))(this.Height)))]):m.T.Empty;_0=y.concat([this.PannelAttrs,y.concat([W,Y]),m.ofArray([p.DynamicStyle("left",(_1=this.Left.v,w.Map(function(bc){var bd;bd=function(be,bf){return be(bf.toFixed(6)+"px");};return(function(be){return function(bf){return bd(be,bf);};}(a.id))(bc);},_1))),p.DynamicStyle("left",(_2=function(bc){var bd;bd=function(be,bf){return be(bf.toFixed(6)+"px");};return(function(be){return function(bf){return bd(be,bf);};}(a.id))(bc);},w.Map(function(bc){return _2(bc[0],bc[1]);},L))),p.DynamicStyle("top",(_3=function(bc,bd){var be;be=function(bf,bg){return bf(bg.toFixed(6)+"px");};return(function(bf){return function(bg){return be(bf,bg);};}(a.id))(bd);},w.Map(function(bc){return _3(bc[0],bc[1]);},L))),p.DynamicStyle("top",(_4=this.Top.v,w.Map(function(bc){var bd;bd=function(be,bf){return be(bf.toFixed(6)+"px");};return(function(be){return function(bf){return bd(be,bf);};}(a.id))(bc);},_4)))])]);_5=(_6=[(_7=[(_8=[(_9=[this.IsWithTitle?q.Element("div",N,[O]):q.Element("div",[],[])],q.Element("td",W,_9))],q.Element("tr",[],_8)),(_=[($=[this.PanelContent,this.Children.get_Render()],q.Element("td",[],$))],q.Element("tr",[],_))],q.Element("table",[],_7))],q.Element("div",_0,_6));ba=this.Element;bb=_5.elt;t.Set(ba,bb);return _5.OnAfterRender(function(){C.onAfterRender(C);});},EditProperties:function(C){var D;C.Edit(m.concat([this.Properties,m.concat((D=function(E){return E.Properties;},function(E){return m.map(D,E);}(m.ofSeq(this.Children.PanelItems))))]));},WithHeight:function(C){return g.New(this.Key,this.Left,this.Top,this.Width,C,this.Element,this.Relayout,this.PannelAttrs,this.IsWithTitle,this.TitleAttrs,this.TitleContent,this.TitleButtons,this.PanelContent,this.Children,this.InternalName,this.onAfterRender,this.Properties);},WithWidth:function(C){return g.New(this.Key,this.Left,this.Top,C,this.Height,this.Element,this.Relayout,this.PannelAttrs,this.IsWithTitle,this.TitleAttrs,this.TitleContent,this.TitleButtons,this.PanelContent,this.Children,this.InternalName,this.onAfterRender,this.Properties);},WithProperties:function(C){return g.New(this.Key,this.Left,this.Top,this.Width,this.Height,this.Element,this.Relayout,this.PannelAttrs,this.IsWithTitle,this.TitleAttrs,this.TitleContent,this.TitleButtons,this.PanelContent,this.Children,this.InternalName,this.onAfterRender,C);},WithOnAfterRender:function(C){return g.New(this.Key,this.Left,this.Top,this.Width,this.Height,this.Element,this.Relayout,this.PannelAttrs,this.IsWithTitle,this.TitleAttrs,this.TitleContent,this.TitleButtons,this.PanelContent,this.Children,this.InternalName,C,this.Properties);},WithInternalName:function(C){return g.New(this.Key,this.Left,this.Top,this.Width,this.Height,this.Element,this.Relayout,this.PannelAttrs,this.IsWithTitle,this.TitleAttrs,this.TitleContent,this.TitleButtons,this.PanelContent,this.Children,C,this.onAfterRender,this.Properties);},WithTitle:function(C){return g.New(this.Key,this.Left,this.Top,this.Width,this.Height,this.Element,this.Relayout,this.PannelAttrs,C,this.TitleAttrs,this.TitleContent,this.TitleButtons,this.PanelContent,this.Children,this.InternalName,this.onAfterRender,this.Properties);},WithChildPanelContainer:function(C){return g.New(this.Key,this.Left,this.Top,this.Width,this.Height,this.Element,this.Relayout,this.PannelAttrs,this.IsWithTitle,this.TitleAttrs,this.TitleContent,this.TitleButtons,this.PanelContent,C,this.InternalName,this.onAfterRender,this.Properties);},WithRelayoutFnc:function(C){return g.New(this.Key,this.Left,this.Top,this.Width,this.Height,this.Element,C,this.PannelAttrs,this.IsWithTitle,this.TitleAttrs,this.TitleContent,this.TitleButtons,this.PanelContent,this.Children,this.InternalName,this.onAfterRender,this.Properties);},WithPanelContent:function(C){return g.New(this.Key,this.Left,this.Top,this.Width,this.Height,this.Element,this.Relayout,this.PannelAttrs,this.IsWithTitle,this.TitleAttrs,this.TitleContent,this.TitleButtons,C,this.Children,this.InternalName,this.onAfterRender,this.Properties);},WithTitleButtons:function(C){return g.New(this.Key,this.Left,this.Top,this.Width,this.Height,this.Element,this.Relayout,this.PannelAttrs,this.IsWithTitle,this.TitleAttrs,this.TitleContent,C,this.PanelContent,this.Children,this.InternalName,this.onAfterRender,this.Properties);},WithTitleContent:function(C){return g.New(this.Key,this.Left,this.Top,this.Width,this.Height,this.Element,this.Relayout,this.PannelAttrs,this.IsWithTitle,this.TitleAttrs,C,this.TitleButtons,this.PanelContent,this.Children,this.InternalName,this.onAfterRender,this.Properties);},WithTitleAttrs:function(C){return g.New(this.Key,this.Left,this.Top,this.Width,this.Height,this.Element,this.Relayout,this.PannelAttrs,this.IsWithTitle,C,this.TitleContent,this.TitleButtons,this.PanelContent,this.Children,this.InternalName,this.onAfterRender,this.Properties);},WithPannelAttrs:function(C){return g.New(this.Key,this.Left,this.Top,this.Width,this.Height,this.Element,this.Relayout,C,this.IsWithTitle,this.TitleAttrs,this.TitleContent,this.TitleButtons,this.PanelContent,this.Children,this.InternalName,this.onAfterRender,this.Properties);}},null,g);g.get_Create=function(){return g.New(A.Fresh(),t.Create$1(0),t.Create$1(0),0,0,t.Create$1(null),function(){},m.T.Empty,true,m.ofArray([p.Class("panelTitle")]),q.Element("div",[],[]),m.T.Empty,q.Element("div",[],[]),h.get_Create(),"",function(){},m.T.Empty);};g.New=function(C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S){return new g({Key:C,Left:D,Top:E,Width:F,Height:G,Element:H,Relayout:I,PannelAttrs:J,IsWithTitle:K,TitleAttrs:L,TitleContent:M,TitleButtons:N,PanelContent:O,Children:P,InternalName:Q,onAfterRender:R,Properties:S});};h=d.PanelContainer=s.Class({get_Render:function(){var C,D,E,F,G,H,I,J,K;C=this;D=this.Width>0?m.ofArray([p.Style("width",(E=function(L,M){return L(M.toFixed(6)+"px");},(function(L){return function(M){return E(L,M);};}(a.id))(this.Width)))]):m.T.Empty;F=this.Height>0?m.ofArray([p.Style("height",(G=function(L,M){return L(M.toFixed(6)+"px");},(function(L){return function(M){return G(L,M);};}(a.id))(this.Height)))]):m.T.Empty;H=y.concat([this.ContainerAttributes,D,F,m.ofArray([p.Style("position","relative")])]);I=[(J=function(L){return L.Key;},(K=function(L){var M;M=L.get_Render();return M.OnAfterRender(function(){C.LayoutManager.WebSharper_Community_Panel_ILayoutManager$PlacePanel(C,L);});},function(L){return q.ConvertBy(J,K,L);})(this.PanelItems.v))];return q.Element("div",H,I);},AddPanel:function(C){var D,E;this.PanelItems.Append(C.WithRelayoutFnc((D=this.LayoutManager,(E=this,function(F){D.WebSharper_Community_Panel_ILayoutManager$Relayout(E,F);}))));},FindPanelItem:function(C){var D;D=function(E){return z.Equals(E.Element,C.Element);};return function(E){return y.find(D,E);}(m.ofSeq(this.PanelItems));},WithHeight:function(C){return h.New(this.Width,C,this.PanelItems,this.LayoutManager,this.ContainerAttributes);},WithWidth:function(C){return h.New(C,this.Height,this.PanelItems,this.LayoutManager,this.ContainerAttributes);},WithLayoutManager:function(C){return h.New(this.Width,this.Height,this.PanelItems,C,this.ContainerAttributes);},WithAttributes:function(C){return h.New(this.Width,this.Height,this.PanelItems,this.LayoutManager,C);}},null,h);h.get_Create=function(){var C;return h.New(0,0,(C=m.T.Empty,B.Create(function(D){return D.Key;},C)),{WebSharper_Community_Panel_ILayoutManager$PlacePanel:function(){return null;},WebSharper_Community_Panel_ILayoutManager$Relayout:function(){return null;}},m.T.Empty);};h.New=function(C,D,E,F,G){return new h({Width:C,Height:D,PanelItems:E,LayoutManager:F,ContainerAttributes:G});};i=d.Rect=s.Class({toString:function(){return"left:"+a.String(this.left)+" "+" top:"+a.String(this.top)+" right:"+a.String(this.right)+" bottom:"+a.String(this.bottom);},inflate:function(C,D){var E,F;E=this.left-C;F=this.top-D;return i.New(E,this.right+C,F,this.bottom+D);},get_height:function(){return this.bottom-this.top;},get_width:function(){return this.right-this.left;},intersect:function(C){var D,E,F,G;D=x.Max(this.left,C.left);E=x.Min(this.right,C.right);F=x.Max(this.top,C.top);G=x.Min(this.bottom,C.bottom);return i.New(D,x.Max(D,E),F,x.Max(F,G));},offset:function(C,D){var E,F;E=this.left+C;F=this.top+D;return i.New(E,this.right+C,F,this.bottom+D);},get_isEmpty:function(){return this.left>=this.right?true:this.top>=this.bottom;}},null,i);i.fromPanel=function(C){return i.fromDomRect(C.Element.c).offset(C.Left.c,C.Top.c);};i.fromDomRect=function(C){var D;return!z.Equals(C,null)?(D=C.getBoundingClientRect(),i.New(0,D.width,0,D.height)):i.Create(0,0,0,0);};i.Create=function(C,D,E,F){return i.New(C,E,D,F);};i.New=function(C,D,E,F){return new i({left:C,right:D,top:E,bottom:F});};j.StackPanelLayoutManager=function(){k.$cctor();return k.StackPanelLayoutManager;};j.FloatingPanelLayoutManager=function(C){return{WebSharper_Community_Panel_ILayoutManager$PlacePanel:function(D,E){return j.placePanel(D,E,C);},WebSharper_Community_Panel_ILayoutManager$Relayout:function(D,E){return j.relayout(D,E,C);}};};j.relayout=function(C,D,E){var F,G,H,I,J,K,L;F=C.PanelItems;G=m.ofSeq(F);H=(I=function(M){return z.Equals(M.Key,D.Key);},function(M){return y.find(I,M);}(G));J=(K=function(M){return!z.Equals(M.Key,H.Key)?!i.fromPanel(M).intersect(i.fromPanel(H)).get_isEmpty():false;},function(M){return y.tryFind(K,M);}(m.ofSeq(F)));(J!=null?J.$==1:false)?(L=J.$0,j.movePanelToFreeSpace(F,L,E)):void 0;};j.placePanel=function(C,D,E){var F,G,H,I,J,K,L,M,N,O,P;F=i.fromPanel(D);G=(H=C.Width,(I=C.Height,i.Create(0,0,H,I)));J=(K=function(Q){return Q.get_width()>=F.get_width()?Q.get_height()>=F.get_height():false;},function(Q){return y.tryFind(K,Q);}(j.collectFreeSpace(C.PanelItems,G,D,E)));(J!=null?J.$==1:false)?(L=J.$0,M=D.Left,N=L.left+E,t.Set(M,N),O=D.Top,P=L.top+E,t.Set(O,P)):void 0;};j.movePanelToFreeSpace=function(C,D,E){var F,G,H,I,J,K,L,M,N;F=i.fromPanel(D);G=i.fromDomRect(D.Element.c.parentElement);H=(I=function(O){return O.get_width()>=F.get_width()?O.get_height()>=F.get_height():false;},function(O){return y.tryFind(I,O);}(j.collectFreeSpace(C,G,D,E)));(H!=null?H.$==1:false)?(J=H.$0,K=D.Left,L=J.left+E,t.Set(K,L),M=D.Top,N=J.top+E,t.Set(M,N)):void 0;};j.collectFreeSpace=function(C,D,E,F){var G,H,I;G=(H=function(J){return!z.Equals(J.Key,E.Key);},function(J){return m.filter(H,J);}(m.ofSeq(C)));I=m.ofArray([D]);return y.fold(function(J,K){var L,M,N,O,P,Q;L=j.panelRect(K,0);M=i.New(0,D.right,0,L.top);N=i.New(0,L.left,0,D.bottom);return m.concat((O=function(R){var S,T;S=function(U){return!U.get_isEmpty();};return function(U){return m.filter(S,U);}((T=function(U){return U.intersect(R);},function(U){return m.map(T,U);}(J)));},function(R){return m.map(O,R);}(m.ofArray([M,N,i.New(L.right,D.right,N.top,N.bottom),(P=L.bottom,(Q=D.bottom,i.New(M.left,M.right,P,Q)))]))));},I,G);};j.calcClientArea=function(C,D,E){var F,G,H,I,J,K,L,M,N,O,P,Q,R;F=function(S,T){var U,V;while(true)if(T.$==1){U=T.$1;V=T.$0;if(z.Equals(V.Key,D.Key))return S;else{S=new m.T({$:1,$0:V,$1:S});T=U;}}else return S;};G=(H=function(S){var T;T=S.InternalName;a.console.log(T);return j.panelRect(S,E);},function(S){return m.map(H,S);}((I=m.ofSeq(C),(J=m.T.Empty,function(S){return F(J,S);}(I)))));return G.$==0?i.Create(0,0,0,0):(K=m.min((L=function(S){return S.left;},function(S){return m.map(L,S);}(G))),(M=m.min((N=function(S){return S.top;},function(S){return m.map(N,S);}(G))),(O=m.max((P=function(S){return S.right;},function(S){return m.map(P,S);}(G))),(Q=m.max((R=function(S){return S.bottom;},function(S){return m.map(R,S);}(G))),i.Create(K,M,O,Q)))));};j.panelRect=function(C,D){return i.fromPanel(C).inflate(D,D);};k.$cctor=s.Cctor(function(){k.StackPanelLayoutManager={WebSharper_Community_Panel_ILayoutManager$PlacePanel:function(){return null;},WebSharper_Community_Panel_ILayoutManager$Relayout:function(C,D){return j.relayout(C,D,0);}};k.$cctor=a.ignore;});l=d.Dialog=s.Class({get_Render:function(){var C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z;C=this;D=[p.Style("position","absolute"),p.Style("left","50%"),p.Style("top","50%"),p.Style("z-index","1"),p.Style("background-color","white"),p.Style("min-height","100px"),p.Style("min-width","200px"),p.DynamicStyle("display",(E=this.Visibility.v,w.Map(function(_0){return _0?"block":"none";},E)))];F=[(G=[p.Style("background-color","grey"),p.Style("display","block"),p.Style("min-height","100px"),p.Style("min-width","200px")],(H=[(I=[(J=[(K=[p.Style("border-style","hidden"),p.Style("background","#404040"),p.Style("color","rgb(200,200,200)"),p.Style("padding","0px 2px 5px 2px"),p.Style("Width","200px"),p.Style("font-size","medium")],(L=[q.TextView(this.Title.v)],q.Element("td",K,L)))],q.Element("tr",[],J))],q.Element("table",[],I)),(M=[(N=[(O=[p.Style("padding","5px 0px 0px 2px")],(P=[(Q=a.id,function(_0){return q.BindView(Q,_0);}(this.Content.v))],q.Element("td",O,P)))],q.Element("tr",[],N)),(R=[(S=[p.Style("padding","20px 12px 2px 20px")],(T=[(U=[p.Style("border-radius","2px"),p.Handler("click",function(){return function(){var _0;_0=C.Visibility;t.Set(_0,false);return C.OKCallback.c();};})],(V=[q.TextNode("OK")],q.Element("button",U,V)))],q.Element("td",S,T))),(W=[p.Style("padding","20px 12px 2px 50px")],(X=[(Y=[p.Style("border-radius","2px"),p.Handler("click",function(){return function(){var _0;_0=C.Visibility;return t.Set(_0,false);};})],(Z=[q.TextNode("Cancel")],q.Element("button",Y,Z)))],q.Element("td",W,X)))],q.Element("tr",[],R))],q.Element("table",[],M))],q.Element("table",G,H)))];return q.Element("div",D,F);},ShowDialog:function(C,D,E){var F,G,H,I;F=this.Title;t.Set(F,C);G=this.Content;t.Set(G,D);H=this.Visibility;t.Set(H,true);I=this.OKCallback;t.Set(I,E);}},null,l);l.get_Create=function(){return l.New(t.Create$1(""),t.Create$1(q.Element("div",[],[])),t.Create$1(false),t.Create$1(function(){}));};l.New=function(C,D,E,F){return new l({Title:C,Content:D,Visibility:E,OKCallback:F});};}());
