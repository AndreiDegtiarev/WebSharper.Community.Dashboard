(function(){"use strict";var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H;a=window.WebSharper=window.WebSharper||{};b=a.Community=a.Community||{};c=b.Dashboard=b.Dashboard||{};d=c.Test=c.Test||{};e=d.AppModel=d.AppModel||{};f=d.AppData=d.AppData||{};g=d.Client=d.Client||{};h=window.IntelliFactory;i=h&&h.Runtime;j=c&&c.Worker;k=c&&c.RandomRunner;l=c&&c.OpenWeatherRunner;m=c&&c.TextBoxRenderer;n=c&&c.ChartRenderer;o=a&&a.Operators;p=a&&a.List;q=c&&c.Dashboard;r=b&&b.Panel;s=r&&r.PanelContainer;t=r&&r.LayoutManagers;u=a&&a.UI;v=u&&u.Next;w=v&&v.AttrModule;x=v&&v.Doc;y=c&&c.MessageBus;z=window.console;A=v&&v.Var;B=c&&c.RuleEntry;C=r&&r.Helper;D=r&&r.PanelData;E=c&&c.RuleContainer;F=c&&c.RuleChain;G=a&&a.Remoting;H=G&&G.AjaxRemotingProvider;e=d.AppModel=i.Class({get_Worker:function(){var I,J,K,L;return this.$==1?(I=this.$0,j.Create(I).WithRunner(I)):this.$==2?(J=this.$0,j.Create(J).WithRenderer(J)):this.$==3?(K=this.$0,j.Create(K).WithRunner(K).WithRenderer(K)):(L=this.$0,j.Create(L).WithRunner(L));}},null,e);e.ToWorker=function(I){return e.FromDataContext(I).get_Worker();};e.FromWorker=function(I){var J;J=I.DataContext;return J instanceof c.RandomRunner?new e({$:0,$0:(k.get_FromPorts())(I)}):J instanceof c.OpenWeatherRunner?new e({$:1,$0:(l.get_FromPorts())(I)}):J instanceof c.TextBoxRenderer?new e({$:2,$0:(m.get_FromPorts())(I)}):J instanceof c.ChartRenderer?new e({$:3,$0:(n.get_FromPorts())(I)}):o.FailWith("AllTypes FromDataContext unknown type");};e.FromDataContext=function(I){return I instanceof k?new e({$:0,$0:I}):I instanceof l?new e({$:1,$0:I}):I instanceof m?new e({$:2,$0:I}):I instanceof n?new e({$:3,$0:I}):o.FailWith("AllTypes FromDataContext unknown type");};f=d.AppData=i.Class({get_RecreateOnServer:function(){var I,J;this.Rules.Reconnect(p.map(function(K){return K.WithStartRunner();},p.append((I=function(K,L){return L.get_Worker();},p.map(function(K){return I(K[0],K[1]);},this.Events)),(J=function(K,L,M){return M.get_Worker();},p.map(function(K){return J(K[0],K[1],K[2]);},this.Widgets)))));},RecreateOnClient:function(I){var J,K;I.Restore(this.PanelData,(J=function(L,M){return[L,M.get_Worker()];},p.map(function(L){return J(L[0],L[1]);},this.Events)),(K=function(L,M,N){return[L,M,N.get_Worker()];},p.map(function(L){return K(L[0],L[1],L[2]);},this.Widgets)),this.Rules);},Recreate:function(I){var J,K;I.Restore(this.PanelData,(J=function(L,M){return[L,M.get_Worker().WithStartRunner()];},p.map(function(L){return J(L[0],L[1]);},this.Events)),(K=function(L,M,N){return[L,M,N.get_Worker()];},p.map(function(L){return K(L[0],L[1],L[2]);},this.Widgets)),this.Rules);}},null,f);f.get_CreateDashboard=function(){var I,J;function K(M){var N;J(M,(N=I.Factory,function(O){N.RegisterEvent(O);}));}function L(M){var N;J(M,(N=I.Factory,function(O){N.RegisterWidget(O);}));}I=q.Create(s.get_Create().WithLayoutManager(t.FloatingPanelLayoutManager(5)).WithWidth(800).WithHeight(420).WithAttributes([w.Style("border","1px solid white")]));J=function(M,N){return N(e.ToWorker(M));};K(l.Create("London",""));K(k.Create(50,5));L(m.get_Create());L(n.Create(300,100,50));return I;};f.Create=function(I){return f.New(p.map(function(J){return J.get_PanelData();},p.ofSeq(I.PanelContainer.PanelItems)),p.map(function(J){return[J.Worker.Key,e.FromWorker(J.Worker)];},p.ofSeq(I.Data.EventItems)),p.map(function(J){return[J.Widget.Key,J.Panel,e.FromWorker(J.Widget)];},p.ofSeq(I.Data.WidgetItems)),I.Editor.get_CopyToRules());};f.New=function(I,J,K,L){return new f({PanelData:I,Events:J,Widgets:K,Rules:L});};g.Main=function(){var I,J,K;function L(M){return x.Element("td",[],M);}y.set_Log(function(M){z.log(M);});I=A.Create$1("D:\\Dashboard.cfg");J=f.get_CreateDashboard();K=function(){var M,N,O,P,Q;function R(S){var T;T=S.get_Worker();return[[T.Key,M,S],B.New(T.InPorts.get_Item(0).Key,"",T.Key)];}f.Create(J);M=C.UniqueKey();N=new e({$:0,$0:k.Create(100,50)});O=N.get_Worker();P=R(new e({$:2,$0:m.get_Create()}));Q=R(new e({$:3,$0:n.Create(300,150,50)}));f.New(p.ofArray([D.Create(M,0,0,p.T.Empty)]),p.ofArray([[O.Key,N]]),p.ofArray([P[0],Q[0]]),E.New(p.ofArray([F.New(p.ofArray([B.New(O.InPorts.get_Item(0).Key,O.OutPorts.get_Item(0).Key,O.Key),P[1]])),F.New(p.ofArray([B.New(O.InPorts.get_Item(0).Key,O.OutPorts.get_Item(0).Key,O.Key),Q[1]]))]))).Recreate(J);};return x.Element("div",[],[x.Element("table",[],[x.Element("tr",[],[L(p.ofArray([C.TxtIconNormal("build","Sample configuration",function(){K();})])),L(p.ofArray([x.TextNode("File name"),x.Input([],I)])),L(p.ofArray([C.TxtIconNormal("archive","Upload",function(){(new H.New()).Send("WebSharper.Community.Dashboard.Test:WebSharper.Community.Dashboard.Test.Server.SaveToFile:-1567987319",[I.c,f.Create(J)]);})])),L(p.ofArray([C.TxtIconNormal("unarchive","Download  and run on client",function(){(new H.New()).Sync("WebSharper.Community.Dashboard.Test:WebSharper.Community.Dashboard.Test.Server.LoadFromFile:-133840407",[I.c]).Recreate(J);})])),L(p.ofArray([C.TxtIconNormal("cloud_upload","Download and run on server",function(){var M;M=(new H.New()).Sync("WebSharper.Community.Dashboard.Test:WebSharper.Community.Dashboard.Test.Server.LoadFromFile:-133840407",[I.c]);M.RecreateOnClient(J);(new H.New()).Send("WebSharper.Community.Dashboard.Test:WebSharper.Community.Dashboard.Test.Server.RecreateOnServer:-1126735520",[M]);y.RunServerRequests();})]))])]),J.get_Render()]);};}());
