(function(){"use strict";var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E;a=window;b=a.WebSharper=a.WebSharper||{};c=b.Community=b.Community||{};d=c.Dashboard=c.Dashboard||{};e=d.Test=d.Test||{};f=e.AppModel=e.AppModel||{};g=e.AppData=e.AppData||{};h=e.Client=e.Client||{};i=a.IntelliFactory;j=i&&i.Runtime;k=d&&d.AppModelLib;l=b&&b.Operators;m=b&&b.List;n=d&&d.MessageBus;o=b&&b.Remoting;p=o&&o.AjaxRemotingProvider;q=d&&d.RuleEntry;r=c&&c.Panel;s=r&&r.Helper;t=d&&d.RandomRunner;u=d&&d.TextBoxRenderer;v=d&&d.ChartRenderer;w=r&&r.PanelData;x=d&&d.RuleContainer;y=d&&d.RuleChain;z=d&&d.App;A=b&&b.UI;B=A&&A.Next;C=B&&B.Doc;D=a.console;E=B&&B.Var;f=e.AppModel=j.Class({get_Worker:function(){return this.$0.get_Worker();}},null,f);f.ToWorker=function(F){return f.FromDataContext(F).get_Worker();};f.FromWorker=function(F){var G;G=k.FromWorker(F);return G!=null&&G.$==1?new f({$:0,$0:G.$0}):l.FailWith("AllTypes FromWorker unknown type");};f.FromDataContext=function(F){var G;G=k.FromDataContext(F);return G!=null&&G.$==1?G.$0:l.FailWith("AllTypes FromDataContext unknown type");};g=e.AppData=j.Class({get_RecreateOnServer:function(){var F;function G(L,M){return M;}function H(L,M){return M;}function I(L,M,N){return N;}function J(L,M,N){return N;}function K(L,M){M.Reconnect(F);}F=m.map(function(L){return L.WithStartRunner();},m.append(m.map(function(L){return G(L[0],L[1]);},m.concat(m.map(function(L){return H(L[0],L[1]);},this.RecreateEvents(a.id)))),m.map(function(L){return I(L[0],L[1],L[2]);},m.concat(m.map(function(L){return J(L[0],L[1],L[2]);},this.get_RecreateWidgets())))));m.iter(function(L){return K(L[0],L[1]);},this.Rules);},RecreateOnClient:function(F,G){var H;n.set_Role(n.Role.Client);H=n.Agent();H.mailbox.AddLast({$:3,$0:function(I){(new p.New()).Send("WebSharper.Community.Dashboard:WebSharper.Community.Dashboard.MessageBus.SendToServer:-1358505674",[I]);}});H.resume();F.Restore(G,this.RecreateEvents(a.id),this.get_RecreateWidgets(),this.Rules);},Recreate:function(F,G){F.Restore(G,this.RecreateEvents(function(H){return H.WithStartRunner();}),this.get_RecreateWidgets(),this.Rules);},get_RecreateWidgets:function(){function F(G,H,I){function J(K,L,M){return[K,L,M.get_Worker()];}return[G,H,m.map(function(K){return J(K[0],K[1],K[2]);},I)];}return m.map(function(G){return F(G[0],G[1],G[2]);},this.Widgets);},RecreateEvents:function(F){function G(H,I){function J(K,L){return[K,F(L.get_Worker())];}return[H,m.map(function(K){return J(K[0],K[1]);},I)];}return m.map(function(H){return G(H[0],H[1]);},this.Events);}},null,g);g.Create=function(F){var G;G=F.Store(f.FromWorker);return g.New(G[0],G[1],G[2]);};g.New=function(F,G,H){return new g({Events:F,Widgets:G,Rules:H});};h.Main=function(){var F,G;function H(){var J,K,L,M,N,O;function P(Q){var R;R=Q.get_Worker();return[[R.Key,J,Q],q.New(R.InPorts.get_Item(0).Key,"",R.Key)];}g.Create(G);J=s.UniqueKey();K=new f({$:0,$0:new k({$:0,$0:t.Create(100,50)})});L=K.get_Worker();M=P(new f({$:0,$0:new k({$:3,$0:u.get_Create()})}));N=P(new f({$:0,$0:new k({$:4,$0:v.Create(300,150,50)})}));O=m.ofArray([w.Create(J,0,0,m.T.Empty)]);g.New(m.ofArray([["main",m.ofArray([[L.Key,K]])]]),m.ofArray([["main",O,m.ofArray([M[0],N[0]])]]),m.ofArray([["main",x.New(m.ofArray([y.New(m.ofArray([q.New(L.InPorts.get_Item(0).Key,L.OutPorts.get_Item(0).Key,L.Key),M[1]])),y.New(m.ofArray([q.New(L.InPorts.get_Item(0).Key,L.OutPorts.get_Item(0).Key,L.Key),N[1]]))]))]])).Recreate(G,function(){return z.PanelContainerCreator();});}function I(J){return C.Element("td",[],J);}n.set_Log(function(J){D.log(J);});F=E.Create$1("D:\\Dashboard.cfg");G=z.CreateDashboard();return C.Element("div",[],[C.Element("table",[],[C.Element("tr",[],[I(m.ofArray([s.TxtIconNormal("build","Sample configuration",function(){H();})])),I(m.ofArray([C.TextNode("File name"),C.Input([],F)])),I(m.ofArray([s.TxtIconNormal("archive","Upload",function(){(new p.New()).Send("WebSharper.Community.Dashboard.Test:WebSharper.Community.Dashboard.Test.Server.SaveToFile:-1567987319",[F.c,g.Create(G)]);})])),I(m.ofArray([s.TxtIconNormal("unarchive","Download  and run on client",function(){(new p.New()).Sync("WebSharper.Community.Dashboard.Test:WebSharper.Community.Dashboard.Test.Server.LoadFromFile:-133840407",[F.c]).Recreate(G,function(){return z.PanelContainerCreator();});})])),I(m.ofArray([s.TxtIconNormal("cloud_upload","Download and run on server",function(){var J;J=(new p.New()).Sync("WebSharper.Community.Dashboard.Test:WebSharper.Community.Dashboard.Test.Server.LoadFromFile:-133840407",[F.c]);J.RecreateOnClient(G,function(){return z.PanelContainerCreator();});(new p.New()).Send("WebSharper.Community.Dashboard.Test:WebSharper.Community.Dashboard.Test.Server.RecreateOnServer:-1126735520",[J]);n.RunServerRequests();})]))])]),G.get_Render()]);};}());
