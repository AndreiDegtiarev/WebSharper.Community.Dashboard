(function(){"use strict";var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C;a=window;b=a.WebSharper=a.WebSharper||{};c=b.Data=b.Data||{};d=c.Pervasives=c.Pervasives||{};e=c.WBRuntime=c.WBRuntime||{};f=e.WorldBankCountry=e.WorldBankCountry||{};g=e.WorldBankRuntime=e.WorldBankRuntime||{};h=a.FSharp=a.FSharp||{};i=h.Data=h.Data||{};j=i.Runtime=i.Runtime||{};k=j.WorldBank=j.WorldBank||{};l=k.Indicator=k.Indicator||{};m=c.JSRuntime=c.JSRuntime||{};n=c.TxtRuntime=c.TxtRuntime||{};o=j.IO=j.IO||{};p=b&&b.Strings;q=a.System;r=q&&q.Guid;s=b&&b.Concurrency;t=a.jQuery;u=b&&b.List;v=b&&b.JavaScript;w=v&&v.Pervasives;x=b&&b.Arrays;y=a.IntelliFactory;z=y&&y.Runtime;A=b&&b.Operators;B=a.Array;C=b&&b.Unchecked;d.randomFunctionName=function(){var D;return p.ReplaceChar((D=r.NewGuid(),a.String(D)).toLowerCase(),"-","_");};f.New=function(D,E,F){return{Context:D,Code:E,Name:F};};g.AsyncGetIndicator=function(D,E){return s.FromContinuations(function(F,G){var H,I;H=d.randomFunctionName();t.ajax((I={},I.url=e.worldBankUrl(D.Context,u.ofArray(["countries",D.Code,"indicators",E]),u.ofArray([["date","1900:2050"],["format","jsonp"]])),I.dataType="jsonp",I.jsonp="prefix",I.jsonpCallback="jsonp"+H,I.error=function(J,K,L){return G(a.Error(K+L));},I.success=function(J){return F(w.NewFromSeq(x.choose(function(K){return K.value==null?null:{$:1,$0:[K.date,K.value]};},x.get(J,1)).slice().reverse()));},I));});};g.GetIndicators=a.id;g.GetCountry=function(D,E,F){return f.New(D,E,F);};e.worldBankUrl=function(D,E,F){function G(H,I){return"&"+H+"="+a.encodeURIComponent(I);}return D.serviceUrl+"/"+p.concat("",u.map(function(H){return"/"+a.encodeURIComponent(H);},E))+"?per_page=1000"+p.concat("",u.map(function(H){return G(H[0],H[1]);},F));};l=k.Indicator=z.Class({TryGetValueAt:function(D){var E;E=this[a.String(D)];return E==void 0?null:{$:1,$0:E};}},b.Obj,l);m.GetArrayChildByTypeTag=function(D,E,F){var G;G=m.GetArrayChildrenByTypeTag(D,E,F,a.id);return x.length(G)===1?x.get(G,0):A.FailWith("JSON mismatch: Expected single value, but found multiple.");};m.TryGetArrayChildByTypeTag=function(D,E,F,G){var H;H=m.GetArrayChildrenByTypeTag(D,E,F,G);return x.length(H)===1?{$:1,$0:x.get(H,0)}:x.length(H)===0?null:A.FailWith("JSON mismatch: Expected Array with single or no elements.");};m.TryGetValueByTypeTag=function(D,E,F,G){var H;H=m.matchTag(F,D);return H==null?null:{$:1,$0:G(H.$0)};};m.GetArrayChildrenByTypeTag=function(D,E,F,G){return B.isArray(D)?x.map(function(H){return G(a.id(H));},x.choose(function(H){return m.matchTag(F,H);},D)):A.FailWith("JSON mismatch: Expected Array node");};m.matchTag=function(D,E){var F;return E==null?null:C.Equals(typeof E,"boolean")&&D==="Boolean"?{$:1,$0:E}:C.Equals(typeof E,"number")&&D==="Number"?{$:1,$0:E}:C.Equals(typeof E,"string")&&D==="Number"?(F=1*E,a.isNaN(F)?null:{$:1,$0:F}):C.Equals(typeof E,"string")&&D==="String"?{$:1,$0:E}:B.isArray(E)&&D==="Array"?{$:1,$0:E}:C.Equals(typeof E,"object")&&D==="Record"?{$:1,$0:E}:null;};n.AsyncMap=function(D,E){var F;F=null;return s.Delay(function(){return s.Bind(D,function(G){return s.Return(E(G));});});};o.asyncReadTextAtRuntimeWithDesignTimeRules=function(D,E,F,G,H){return o.asyncReadTextAtRuntime(false,D,E,F,G,H);};o.asyncReadTextAtRuntime=function(D,E,F,G,H,I){function J(K,L){var M,N,O,P,Q;M=(N=I.toLowerCase(),p.StartsWith(N,"jsonp|")?[I.substring(6),true]:p.StartsWith(N,"json|")?[I.substring(5),false]:[I,false]);O=(P={},P.dataType="json",P.success=function(R){return K(R);},P.error=function(R,S,T){return L(a.Error(T));},P);M[1]?(Q=d.randomFunctionName(),O.dataType="jsonp",O.jsonp="prefix",O.jsonpCallback="jsonp"+Q):void 0;t.ajax(M[0],O);}return s.FromContinuations(function(K,L,M){return J.apply(null,[K,L,M]);});};}());
