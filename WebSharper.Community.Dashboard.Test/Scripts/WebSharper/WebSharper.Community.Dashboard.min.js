(function(){"use strict";var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,_0,_1,_2,_3,_4,_5,_6,_7,_8,_9,_,$,ba,bb,bc,bd,be,bf,bg,bh,bi,bj,bk,bl,bm,bn,bo,bp,bq,br,bs,bt,bu,bv,bw,bx,by,bz,bA,bB,bC,bD,bE,bF,bG,bH,bI,bJ,bK,bL,bM,bN,bO,bP,bQ,bR,bS,bT,bU;a=window;b=a.WebSharper=a.WebSharper||{};c=b.Community=b.Community||{};d=c.Dashboard=c.Dashboard||{};e=d.Environment=d.Environment||{};f=e.Role=e.Role||{};g=a.StartupCode$WebSharper_Community_Dashboard$Environment=a.StartupCode$WebSharper_Community_Dashboard$Environment||{};h=d.MessageBus=d.MessageBus||{};i=h.Value=h.Value||{};j=h.Message=h.Message||{};k=h.ListenerInfo=h.ListenerInfo||{};l=h.SystemStatus=h.SystemStatus||{};m=h.AgentMessage=h.AgentMessage||{};n=h.AgentState=h.AgentState||{};o=a.StartupCode$WebSharper_Community_Dashboard$MessageBus=a.StartupCode$WebSharper_Community_Dashboard$MessageBus||{};p=d.InPortData=d.InPortData||{};q=d.InPort=d.InPort||{};r=d.OutPort=d.OutPort||{};s=d.WorkerData=d.WorkerData||{};t=d.Worker=d.Worker||{};u=d.Workers=d.Workers||{};v=d.RuleEntry=d.RuleEntry||{};w=d.RuleChain=d.RuleChain||{};x=d.RuleContainer=d.RuleContainer||{};y=d.WorkerItem=d.WorkerItem||{};z=d.Factory=d.Factory||{};A=d.RulesCellItem=d.RulesCellItem||{};B=d.RulesRowItem=d.RulesRowItem||{};C=d.SelectorGroup=d.SelectorGroup||{};D=d.WindowSelector=d.WindowSelector||{};E=d.WidgetItem=d.WidgetItem||{};F=d.EventsGroupItem=d.EventsGroupItem||{};G=d.WidgetsGroupItem=d.WidgetsGroupItem||{};H=d.RulesGroupItem=d.RulesGroupItem||{};I=d.DshData=d.DshData||{};J=d.RulesEditor=d.RulesEditor||{};K=d.DshHelper=d.DshHelper||{};L=d.Dashboard=d.Dashboard||{};M=d.Events=d.Events||{};N=M.RandomEvent=M.RandomEvent||{};O=M.DatabaseEventContext=M.DatabaseEventContext||{};P=M.DatabaseEvent=M.DatabaseEvent||{};Q=M.OpenWeather=M.OpenWeather||{};R=Q.Forecast=Q.Forecast||{};S=M.OpenWeatherEvent=M.OpenWeatherEvent||{};T=M.ClockEvent=M.ClockEvent||{};U=d.Widgets=d.Widgets||{};V=U.TextBoxWidget=U.TextBoxWidget||{};W=U.ChartWidgetContext=U.ChartWidgetContext||{};X=U.ChartWidget=U.ChartWidget||{};Y=U.ButtonWidget=U.ButtonWidget||{};Z=d.AppModelLib=d.AppModelLib||{};_0=d.App=d.App||{};_1=a.StartupCode$WebSharper_Community_Dashboard$AppModelLib=a.StartupCode$WebSharper_Community_Dashboard$AppModelLib||{};_2=d.AppDataHelper=d.AppDataHelper||{};_3=d.AppData=d.AppData||{};_4=a.IntelliFactory;_5=_4&&_4.Runtime;_6=b&&b.Operators;_7=c&&c.Panel;_8=_7&&_7.Helper;_9=a.Date;_=b&&b.List;$=b&&b.Concurrency;ba=b&&b.Remoting;bb=ba&&ba.AjaxRemotingProvider;bc=b&&b.Utils;bd=b&&b.Control;be=bd&&bd.MailboxProcessor;bf=b&&b.Seq;bg=b&&b.UI;bh=bg&&bg.Next;bi=bh&&bh.View;bj=bh&&bh.Var;bk=c&&c.PropertyGrid;bl=bk&&bk.Properties;bm=b&&b.MatchFailureException;bn=b&&b.Guid;bo=bh&&bh.Doc;bp=b&&b.Enumerator;bq=bh&&bh.Key;br=bh&&bh.ListModel;bs=b&&b.Unchecked;bt=bh&&bh.AttrModule;bu=b&&b.Option;bv=_7&&_7.WrapControls;bw=a.console;bx=_7&&_7.PanelContainer;by=_7&&_7.LayoutManagers;bz=_7&&_7.Panel;bA=_7&&_7.TitleButton;bB=_7&&_7.Dialog;bC=bk&&bk.PropertyGrid;bD=b&&b.Random;bE=a.Math;bF=b&&b.Data;bG=bF&&bF.TxtRuntime;bH=a.FSharp;bI=bH&&bH.Data;bJ=bI&&bI.Runtime;bK=bJ&&bJ.IO;bL=a.JSON;bM=b&&b.Arrays;bN=b&&b.DateUtil;bO=b&&b.Charting;bP=bO&&bO.Renderers;bQ=bP&&bP.ChartJs;bR=bd&&bd.FSharpEvent;bS=bO&&bO.Chart;bT=bO&&bO.LiveChart;bU=bO&&bO.Pervasives;f.Server={$:1};f.Client={$:0};e.UpdateConfiguration=function(){g.$cctor();return g.UpdateConfiguration;};e.set_UpdateConfiguration=function(bV){g.$cctor();g.UpdateConfiguration=bV;};e.DataDirectory=function(){g.$cctor();return g.DataDirectory;};e.set_DataDirectory=function(bV){g.$cctor();g.DataDirectory=bV;};e.Log=function(){g.$cctor();return g.Log;};e.set_Log=function(bV){g.$cctor();g.Log=bV;};e.Role$1=function(){g.$cctor();return g.Role;};e.set_Role=function(bV){g.$cctor();g.Role=bV;};g.$cctor=function(){g.$cctor=a.ignore;g.Role=f.Server;g.Log=a.ignore;g.DataDirectory="";g.UpdateConfiguration=a.ignore;};i=h.Value=_5.Class({get_trySystem:function(){return this.$==4?{$:1,$0:this.$0}:null;},get_AsSelect:function(){return this.$==3?this.$0:_6.FailWith("MessageBus.Value: unexpected type");},get_AsBoolean:function(){return this.$==2?this.$0:_6.FailWith("MessageBus.Value: unexpected type");},get_AsString:function(){return this.$==1?this.$0:_6.FailWith("MessageBus.Value: unexpected type");},get_AsNumber:function(){return this.$==0?this.$0:_6.FailWith("MessageBus.Value: unexpected type");}},null,i);j=h.Message=_5.Class({WithTime:function(bV){return j.New(this.Key,bV,this.Value);},WithKey:function(bV){return j.New(bV,this.Time,this.Value);}},null,j);j.Create=function(bV){return j.New(_8.UniqueKey(),_9.now(),bV);};j.New=function(bV,bW,bX){return new j({Key:bV,Time:bW,Value:bX});};k.Create=function(bV,bW,bX){return k.New(bV,bW,bX);};k.New=function(bV,bW,bX){return{Key:bV,Name:bW,CacheSize:bX};};l.Running={$:1};l.Inactive={$:0};m.Start={$:5};m.Stop={$:4};n.get_initListeners=function(){return _.ofArray([[k.Create("system","Configuration",1),function(bV){var bW;bW=bV.Value.get_trySystem();bW==null?void 0:(e.UpdateConfiguration())(bW.$0.$0);},_.T.Empty]]);};n.get_empty=function(){return n.New(l.Inactive,null,n.get_initListeners(),(new _9(1,1-1,1)).getTime());};n.New=function(bV,bW,bX,bY){return{SystemStatus:bV,ServerCallback:bW,Listeners:bX,LastConfigurationTime:bY};};h.RunServerRequests=function(){var bV;$.Start((bV=null,$.Delay(function(){return $.While(function(){return true;},$.Delay(function(){return $.Bind($.Sleep(2*1000),function(){return $.Bind(h.Agent().PostAndAsyncReply(function(bW){return{$:8,$0:bW};},null),function(bW){return $.TryWith($.Delay(function(){return $.Bind((new bb.New()).Async("WebSharper.Community.Dashboard:WebSharper.Community.Dashboard.MessageBus.GetMessages:1550733476",[bW]),function(bX){var bY;_.iter(function(bZ){var b0;b0=h.Agent();b0.mailbox.AddLast({$:1,$0:bZ});b0.resume();},bX);return bX.get_Length()>0?(_.iter(function(bZ){var b0;b0=(((_5.Curried3(function(b1,b2,b3){return b1(bc.toSafe(b2)+" "+bc.toSafe(b3));}))(a.id))(bZ.Key))(a.String(bZ.Time));(h.log())(b0);},bX),bY=(function(bZ){return function(b0){return bZ("Values from server requested messages received:"+a.String(b0));};}(a.id))(bX.get_Length()),(h.log())(bY),$.Zero()):$.Zero();});}),function(){return $.Zero();});});});}));})),null);};h.Agent=function(){o.$cctor();return o.Agent;};h.CreateMessage=function(bV){return j.New(_8.UniqueKey(),_9.now(),bV);};h.log=function(){o.$cctor();return o.log;};o.$cctor=function(){o.$cctor=a.ignore;o.log=e.Log();o.Agent=be.Start(function(bV){function bW(b1,b2){return bf.fold(function(b3,b4){var b5;return(b5=b4.Time-b1,b5/1000)>0.01?new _.T({$:1,$0:b4,$1:b3}):b3;},_.T.Empty,b2);}function bX(b1,b2){return b1<b2.get_Length()?(_.splitAt(b1,b2))[0]:b2;}function bY(b1,b2,b3){return b1===1?_.ofArray([b3]):bX(b1,new _.T({$:1,$0:b3,$1:b2}));}function bZ(b1,b2){function b3(b4,b5,b6){var b7,b8;b7=a.Array.prototype.slice.call(arguments);if(b4.Key===b1.Key){try{b5(b1);}catch(b9){b8=(function(b_){return function(b$){return b_("Fails send message. It might be that receiver doesn't expect message of this type: "+bc.toSafe(b$));};}(a.id))(b4.Name);(h.log())(b8);}return[b4,b5,bY(b4.CacheSize,b6,b1)];}else return b7;}return _.map(function(b4){return b3(b4[0],b4[1],b4[2]);},b2);}function b0(b1){var b2;b2=null;return $.Delay(function(){return $.Bind(bV.Receive(null),function(b3){var b4,b5,b6,b7,b8,b9,b_,b$;function ca(cc,cd,ce){return bW(b6,ce);}function cb(cc,cd,ce){return ce.$==0?b1.LastConfigurationTime:_.maxBy(function(cf){return cf.Time;},ce).Time;}return b3.$==5?b0(n.New(l.Running,b1.ServerCallback,b1.Listeners,b1.LastConfigurationTime)):b3.$==6?(b3.$0(b1.SystemStatus),b0(b1)):b3.$==2?(b4=b3.$0[0],(b5=(((_5.Curried3(function(cc,cd,ce){return cc("RegisterListener:"+bc.toSafe(cd)+" "+bc.toSafe(ce));}))(a.id))(b4.Name))(b4.Key),(h.log())(b5),b0(n.New(b1.SystemStatus,b1.ServerCallback,new _.T({$:1,$0:[b4,b3.$0[1],_.T.Empty],$1:b1.Listeners}),b1.LastConfigurationTime)))):b3.$==3?b0(n.New(b1.SystemStatus,{$:1,$0:b3.$0},b1.Listeners,b1.LastConfigurationTime)):b3.$==7?(b6=b3.$0[0],(b3.$0[1](_.sortBy(function(cc){return cc.Time;},bf.fold(function(cc,cd){return!_.contains(cd,cc)?new _.T({$:1,$0:cd,$1:cc}):cc;},_.T.Empty,_.concat(_.map(function(cc){return ca(cc[0],cc[1],cc[2]);},b1.Listeners))))),b0(b1))):b3.$==8?(b7=_.map(function(cc){return cb(cc[0],cc[1],cc[2]);},b1.Listeners),(b3.$0(b7.$==0?b1.LastConfigurationTime:_.max(b7)),b0(b1))):b3.$==1?(b8=b3.$0,(b9=b8.Value.get_trySystem(),b9==null?b0(n.New(b1.SystemStatus,b1.ServerCallback,bZ(b8,b1.Listeners),b1.LastConfigurationTime)):$.Combine(((e.UpdateConfiguration())(b9.$0.$0),$.Zero()),$.Delay(function(){return b0(n.New(b1.SystemStatus,b1.ServerCallback,b1.Listeners,b8.Time));})))):b3.$==0?(b_=b3.$0,(b$=b1.ServerCallback,b$==null?void 0:b$.$0(b_),b0(n.New(b1.SystemStatus,b1.ServerCallback,bZ(b_,b1.Listeners),b1.LastConfigurationTime)))):b0(n.New(l.Inactive,b1.ServerCallback,n.get_initListeners(),b1.LastConfigurationTime));});});}return b0(n.get_empty());},null);};p=d.InPortData=_5.Class({WithCacheSize:function(bV){return p.New(this.Key,this.Name,this.Value,bV);}},null,p);p.CreateSelect=function(bV,bW){return p.Create(bV,new i({$:3,$0:bW}));};p.CreateBoolean=function(bV,bW){return p.Create(bV,new i({$:2,$0:bW}));};p.CreateString=function(bV,bW){return p.Create(bV,new i({$:1,$0:bW}));};p.CreateNumber=function(bV,bW){return p.Create(bV,new i({$:0,$0:bW}));};p.Create=function(bV,bW){var bX;bX=h.CreateMessage(bW);return p.New(bX.Key,bV,bX.WithTime((new _9(1,1-1,1)).getTime()),1);};p.New=function(bV,bW,bX,bY){return new p({Key:bV,Name:bW,Value:bX,CacheSize:bY});};q=d.InPort=_5.Class({get_SelectView:function(){return bi.Map(function(bV){return bV.Value.get_AsSelect();},this.PortValue.v);},get_Select:function(){return this.PortValue.c.Value.get_AsSelect();},get_BooleanView:function(){return bi.Map(function(bV){return bV.Value.get_AsBoolean();},this.PortValue.v);},get_Boolean:function(){return this.PortValue.c.Value.get_AsBoolean();},get_StringView:function(){return bi.Map(function(bV){return bV.Value.get_AsString();},this.PortValue.v);},get_String:function(){return this.PortValue.c.Value.get_AsString();},get_NumberView:function(){return bi.Map(function(bV){return bV.Value.get_AsNumber();},this.PortValue.v);},get_Number:function(){return this.PortValue.c.Value.get_AsNumber();},Receive:function(bV){bj.Set(this.PortValue,bV);},get_Property:function(){var bV,bW,bX,bY,bZ,b0,b1;b0=this;b1=this.PortValue.c.Value;if(b1.$==0){bV=bj.Create$1(this.get_Number());bi.Sink(function(b2){var b3;bj.Set(b0.PortValue,(b3=b0.PortValue.c,j.New(b3.Key,b3.Time,new i({$:0,$0:b2}))));},bV.v);return bl["double"](this.Data.Name,bV);}else if(b1.$==1){bW=bj.Create$1(this.get_String());bi.Sink(function(b2){var b3;bj.Set(b0.PortValue,(b3=b0.PortValue.c,j.New(b3.Key,b3.Time,new i({$:1,$0:b2}))));},bW.v);return bl.string(this.Data.Name,bW);}else if(b1.$==2){bX=bj.Create$1(this.get_Boolean());bi.Sink(function(b2){var b3;bj.Set(b0.PortValue,(b3=b0.PortValue.c,j.New(b3.Key,b3.Time,new i({$:2,$0:b2}))));},bX.v);return bl.check(this.Data.Name,bX);}else if(b1.$==3){bY=b1.$0[1];bZ=bj.Create$1(bY.get_Item(b1.$0[0]));bi.Sink(function(b2){var b3;bj.Set(b0.PortValue,(b3=b0.PortValue.c,j.New(b3.Key,b3.Time,new i({$:3,$0:[bf.findIndex(function(b4){return b4===b2;},bY),bY]}))));},bZ.v);return bl.select(this.Data.Name,a.id,bY,bZ);}else throw new bm.New("Port.fs",38,30);},get_Key:function(){return this.Data.Key;},get_Name:function(){return this.Data.Name;}},null,q);q.Clone=function(bV){var bW,bX;return q.New((bW=bV.Data,p.New((bX=bn.NewGuid(),a.String(bX)),bW.Name,bW.Value,bW.CacheSize)),bj.Create$1(bV.PortValue.c));};q.ToData=function(bV){var bW;bW=bV.Data;return p.New(bW.Key,bW.Name,bV.PortValue.c,bW.CacheSize);};q.FromData=function(bV){return q.New(bV,bj.Create$1(bV.Value));};q.New=function(bV,bW){return new q({Data:bV,PortValue:bW});};r=d.OutPort=_5.Class({Trigger:function(bV){var bW,bX;bW={$:0,$0:h.CreateMessage(bV).WithKey(this.Key)};bX=h.Agent();bX.mailbox.AddLast(bW);bX.resume();}},null,r);r.Clone=function(bV){return r.New(_8.UniqueKey(),bV.Name);};r.Create=function(bV){return r.New(_8.UniqueKey(),bV);};r.New=function(bV,bW){return new r({Key:bV,Name:bW});};s.Create=function(bV,bW,bX){return s.New(bV,bW,bX);};s.New=function(bV,bW,bX){return{WorkerName:bV,InPorts:bW,OutPorts:bX};};t=d.Worker=_5.Class({get_Properties:function(){return new _.T({$:1,$0:bl.string("Name",this.Name),$1:_.map(function(bV){return bV.get_Property();},this.InPorts)});},get_Render:function(){var bV;bV=this.Data.WebSharper_Community_Dashboard_IWorkerData$get_Render();return bV==null?bo.Empty():bV.$0(this);},get_Clone:function(){return t.New(_8.UniqueKey(),bj.Create$1(this.Name.c),_.map(q.Clone,this.InPorts),_.map(r.Clone,this.OutPorts),this.Data,bj.Create$1(null));},get_ToData:function(){return s.New(this.Name.c,_.map(q.ToData,this.InPorts),this.OutPorts);},StartRunner:function(){var bV;bV=this.Data.WebSharper_Community_Dashboard_IWorkerData$get_Run();bV==null?void 0:bj.Set(this.RunnerContext,bV.$0(this));},WithKey:function(bV){return t.New(bV,this.Name,this.InPorts,this.OutPorts,this.Data,this.RunnerContext);}},null,t);t.Create=function(bV){return t.New(_8.UniqueKey(),bj.Create$1(bV.WebSharper_Community_Dashboard_IWorkerData$get_Data().WorkerName),_.map(q.FromData,bV.WebSharper_Community_Dashboard_IWorkerData$get_Data().InPorts),bV.WebSharper_Community_Dashboard_IWorkerData$get_Data().OutPorts,bV,bj.Create$1(null));};t.New=function(bV,bW,bX,bY,bZ,b0){return new t({Key:bV,Name:bW,InPorts:bX,OutPorts:bY,Data:bZ,RunnerContext:b0});};u.allInPorts=function(bV){return u.allPorts(bV,function(bW){return bW.InPorts;});};u.allOutPorts=function(bV){return u.allPorts(bV,function(bW){return bW.OutPorts;});};u.allPorts=function(bV,bW){return _.concat(_.map(bW,bV));};v.New=function(bV,bW,bX){return{InPortKey:bV,OutPortKey:bW,WorkerKey:bX};};w.New=function(bV){return{RuleChain:bV};};x=d.RuleContainer=_5.Class({Reconnect:function(bV){var bW,bX,bY;bW=e.Log();bX=u.allOutPorts(bV);bY=u.allInPorts(bV);_.iter(function(bZ){var b0,b1,b2;b0=_.ofSeq(bZ.RuleChain);b1=_.ofSeq(_6.range(1,b0.get_Length()-1));b2=bp.Get(b1);try{while(b2.MoveNext())(function(){var b3,b4,b5,b6,b7,b8,b9,b_;b3=b2.Current();b4=b0.get_Item(b3-1);b5=b0.get_Item(b3);{b6=bf.tryFind(function(b$){return b$.Key===b4.OutPortKey;},bX),b6==null?null:{$:1,$0:(b7=b6.$0,(b8=bf.tryFind(function(b$){return b$.Data.Key===b5.InPortKey;},bY),b8==null?null:{$:1,$0:(b9=b8.$0,(bW("Found inPort"),b9.PortValue.c.Key!==b9.Data.Key?bj.Set(b9.PortValue,b9.PortValue.c.WithKey(b9.Data.Key)):void 0,b_=h.Agent(),b_.mailbox.AddLast({$:2,$0:[k.Create(b7.Key,b7.Name+"->"+b9.get_Name(),b9.Data.CacheSize),function(b$){b9.Receive(b$);}]}),b_.resume()))}))};return;}}());}finally{if("Dispose"in b2)b2.Dispose();}},_.ofSeq(this.RuleContainer));}},null,x);x.New=function(bV){return new x({RuleContainer:bV});};y.Create=function(bV){return y.New(bq.Fresh(),bV);};y.New=function(bV,bW){return{Key:bV,Worker:bW};};z=d.Factory=_5.Class({RegisterEvent:function(bV){this.EventItems.Append(y.Create(bV));},RegisterWidget:function(bV){this.WidgetItems.Append(y.Create(bV));}},null,z);z.get_Create=function(){return z.New(br.Create(function(bV){return bV.Key;},_.T.Empty),br.Create(function(bV){return bV.Key;},_.T.Empty));};z.New=function(bV,bW){return new z({EventItems:bV,WidgetItems:bW});};A=d.RulesCellItem=_5.Class({Render:function(bV,bW){var bX,bY,bZ,b0,b1;bX=this;bi.Sink(function(b2){var b3,b4,b5,b6,b7;if(b2==null);else{b3=b2.$0;b4=bX.OptInPort.c;b4==null?bj.Set(bX.OptInPort,_.tryHead(b3.Worker.InPorts)):(b5=b4.$0,!_.exists(function(b8){return bs.Equals(b8,b5);},b3.Worker.InPorts)?bj.Set(bX.OptInPort,_.tryHead(b3.Worker.InPorts)):void 0);b6=bX.OptOutPort.c;b6==null?bj.Set(bX.OptOutPort,_.tryHead(b3.Worker.OutPorts)):(b7=b6.$0,!_.exists(function(b8){return bs.Equals(b8,b7);},b3.Worker.OutPorts)?bj.Set(bX.OptOutPort,_.tryHead(b3.Worker.OutPorts)):void 0);bW();}},this.OptWorker.v);bi.Sink(function(){bW();},this.OptInPort.v);bi.Sink(function(){bW();},this.OptOutPort.v);bY=(bZ=bi.Map(function(b2){var b3;return b2==null?_.ofArray([null]):(b3=_.map(function(b4){return{$:1,$0:b4};},b2.$0.Worker.InPorts),b3.get_Length()>0?b3:_.ofArray([null]));},this.OptWorker.v),(b0=bi.Map(function(b2){var b3;return b2==null?_.ofArray([null]):(b3=_.map(function(b4){return{$:1,$0:b4};},b2.$0.Worker.OutPorts),b3.get_Length()>0?b3:_.ofArray([null]));},this.OptWorker.v),(b1=bi.Map(function(b2){return new _.T({$:1,$0:null,$1:_.map(function(b3){return{$:1,$0:b3};},_.ofSeq(b2))});},bV.v),bo.Element("table",[],[bo.Element("tr",[],[bo.Element("td",[],[bo.SelectDyn([bt.Class("form-control")],function(b2){return bu.fold(function(b3,b4){return b4.get_Name();}," ",b2);},bZ,this.OptInPort)]),bo.Element("td",[],[bo.SelectDyn([bt.Class("form-control")],function(b2){return bu.fold(function(b3,b4){return b4.Worker.Name.c;}," ",b2);},b1,this.OptWorker)]),bo.Element("td",[],[bo.SelectDyn([bt.Class("form-control")],function(b2){return bu.fold(function(b3,b4){return b4.Name;}," ",b2);},b0,this.OptOutPort)])])]))));return bo.Element("td",[bt.Class("td DshEditorCell")],[bo.Element("div",[bt.Class("div DshEditorCell")],[bo.Element("table",[],[bo.Element("tr",[],[bo.Element("td",[],[bY])])])])]);}},null,A);A.get_Create=function(){return A.New(bq.Fresh(),bj.Create$1(null),bj.Create$1(null),bj.Create$1(null));};A.New=function(bV,bW,bX,bY){return new A({Key:bV,OptInPort:bW,OptWorker:bX,OptOutPort:bY});};B=d.RulesRowItem=_5.Class({Render:function(bV,bW){var bX;bX=this;return bo.Element("tr",[],[bo.ConvertBy(function(bY){return bY.Key;},function(bY){return bY.Render(bV,bW);},this.CellItems.v),_8.IconNormal("add",function(){bX.CellItems.Append(A.get_Create());})]);}},null,B);B.Create=function(bV){return B.New(bq.Fresh(),br.Create(function(bW){return bW.Key;},bV));};B.New=function(bV,bW){return new B({Key:bV,CellItems:bW});};C=d.SelectorGroup=_5.Class({RenderMenu:function(bV,bW,bX){var bY,bZ,b0,b1,b2,b3;function b4(b5){return _.ofArray([_8.IconSmall("keyboard_arrow_down",function(){(bZ(true))(b5);(bY.ItemOnMove(b5))({$:1});}),_8.IconSmall("keyboard_arrow_up",function(){(bZ(false))(b5);(bY.ItemOnMove(b5))({$:0});}),_8.IconSmall("clear",function(){bY.SelectorItems.Remove(b5);bY.ItemOnDelete(b5);})]);}bY=this;bZ=(b0=this.SelectorItems,(_5.Curried3(_8.MoveItemInModelList))(b0));b1=(b2=this.ItemCreatator,b2==null?bo.Element("tr",[],[]):(b3=b2.$0,bo.Element("tr",[],[bo.Element("td",[],[bo.Element("div",[bt.Style("margin-left","20px")],[_8.IconSmall("add",function(){var b5;b5=b3();bY.ItemOnCreated(b5);bY.SelectorItems.Append(b5);})])])])));return bo.Element("table",[],[bo.ConvertBy(function(b5){return b5.WebSharper_Community_Dashboard_ISelectorItem$get_Key();},function(b5){var b6,b7,b8,b9;b6=bi.Map(function(b_){return bV+b_;},b5.WebSharper_Community_Dashboard_ISelectorItem$get_Name().v);return bo.Element("tr",[],[bo.Element("td",[bt.DynamicStyle("Color",bi.Map(function(b_){return b_==null?"#7D4600":bs.Equals(b_.$0.WebSharper_Community_Dashboard_ISelectorItem$get_Key(),b5.WebSharper_Community_Dashboard_ISelectorItem$get_Key())?"#FB8C00":"#7D4600";},bW.v))],[(b7=bo.Element("div",[bt.Style("margin-left","10px"),bt.Style("margin-right","5px"),bt.Style("cursor","pointer"),bt.Handler("click",function(){return function(){bY.ItemOnSelected(b5);return bj.Set(bW,{$:1,$0:b5});};})],[bo.TextView(b6)]),(bX?(b8=b4(b5),(b9=_7.WrapControlsAligment.Horizontal,function(b_){return bv.Render(b8,b9,b_);})):a.id)(b7))])]);},this.SelectorItems.v),b1]);}},null,C);C.Create=function(bV,bW,bX,bY,bZ,b0,b1){var b2;b2=br.Create(function(b3){return b3.WebSharper_Community_Dashboard_ISelectorItem$get_Key();},bW);return C.New(bq.Fresh(),bj.Create$1(bV),b2,bX,bY,bZ,b0,b1);};C.New=function(bV,bW,bX,bY,bZ,b0,b1,b2){return new C({Key:bV,Name:bW,SelectorItems:bX,ItemCreatator:bY,ItemOnCreated:bZ,ItemOnSelected:b0,ItemOnDelete:b1,ItemOnMove:b2});};D=d.WindowSelector=_5.Class({get_RenderMenu:function(){var bV;bV=this;return this.SelectorGroups.get_Length()===1?_.head(_.ofSeq(this.SelectorGroups)).RenderMenu("",this.OptSelectedItem,this.IsWithControls):bo.Element("div",[],[bo.ConvertBy(function(bW){return bW.Key;},function(bW){return bo.Element("div",[],[bo.Element("div",[bt.Style("cursor","pointer"),bt.Handler("click",function(){return function(){return bV.GroupOnClick(bW);};})],[bo.TextView(bW.Name.v)]),bW.RenderMenu("    ",bV.OptSelectedItem,bV.IsWithControls)]);},this.SelectorGroups.v)]);},get_Render:function(){return bo.Element("div",[],[bo.BindView(function(bV){return bV==null?bo.Empty():bV.$0.WebSharper_Community_Dashboard_ISelectorItem$get_Render();},this.OptSelectedItem.v)]);},GroupByIndex:function(bV){return bf.nth(bV,_.ofSeq(this.SelectorGroups));},get_SelectedIndex:function(){var bV;bV=this;return bf.findIndex(function(bW){return bs.Equals(bW.WebSharper_Community_Dashboard_ISelectorItem$get_Key(),bV.get_SelectedItem().WebSharper_Community_Dashboard_ISelectorItem$get_Key());},_.concat(_.map(function(bW){return _.ofSeq(bW.SelectorItems);},_.ofSeq(this.SelectorGroups))));},get_SelectedIndexInGroup:function(){var bV;bV=this;return bf.findIndex(function(bW){return bs.Equals(bW.WebSharper_Community_Dashboard_ISelectorItem$get_Key(),bV.get_SelectedItem().WebSharper_Community_Dashboard_ISelectorItem$get_Key());},_.ofSeq(this.get_SelectedGroup().SelectorItems));},get_SelectedGroupIndex:function(){var bV;bV=this;return bf.findIndex(function(bW){return bs.Equals(bW.Key,bV.get_SelectedGroup().Key);},_.ofSeq(this.SelectorGroups));},get_SelectedGroup:function(){return this.GroupFromItem(this.get_SelectedItem());},GroupFromItem:function(bV){return bf.find(function(bW){return _.exists(function(bX){return bs.Equals(bX.WebSharper_Community_Dashboard_ISelectorItem$get_Key(),bV.WebSharper_Community_Dashboard_ISelectorItem$get_Key());},_.ofSeq(bW.SelectorItems));},_.ofSeq(this.SelectorGroups));},AppenGroup:function(bV,bW,bX){var bY;bY=this.SelectorGroups.get_Length();this.SelectorGroups.Append(C.Create(bV,bW,bX,this.ItemOnCreated(bY),this.ItemOnSelected,this.ItemOnDeleted(bY),this.ItemOnMove(bY)));},get_SelectedItem:function(){var bV;bV=this.OptSelectedItem.c;return bV==null?_6.FailWith("Something really wrong with WindowSelector"):bV.$0;},ClearGroups:function(){bj.Set(this.OptSelectedItem,null);_.iter(function(bV){bV.SelectorItems.Clear();},_.ofSeq(this.SelectorGroups));},WithControls:function(bV){return D.New(this.OptSelectedItem,this.SelectorGroups,this.ItemOnCreated,this.GroupOnClick,this.ItemOnSelected,this.ItemOnDeleted,this.ItemOnMove,bV);},WithItemOnMove:function(bV){return D.New(this.OptSelectedItem,this.SelectorGroups,this.ItemOnCreated,this.GroupOnClick,this.ItemOnSelected,this.ItemOnDeleted,bV,this.IsWithControls);},WithItemOnDeleted:function(bV){return D.New(this.OptSelectedItem,this.SelectorGroups,this.ItemOnCreated,this.GroupOnClick,this.ItemOnSelected,bV,this.ItemOnMove,this.IsWithControls);},WithItemOnSelected:function(bV){return D.New(this.OptSelectedItem,this.SelectorGroups,this.ItemOnCreated,this.GroupOnClick,bV,this.ItemOnDeleted,this.ItemOnMove,this.IsWithControls);},WithGroupOnClick:function(bV){return D.New(this.OptSelectedItem,this.SelectorGroups,this.ItemOnCreated,bV,this.ItemOnSelected,this.ItemOnDeleted,this.ItemOnMove,this.IsWithControls);},WithItemOnCreated:function(bV){return D.New(this.OptSelectedItem,this.SelectorGroups,bV,this.GroupOnClick,this.ItemOnSelected,this.ItemOnDeleted,this.ItemOnMove,this.IsWithControls);}},null,D);D.get_Create=function(){var bV;bV=br.Create(function(bW){return bW.Key;},_.T.Empty);return D.New(bj.Create$1(null),bV,function(){return function(){return null;};},a.ignore,a.ignore,function(){return function(){return null;};},_5.Curried3(function(bW,bX,bY){return null;}),false);};D.New=function(bV,bW,bX,bY,bZ,b0,b1,b2){return new D({OptSelectedItem:bV,SelectorGroups:bW,ItemOnCreated:bX,GroupOnClick:bY,ItemOnSelected:bZ,ItemOnDeleted:b0,ItemOnMove:b1,IsWithControls:b2});};E.Create=function(bV,bW){return E.New(bq.Fresh(),bV,bW);};E.New=function(bV,bW,bX){return{Key:bV,Panel:bW,Widget:bX};};F=d.EventsGroupItem=_5.Class({get_Render:function(){var bV,bW,bX;function bY(bZ){return _.ofArray([_8.IconSmall("keyboard_arrow_down",function(){(bW(true))(bZ);}),_8.IconSmall("keyboard_arrow_up",function(){(bW(false))(bZ);}),_8.IconSmall("clear",function(){bV.EventItems.Remove(bZ);})]);}bV=this;bW=(bX=this.EventItems,(_5.Curried3(_8.MoveItemInModelList))(bX));return bo.Element("table",[],[bo.ConvertBy(function(bZ){return bZ.Key;},function(bZ){var b0;return bo.Element("tr",[],[(b0=bo.Element("div",_8.AttrsClick(function(){bV.PropertyGrid.Edit(bZ.Worker.get_Properties());}),[bo.TextView(bZ.Worker.Name.v)]),bv.Render(bY(bZ),_7.WrapControlsAligment.Horizontal,b0))]);},this.EventItems.v)]);},WebSharper_Community_Dashboard_ISelectorItem$get_Render:function(){return this.get_Render();},WebSharper_Community_Dashboard_ISelectorItem$get_Name:function(){return this.Name;},WebSharper_Community_Dashboard_ISelectorItem$get_Key:function(){return this.Key;}},null,F);F.Create=function(bV,bW){return F.New(bq.Fresh(),bj.Create$1(bV),br.Create(function(bX){return bX.Key;},_.T.Empty),bW);};F.New=function(bV,bW,bX,bY){return new F({Key:bV,Name:bW,EventItems:bX,PropertyGrid:bY});};G=d.WidgetsGroupItem=_5.Class({get_Render:function(){return this.PanelContainer.get_Render();},WebSharper_Community_Dashboard_ISelectorItem$get_Render:function(){return this.get_Render();},WebSharper_Community_Dashboard_ISelectorItem$get_Name:function(){return this.Name;},WebSharper_Community_Dashboard_ISelectorItem$get_Key:function(){return this.Key;}},null,G);G.Create=function(bV,bW){return G.New(bq.Fresh(),bj.Create$1(bV),br.Create(function(bX){return bX.Key;},_.T.Empty),bW);};G.New=function(bV,bW,bX,bY){return new G({Key:bV,Name:bW,WidgetItems:bX,PanelContainer:bY});};H=d.RulesGroupItem=_5.Class({Equals:function(bV){return bV instanceof H&&bs.Equals(this.Key,bV.Key);},get_Render:function(){return this.Renderer(this.RulesRowItems);},WebSharper_Community_Dashboard_ISelectorItem$get_Render:function(){return this.get_Render();},WebSharper_Community_Dashboard_ISelectorItem$get_Name:function(){return this.Name;},WebSharper_Community_Dashboard_ISelectorItem$get_Key:function(){return this.Key;}},null,H);H.Create=function(bV,bW){return H.New(bq.Fresh(),bj.Create$1(bV),br.Create(function(bX){return bX.Key;},_.T.Empty),bW);};H.New=function(bV,bW,bX,bY){return new H({Key:bV,Name:bW,RulesRowItems:bX,Renderer:bY});};I=d.DshData=_5.Class({RegisterWidget:function(bV,bW,bX,bY){var bZ;bZ=bY.WithKey(bV);bW.WidgetItems.Append(E.Create(bX,bZ));this.WorkItems.Append(y.Create(bZ));},RegisterEvent:function(bV,bW,bX){var bY;bY=y.Create(bX.WithKey(bV));bW.EventItems.Append(bY);this.WorkItems.Append(bY);},get_Clear:function(){this.WorkItems.Clear();this.WidgetGroups.Clear();this.EventGroups.Clear();this.RulesGroups.Clear();}},null,I);I.get_Create=function(){return I.New(br.Create(function(bV){return bV.Key;},_.T.Empty),br.Create(function(bV){return bV.Key;},_.T.Empty),br.Create(function(bV){return bV.Key;},_.T.Empty),br.Create(function(bV){return bV.Key;},_.T.Empty));};I.New=function(bV,bW,bX,bY){return new I({WorkItems:bV,WidgetGroups:bW,EventGroups:bX,RulesGroups:bY});};J.Render=function(bV,bW){function bX(b0,b1){return _8.MoveItemInModelList(bW,b0,b1);}function bY(b0){return _.ofArray([_8.IconSmall("keyboard_arrow_down",function(){bX(true,b0);}),_8.IconSmall("keyboard_arrow_up",function(){bX(false,b0);}),_8.IconSmall("clear",function(){bW.Remove(b0);})]);}function bZ(){var b0;$.Start((b0=null,$.Delay(function(){return $.Bind(h.Agent().PostAndAsyncReply(function(b1){return{$:6,$0:b1};},null),function(b1){var b2,b3,b4;return b1.$==1?(b2=h.Agent(),b2.mailbox.AddLast(m.Stop),b2.resume(),b3=_.map(function(b5){return b5.Worker;},_.ofSeq(bV.WorkItems)),J.CopyToRules(bW).Reconnect(b3),b4=h.Agent(),b4.mailbox.AddLast(m.Start),b4.resume(),$.Zero()):$.Zero();});})),null);}return bo.Element("table",[],[bo.ConvertBy(function(b0){return b0.Key;},function(b0){var b1;return bo.Element("tr",[],[(b1=b0.Render(bV.WorkItems,function(){bZ();}),bv.Render(bY(b0),_7.WrapControlsAligment.Horizontal,b1))]);},bW.v)]);};J.Restore=function(bV,bW,bX){var bY,bZ,b0;bW.Clear();bY=_.map(function(b1){return b1.Worker;},_.ofSeq(bV.WorkItems));bZ=u.allOutPorts(bY);b0=u.allInPorts(bY);_.iter(function(b1){var b2;b2=B.Create([]);_.iter(function(b3){var b4;b4=A.get_Create();bj.Set(b4.OptWorker,bf.tryFind(function(b5){return b5.Worker.Key===b3.WorkerKey;},_.ofSeq(bV.WorkItems)));bj.Set(b4.OptInPort,bf.tryFind(function(b5){return b5.get_Key()===b3.InPortKey;},b0));bj.Set(b4.OptOutPort,bf.tryFind(function(b5){return b5.Key===b3.OutPortKey;},bZ));b2.CellItems.Append(b4);},b1.RuleChain);bW.Append(b2);},bX.RuleContainer);};J.CopyToRules=function(bV){return x.New(_.map(function(bW){return w.New(_.map(function(bX){var bY,bZ,b0;return v.New((bY=bX.OptInPort.c,bY==null?"":bY.$0.get_Key()),(bZ=bX.OptOutPort.c,bZ==null?"":bZ.$0.Key),(b0=bX.OptWorker.c,b0==null?"":b0.$0.Worker.Key));},_.ofSeq(bW.CellItems)));},_.ofSeq(bV)));};K.RulesGroupCreator=function(bV,bW){var bX;bX=H.Create("rules"+a.String(_.length(_.ofSeq(bV.RulesGroups))+1),function(bY){return J.Render(bV,bY);});bV.RulesGroups.Append(bX);return bX;};K.EventsGroupCreator=function(bV,bW,bX){var bY;bY=F.Create("event"+a.String(_.length(_.ofSeq(bV.EventGroups))+1),bW);bV.EventGroups.Append(bY);return bY;};K.PanelGroupCreator=function(bV,bW,bX){var bY;bY=G.Create("panel"+a.String(_.length(_.ofSeq(bV.WidgetGroups))+1),bW());bV.WidgetGroups.Append(bY);return bY;};L=d.Dashboard=_5.Class({Render:function(bV){var bW;bW=this;return bo.EmbedView(bi.Map(function(bX){return bX.$==1?bo.Element("div",[],[bo.Element("table",[],[bo.Element("tr",[],[bo.Element("td",[bt.Style("vertical-align","top")],[bo.Element("table",[],bf.concat([_.ofArray([bo.Element("tr",[],[bo.Element("td",[],[_8.IconNormal("dehaze",function(){bj.Set(bW.PanelTitleVisibility,false);bj.Set(bW.Mode,{$:0});})])])]),_.ofArray([bW.EditorSelectorEdit.get_RenderMenu()]),_.ofArray([bo.Element("tr",[],[bo.Element("td",[],[])]),bo.Element("tr",[],[bo.Element("td",[],[bW.PropertyGrid.get_Render()])])])]))]),bo.Element("td",[bt.Style("vertical-align","top")],[bV,_8.IconNormal("add",function(){var bY,bZ,b0,b1,b2;bY=bW.EditorSelectorEdit.get_SelectedGroupIndex();bY===1?(bZ=_.ofSeq(bW.Factory.EventItems),b0=bj.Create$1(_.head(bZ)),bW.Dialog.ShowDialog("Select source",bo.Element("div",[],[bo.Select([bt.Class("form-control")],function(b3){return b3.Worker.Name.c;},bZ,b0)]),function(){var b3,b4,b5;b3=b0.c.Worker.get_Clone();b3.StartRunner();b4=(b5=_.ofSeq(bW.Data.EventGroups),bf.nth(bW.EditorSelectorEdit.get_SelectedIndexInGroup(),b5));bW.Data.RegisterEvent(_8.UniqueKey(),b4,b3);})):bY===0?bW.CreatePanel((b1=_.ofSeq(bW.Data.WidgetGroups),bf.nth(bW.EditorSelectorEdit.get_SelectedIndexInGroup(),b1)),"Panel",700,null):bY===2?(b2=_.ofSeq(bW.Data.RulesGroups),bf.nth(bW.EditorSelectorEdit.get_SelectedIndexInGroup(),b2)).RulesRowItems.Append(B.Create([A.get_Create(),A.get_Create()])):void 0;}),bW.EditorSelectorEdit.get_Render()])])]),bo.Element("div",[],[bW.Dialog.get_Render()])]):bo.Element("div",[],[bo.Element("table",[],[bo.Element("tr",[],[bo.Element("td",[bt.Style("vertical-align","top")],[_8.IconNormal("dehaze",function(){bj.Set(bW.PanelTitleVisibility,true);bj.Set(bW.Mode,{$:1});}),bW.EditorSelectorRun.GroupByIndex(0).SelectorItems.get_Length()>1?bW.EditorSelectorRun.get_RenderMenu():bo.Element("div",[],[])]),bo.Element("td",[],[bW.EditorSelectorRun.get_Render()])])])]);},this.Mode.v));},Restore:function(bV,bW,bX,bY){var bZ,b0,b1,b2,b3,b4,b5,b6;function b7(b8,b9){b9.Reconnect(b5);}bZ=this;b0=h.Agent();b0.mailbox.AddLast(m.Stop);b0.resume();this.EditorSelectorRun.ClearGroups();this.EditorSelectorEdit.ClearGroups();this.Data.get_Clear();this.PropertyGrid.Edit(_.T.Empty);b1=this.EditorSelectorRun.GroupByIndex(0);b2=this.EditorSelectorEdit.GroupByIndex(0);b3=this.EditorSelectorEdit.GroupByIndex(1);b4=this.EditorSelectorEdit.GroupByIndex(2);_.iteri(function(b8,b9){var b_,b$;function ca(cb,cc,cd){bZ.RegisterWidget(cb,b$,cc,bf.find(function(ce){return ce.Key===cc;},_.ofSeq(b$.PanelContainer.PanelItems)).Children,(cd.StartRunner(),cd));}b_=K.PanelGroupCreator(bZ.Data,bV,null);bj.Set(b_.WebSharper_Community_Dashboard_ISelectorItem$get_Name(),b9[0]);b2.SelectorItems.Append(b_);b1.SelectorItems.Append(b_);b$=bf.nth(b8,_.ofSeq(bZ.Data.WidgetGroups));_.iter(function(cb){var cc;cc=bZ.CreatePanel(b$,"Panel",700,{$:1,$0:cb.Key});bj.Set(cc.Left,cb.Left);bj.Set(cc.Top,cb.Top);},b9[1]);return _.iter(function(cb){return ca(cb[0],cb[1],cb[2]);},b9[2]);},bX);bw.log("Widgets restored");_.iteri(function(b8,b9){var b_,b$;function ca(cb,cc){bZ.Data.RegisterEvent(cb,b$,cc);}b_=K.EventsGroupCreator(bZ.Data,bZ.PropertyGrid,null);bj.Set(b_.WebSharper_Community_Dashboard_ISelectorItem$get_Name(),b9[0]);b3.SelectorItems.Append(b_);b$=bf.nth(b8,_.ofSeq(bZ.Data.EventGroups));return _.iter(function(cb){return ca(cb[0],cb[1]);},b9[1]);},bW);bw.log("Events restored");_.iteri(function(b8,b9){var b_;b_=K.RulesGroupCreator(bZ.Data,null);bj.Set(b_.WebSharper_Community_Dashboard_ISelectorItem$get_Name(),b9[0]);b4.SelectorItems.Append(b_);return J.Restore(bZ.Data,bf.nth(b8,_.ofSeq(bZ.Data.RulesGroups)).RulesRowItems,b9[1]);},bY);this.Data.WidgetGroups.get_Length()>0?(bj.Set(this.EditorSelectorEdit.OptSelectedItem,{$:1,$0:_.head(_.ofSeq(this.EditorSelectorEdit.GroupByIndex(0).SelectorItems))}),bj.Set(this.EditorSelectorRun.OptSelectedItem,{$:1,$0:_.head(_.ofSeq(this.EditorSelectorRun.GroupByIndex(0).SelectorItems))})):(bj.Set(this.EditorSelectorEdit.OptSelectedItem,null),bj.Set(this.EditorSelectorRun.OptSelectedItem,null));b5=_.map(function(b8){return b8.Worker;},_.ofSeq(this.Data.WorkItems));_.iter(function(b8){return b7(b8[0],b8[1]);},bY);b6=h.Agent();b6.mailbox.AddLast(m.Start);b6.resume();bw.log("Connectors restored");return[_.concat(_.map(function(b8){return _.map(function(b9){return b9.Worker;},_.ofSeq(b8.EventItems));},_.ofSeq(this.Data.EventGroups))),_.concat(_.map(function(b8){return _.map(function(b9){return b9.Widget;},_.ofSeq(b8.WidgetItems));},_.ofSeq(this.Data.WidgetGroups)))];},Store:function(bV){function bW(bY,bZ){var b0;b0=bV(bZ);return b0==null?bY:new _.T({$:1,$0:[bZ.Key,b0.$0],$1:bY});}function bX(bY,bZ,b0){var b1;b1=bV(b0);return b1==null?bY:new _.T({$:1,$0:[b0.Key,bZ,b1.$0],$1:bY});}return[_.map(function(bY){return[bY.Name.c,_.rev(bf.fold(function(bZ,b0){return bW(bZ,b0.Worker);},_.T.Empty,_.ofSeq(bY.EventItems)))];},_.ofSeq(this.Data.EventGroups)),_.map(function(bY){return[bY.Name.c,_.map(function(bZ){return bZ.get_PanelData();},_.ofSeq(bY.PanelContainer.PanelItems)),_.rev(bf.fold(function(bZ,b0){return bX(bZ,b0.Panel,b0.Widget);},_.T.Empty,_.ofSeq(bY.WidgetItems)))];},_.ofSeq(this.Data.WidgetGroups)),_.map(function(bY){return[bY.Name.c,J.CopyToRules(bY.RulesRowItems)];},_.ofSeq(this.Data.RulesGroups))];},CreatePanel:function(bV,bW,bX,bY){var bZ,b0,b1,b2,b3,b4;bZ=this;bo.ConvertBy(bV.WidgetItems.key,function(b5){return bo.Element("div",[],[bo.TextView(b5.Widget.Name.v)]);},bV.WidgetItems.v);b0=(b1=(b2=bn.NewGuid(),a.String(b2)),bY==null?b1:bY.$0);b3=bx.get_Create().WithLayoutManager(by.StackPanelLayoutManager()).WithAttributes([bt.Style("border","1px solid white"),bt.Style("display","flex")]);b4=bz.get_Create().WithKey(b0).WithPannelAttrs([bt.Style("Width",a.String(bX)+"px"),bt.Style("position","absolute")]).WithTitle(this.PanelTitleVisibility).WithTitleContent(bo.TextNode(bW)).WithTitleButtons(_.ofArray([bA.New("add",function(b5){var b6,b7;b6=_.ofSeq(bZ.Factory.WidgetItems);b7=bj.Create$1(_.head(b6));bZ.Dialog.ShowDialog("Select widget",bo.Element("div",[],[bo.Select([bt.Class("form-control")],function(b8){return b8.Worker.Name.c;},b6,b7)]),function(){var b8;bw.log("Dialog.IsOK");b8=b7.c.Worker.get_Clone();b8.StartRunner();bZ.RegisterWidget(_8.UniqueKey(),bV,b5.Key,b5.Children,b8);});}),bA.New("edit",function(b5){bw.log("Edit");bZ.PropertyGrid.Edit(_.concat(_.map(function(b6){return b6.Widget.get_Properties();},_.filter(function(b6){return b6.Panel===b5.Key;},_.ofSeq(bV.WidgetItems)))));}),bA.New("clear",function(b5){bV.PanelContainer.PanelItems.Remove(bV.PanelContainer.FindPanelItem(b5));bV.WidgetItems.RemoveBy(function(b6){return b6.Panel===b5.Key;});})])).WithChildPanelContainer(b3);bV.PanelContainer.AddPanel(b4);return b4;},RegisterWidget:function(bV,bW,bX,bY,bZ){var b0;this.Data.RegisterWidget(bV,bW,bX,bZ);b0=bz.get_Create().WithPanelContent(bZ.get_Render());bj.Set(b0.IsWithTitle,false);bY.AddPanel(b0);}},null,L);L.Create=function(bV){var bW,bX,bY,bZ,b0,b1;function b2(){return K.PanelGroupCreator(bX,bV,void 0);}function b3(){return K.EventsGroupCreator(bX,bY,void 0);}function b4(){return K.RulesGroupCreator(bX,void 0);}bW=bB.get_Create();bX=I.get_Create();bY=bC.get_Create();bZ=D.get_Create();b0=D.get_Create().WithGroupOnClick(function(b5){bY.Edit(_.mapi(function(b6,b7){var b8;return bl.string((b8=b6+1,a.String(b8)),b7.WebSharper_Community_Dashboard_ISelectorItem$get_Name());},_.ofSeq(b5.SelectorItems)));}).WithItemOnSelected(function(){bY.Edit(_.T.Empty);}).WithItemOnCreated(function(b5){return function(b6){return b5===0?_.head(_.ofSeq(bZ.SelectorGroups)).SelectorItems.Append(b6):null;};}).WithItemOnDeleted(function(){return function(){return null;};}).WithItemOnDeleted(function(b5){return function(b6){b6 instanceof G?bX.WidgetGroups.Remove(b6):b6 instanceof F?bX.EventGroups.Remove(b6):b6 instanceof H?bX.RulesGroups.Remove(b6):_6.FailWith("WithItemOnDeleted, type unknown");return b5===0?_.head(_.ofSeq(bZ.SelectorGroups)).SelectorItems.Remove(b6):null;};}).WithItemOnMove(_5.Curried3(function(b5,b6,b7){var b8;b8=b7.$==1&&true;return b6 instanceof G?(_8.MoveItemInModelList(bX.WidgetGroups,b8,b6),_8.MoveItemInModelList(_.head(_.ofSeq(bZ.SelectorGroups)).SelectorItems,b8,b6)):b6 instanceof F?_8.MoveItemInModelList(bX.EventGroups,b8,b6):b6 instanceof H?_8.MoveItemInModelList(bX.RulesGroups,b8,b6):_6.FailWith("WithItemOnDeleted, type unknown");})).WithControls(true);b1=b2();b0.AppenGroup("Panels",_.ofArray([b1]),{$:1,$0:b2});bZ.AppenGroup("Panels",_.ofArray([b1]),null);b0.AppenGroup("Events",_.ofArray([b3()]),{$:1,$0:b3});b0.AppenGroup("Rules",_.ofArray([b4()]),{$:1,$0:b4});bj.Set(b0.OptSelectedItem,{$:1,$0:_.head(_.ofSeq(b0.GroupByIndex(0).SelectorItems))});bj.Set(bZ.OptSelectedItem,{$:1,$0:_.head(_.ofSeq(bZ.GroupByIndex(0).SelectorItems))});return L.New(z.get_Create(),bX,bY,bW,bZ,b0,bj.Create$1({$:0}),bj.Create$1(false));};L.New=function(bV,bW,bX,bY,bZ,b0,b1,b2){return new L({Factory:bV,Data:bW,PropertyGrid:bX,Dialog:bY,EditorSelectorRun:bZ,EditorSelectorEdit:b0,Mode:b1,PanelTitleVisibility:b2});};N=M.RandomEvent=_5.Class({WebSharper_Community_Dashboard_IWorkerData$get_Render:function(){return null;},WebSharper_Community_Dashboard_IWorkerData$get_Run:function(){return{$:1,$0:function(bV){var bW;new bD.New();$.Start((bW=null,$.Delay(function(){return $.While(function(){return true;},$.Delay(function(){return $.Bind($.Sleep(bV.InPorts.get_Item(2).get_Number()*1000>>0),function(){var bX,bY,bZ;bX=bV.InPorts.get_Item(0).get_Number();bY=bV.InPorts.get_Item(1).get_Number();bZ=bE.random()*bY+bX;bV.OutPorts.get_Item(0).Trigger(new i({$:0,$0:bZ}));return $.Zero();});}));})),null);return null;}};},WebSharper_Community_Dashboard_IWorkerData$get_Data:function(){return this.RandomEventData;}},null,N);N.get_FromWorker=function(){return function(bV){return N.New(bV.get_ToData());};};N.get_Create=function(){return N.New(s.Create("Random",_.ofArray([p.CreateNumber("Middle value",100),p.CreateNumber("Dispersion",10),p.CreateNumber("Delay sec.",2)]),_.ofArray([r.Create("Random value")])));};N.New=function(bV){return new N({RandomEventData:bV});};O.New=function(bV){return{DatabaseEventRun:bV};};P=M.DatabaseEvent=_5.Class({WebSharper_Community_Dashboard_IWorkerData$get_Render:function(){return null;},WebSharper_Community_Dashboard_IWorkerData$get_Run:function(){return{$:1,$0:function(bV){var bW;bW=true;bi.Sink(function(bX){bW?(_.iter(function(bY){var bZ;bZ=h.Agent();bZ.mailbox.AddLast({$:0,$0:bY});bZ.resume();},(new bb.New()).Sync("WebSharper.Community.Dashboard:WebSharper.Community.Dashboard.Events.ServerDatabase.ReadAllMessages:965639103",[bV.InPorts.get_Item(1).get_String()])),bW=false):(new bb.New()).Send("WebSharper.Community.Dashboard:WebSharper.Community.Dashboard.Events.ServerDatabase.WriteMessage:-353093100",[bV.InPorts.get_Item(1).get_String(),bX]);},bV.InPorts.get_Item(0).PortValue.v);return null;}};},WebSharper_Community_Dashboard_IWorkerData$get_Data:function(){return this.DatabaseEventData;}},null,P);P.get_FromWorker=function(){return function(bV){return P.New(bV.get_ToData());};};P.get_Create=function(){return P.New(s.Create("Database",_.ofArray([p.CreateNumber(" in Value",100),p.CreateString("Database name","Database.txt")]),_.T.Empty));};P.New=function(bV){return new P({DatabaseEventData:bV});};R.New=function(bV,bW,bX,bY,bZ){return{Title:bV,Description:bW,ImageUrl:bX,Temperature:bY,TemparatureMinMax:bZ};};Q.get=function(bV,bW){var bX;bX=null;return $.Delay(function(){var bY;bY=(((_5.Curried3(function(bZ,b0,b1){return bZ("http://api.openweathermap.org/data/2.5/weather?q="+bc.toSafe(b0)+"&units=metric&appid="+bc.toSafe(b1));}))(a.id))(bW))(bV);(e.Log())("get key city "+bY);return $.TryWith($.Delay(function(){return $.Bind(bG.AsyncMap(bK.asyncReadTextAtRuntime(false,"C:\\AEAFrame\\WebSharper.Community.Dashboard\\WebSharper.Community.Dashboard","","JSON","",bY),function(bZ){return bs.Equals(typeof bZ,"string")?bL.parse(bZ):bZ;}),function(bZ){var b0,b1,b2,b3,b4,b5,b6,b7,b8,b9,b_,b$,ca,cb,cc,cd,ce,cf,cg,ch,ci,cj,ck;(e.Log())("get key city 2");return $.Return((b0=bM.tryHead(bZ.weather),b0==null?null:{$:1,$0:(b1=b0.$0,R.New((((_5.Curried3(function(cl,cm,cn){return cl(bc.toSafe(cm)+", "+bc.toSafe(cn));}))(a.id))((b3=(b2="name",b2 in bZ?{$:1,$0:bZ[b2]}:null),b3==null?null:b3.$0)))((b6=(b4=bZ.sys,(b5="country",b5 in b4?{$:1,$0:b4[b5]}:null)),b6==null?null:b6.$0)),(b8=(b7="main",b7 in b1?{$:1,$0:b1[b7]}:null),b8==null?null:b8.$0),(function(cl){return function(cm){return cl("http://openweathermap.org/img/w/"+bc.toSafe(cm)+".png");};}(a.id))((b_=(b9="icon",b9 in b1?{$:1,$0:b1[b9]}:null),b_==null?null:b_.$0)),(b$=(ca=bZ.main,(cb="temp",cb in ca?{$:1,$0:ca[cb]}:null)),(cc=b$==null?null:{$:1,$0:1*b$.$0},cc==null?null:cc.$0)),[(cd=(ce=bZ.main,(cf="temp_min",cf in ce?{$:1,$0:ce[cf]}:null)),(cg=cd==null?null:{$:1,$0:1*cd.$0},cg==null?null:cg.$0)),(ch=(ci=bZ.main,(cj="temp_max",cj in ci?{$:1,$0:ci[cj]}:null)),(ck=ch==null?null:{$:1,$0:1*ch.$0},ck==null?null:ck.$0))]))}));});}),function(bZ){(e.Log())(bZ.message);return $.Return(null);});});};S=M.OpenWeatherEvent=_5.Class({WebSharper_Community_Dashboard_IWorkerData$get_Render:function(){return null;},WebSharper_Community_Dashboard_IWorkerData$get_Run:function(){return{$:1,$0:function(bV){var bW;$.Start((bW=null,$.Delay(function(){return $.While(function(){return true;},$.Delay(function(){var bX,bY,bZ;bX=bV.InPorts.get_Item(0);bY=bV.InPorts.get_Item(1);bZ=bV.OutPorts.get_Item(0);return $.Bind(Q.get(bY.get_String(),bX.get_String()),function(b0){return $.Combine(b0==null?$.Zero():((e.Log())("Value generated:"+b0.$0.Title),bZ.Trigger(new i({$:0,$0:+b0.$0.Temperature})),$.Zero()),$.Delay(function(){return $.Bind($.Sleep(1000*15),function(){return $.Return(null);});}));});}));})),null);return null;}};},WebSharper_Community_Dashboard_IWorkerData$get_Data:function(){return this.OpenWeatherEventData;}},null,S);S.get_FromWorker=function(){return function(bV){return S.New(bV.get_ToData());};};S.Create=function(bV,bW){return S.New(s.Create("OpenWeatherMap",_.ofArray([p.CreateString("City",bV),p.CreateString("ApiKey",bW)]),_.ofArray([r.Create("Temperature")])));};S.New=function(bV){return new S({OpenWeatherEventData:bV});};T=M.ClockEvent=_5.Class({WebSharper_Community_Dashboard_IWorkerData$get_Render:function(){return null;},WebSharper_Community_Dashboard_IWorkerData$get_Run:function(){return{$:1,$0:function(bV){var bW;$.Start((bW=null,$.Delay(function(){return $.While(function(){return true;},$.Delay(function(){var bX,bY,bZ;bX=(bV.InPorts.get_Item(0).PortValue.c.Value.get_AsSelect())[0];bY=_9.now();bZ=bX===0?bN.LongTime(bY):bX===1?bN.ShortTime(bY):bX===2?bN.LongDate(bY):bX===3?(new _9(bY)).toLocaleDateString():"";bV.OutPorts.get_Item(0).Trigger(new i({$:1,$0:bZ}));return $.Bind($.Sleep(bV.InPorts.get_Item(1).get_Number()*1000>>0),function(){var b0;b0=(function(b1){return function(b2){return b1("Time value generated "+bc.toSafe(b2));};}(a.id))(bZ);(e.Log())(b0);return $.Zero();});}));})),null);return null;}};},WebSharper_Community_Dashboard_IWorkerData$get_Data:function(){return this.ClockEventData;}},null,T);T.get_FromWorker=function(){return function(bV){return T.New(bV.get_ToData());};};T.get_Create=function(){return T.New(s.Create("Clock",_.ofArray([p.CreateSelect("Format",[0,_.ofArray(["long time","short time","long date","short date"])]),p.CreateNumber("Delay sec.",1)]),_.ofArray([r.Create("Date Time")])));};T.New=function(bV){return new T({ClockEventData:bV});};V=U.TextBoxWidget=_5.Class({WebSharper_Community_Dashboard_IWorkerData$get_Render:function(){return{$:1,$0:function(bV){var bW;bW=bi.Map(function(bX){var bY,bZ;bY=bX.Value;return bY.$==0?(bZ=bY.$0>>0,a.String(bZ)):bY.$==1?bY.$0:bY.$==2?a.String(bY.$0):"Wrong port value format";},bV.InPorts.get_Item(0).PortValue.v);return bo.Element("div",[bt.Class("bigvalue")],[bo.TextView(bW)]);}};},WebSharper_Community_Dashboard_IWorkerData$get_Run:function(){return null;},WebSharper_Community_Dashboard_IWorkerData$get_Data:function(){return this.TextBoxWidgetData;}},null,V);V.get_FromWorker=function(){return function(bV){return V.New(bV.get_ToData());};};V.get_Create=function(){return V.New(s.Create("Text",_.ofArray([p.CreateNumber("in Value",0)]),_.T.Empty));};V.New=function(bV){return new V({TextBoxWidgetData:bV});};W.New=function(bV,bW){return{LineChart:bV,Sources:bW};};X=U.ChartWidget=_5.Class({WebSharper_Community_Dashboard_IWorkerData$get_Render:function(){return{$:1,$0:function(bV){var bW,bX,bY,bZ,b0,b1,b2,b3,b4;bW=bV.InPorts.get_Item(3).get_Number()>>0;bX=bV.RunnerContext.c.$0;bY=(bZ={},bZ.title=(b0={},b0.display=false,b0),bZ.legend=(b1={},b1.display=false,b1),bZ.elements=(b2={},b2.point=(b3={},b3.radius=0,b3),b2.line=(b4={},b4.borderWidth=1,b4),b2),bZ);return bQ.Render$2(bX.LineChart,{$:1,$0:{$:0,$0:bV.InPorts.get_Item(1).get_Number()>>0,$1:bV.InPorts.get_Item(2).get_Number()>>0}},{$:1,$0:bY},{$:1,$0:bW});}};},WebSharper_Community_Dashboard_IWorkerData$get_Run:function(){var bV;bV=this;return{$:1,$0:function(bW){var bX,bY,bZ,b0;function b1(b2,b3){var b4,b5;b4=(bW.InPorts.get_Item(4).PortValue.c.Value.get_AsSelect())[0];b5=b4===0?bN.LongTime(b3.Time):b4===1?bN.ShortTime(b3.Time):b4===2?bN.LongDate(b3.Time):b4===3?(new _9(b3.Time)).toLocaleDateString():"";return bX.get_Item(bf.findIndex(function(b6){return bs.Equals(b6,b2);},bZ)).event.Trigger([b5,b3.Value.get_AsNumber()]);}bW.InPorts.get_Item(3).get_Number();bX=_.init((bV.ChartWidgetData.InPorts.get_Item(5).Value.Value.get_AsNumber()>>0)+1,function(){return new bR.New();});bY=(_.splitAt(6,bW.InPorts))[1];bZ=new _.T({$:1,$0:bW.InPorts.get_Item(0),$1:bY});b0=bS.Combine(_.ofSeq(bf.delay(function(){return bf.map(function(b2){return bT.Line$1(b2.event).WithFill(false).__WithStrokeColor(new bU.Color({$:1,$0:"#FB8C00"})).__WithPointColor(new bU.Color({$:2,$0:"black"}));},bX);})));_.iter(function(b2){bi.Sink(function(b3){return b1(b2,b3);},b2.PortValue.v);},bZ);return{$:1,$0:W.New(b0,bX)};}};},WebSharper_Community_Dashboard_IWorkerData$get_Data:function(){var bV,bW,bX,bY,bZ;bV=this;bW=this.ChartWidgetData.InPorts.get_Item(3).Value.Value.get_AsNumber()>>0;bX=(this.ChartWidgetData.InPorts.get_Item(5).Value.Value.get_AsNumber()>>0)+6;bZ=this.ChartWidgetData;return s.New(bZ.WorkerName,_.mapi(function(b0,b1){return b0===0||b0>5?b1.WithCacheSize(bW):b1;},bX<this.ChartWidgetData.InPorts.get_Length()?(_.splitAt(bX,this.ChartWidgetData.InPorts))[0]:bX>this.ChartWidgetData.InPorts.get_Length()?(bY=this.ChartWidgetData.InPorts.get_Length()-6+1,_.append(this.ChartWidgetData.InPorts,_.ofSeq(bf.delay(function(){return bf.map(function(b0){var b1;return p.CreateNumber(" in Value "+(b1=bY+b0,a.String(b1)),0).WithCacheSize(bW);},_6.range(0,bX-bV.ChartWidgetData.InPorts.get_Length()-1));})))):this.ChartWidgetData.InPorts),bZ.OutPorts);}},null,X);X.get_FromWorker=function(){return function(bV){return X.New(bV.get_ToData());};};X.get_Create=function(){var bV;bV=20;return X.New(s.Create("Chart",_.ofArray([p.CreateNumber(" in Value",100).WithCacheSize(bV),p.CreateNumber("cx",300),p.CreateNumber("cy",150),p.CreateNumber("BufferSize",bV),p.CreateSelect("X-Axis",[0,_.ofArray(["long time","short time","long date","short date"])]),p.CreateNumber("Number of additional ports",0)]),_.T.Empty));};X.New=function(bV){return new X({ChartWidgetData:bV});};Y=U.ButtonWidget=_5.Class({WebSharper_Community_Dashboard_IWorkerData$get_Render:function(){return{$:1,$0:function(bV){return bo.ButtonView(bV.InPorts.get_Item(0).get_String(),[],bV.InPorts.get_Item(1).get_BooleanView(),function(bW){bV.OutPorts.get_Item(0).Trigger(new i({$:2,$0:bW}));});}};},WebSharper_Community_Dashboard_IWorkerData$get_Run:function(){return null;},WebSharper_Community_Dashboard_IWorkerData$get_Data:function(){return this.ButtonWidgetData;}},null,Y);Y.get_FromWorker=function(){return function(bV){return Y.New(bV.get_ToData());};};Y.get_Create=function(){return Y.New(s.Create("Button",_.ofArray([p.CreateString("Caption","Button"),p.CreateNumber("State",0)]),_.ofArray([r.Create("Button value")])));};Y.New=function(bV){return new Y({ButtonWidgetData:bV});};Z.FromWorker=function(bV){var bW;bW=bV.Data;return bW instanceof N?{$:1,$0:{$:0,$0:(N.get_FromWorker())(bV)}}:bW instanceof T?{$:1,$0:{$:1,$0:(T.get_FromWorker())(bV)}}:bW instanceof S?{$:1,$0:{$:2,$0:(S.get_FromWorker())(bV)}}:bW instanceof P?{$:1,$0:{$:3,$0:(P.get_FromWorker())(bV)}}:bW instanceof V?{$:1,$0:{$:4,$0:(V.get_FromWorker())(bV)}}:bW instanceof X?{$:1,$0:{$:5,$0:(X.get_FromWorker())(bV)}}:bW instanceof Y?{$:1,$0:{$:6,$0:(Y.get_FromWorker())(bV)}}:null;};Z.ToWorker=function(bV){return bV.$==1?t.Create(bV.$0):bV.$==2?t.Create(bV.$0):bV.$==3?t.Create(bV.$0):bV.$==4?t.Create(bV.$0):bV.$==5?t.Create(bV.$0):bV.$==6?t.Create(bV.$0):t.Create(bV.$0);};_0.CreateDashboard=function(){_1.$cctor();return _1.CreateDashboard;};_0.PanelContainerCreator=function(bV){return bx.get_Create().WithLayoutManager(by.FloatingPanelLayoutManager(5)).WithWidth(800).WithHeight(420).WithAttributes([bt.Style("border","1px solid white")]);};_0.RegisterAppModelLib=function(bV){function bW(bY){_0.RegisterEventGeneral(bV,bY);}function bX(bY){_0.RegisterWidgetGeneral(bV,bY);}bW(S.Create("London",""));bW(N.get_Create());bW(T.get_Create());bW(P.get_Create());bX(V.get_Create());bX(X.get_Create());bX(Y.get_Create());return bV;};_0.RegisterWidgetGeneral=function(bV,bW){var bX;_0.Register((bX=bV.Factory,function(bY){bX.RegisterWidget(bY);}),bW);};_0.RegisterEventGeneral=function(bV,bW){var bX;_0.Register((bX=bV.Factory,function(bY){bX.RegisterEvent(bY);}),bW);};_0.Register=function(bV,bW){return bV(t.Create(bW));};_1.$cctor=function(){_1.$cctor=a.ignore;_1.CreateDashboard=_0.RegisterAppModelLib(L.Create(function(){return _0.PanelContainerCreator();}));};_2.RecreatWidgetsOnServer=function(bV,bW){function bX(bZ,b0,b1){return b1;}function bY(bZ,b0,b1){return b1;}return _.map(function(bZ){return bX(bZ[0],bZ[1],bZ[2]);},_.concat(_.map(function(bZ){return bY(bZ[0],bZ[1],bZ[2]);},_2.RecreateWidgets(bV,bW))));};_2.RecreateEventsOnServer=function(bV,bW){function bX(bZ,b0){return b0;}function bY(bZ,b0){return b0;}return _.map(function(bZ){return bX(bZ[0],bZ[1]);},_.concat(_.map(function(bZ){return bY(bZ[0],bZ[1]);},_2.RecreateEvents(bV,bW))));};_2.RecreateOnClient=function(bV,bW,bX,bY,bZ,b0,b1){var b2;e.set_Role(f.Client);b2=h.Agent();b2.mailbox.AddLast({$:3,$0:function(b3){(new bb.New()).Send("WebSharper.Community.Dashboard:WebSharper.Community.Dashboard.MessageBus.SendToServer:-1358505674",[b3]);}});b2.resume();_.iter(bV,(bW.Restore(bX,_2.RecreateEvents(bY,bZ),_2.RecreateWidgets(bY,b0),b1))[0]);};_2.RecreateWidgets=function(bV,bW){function bX(bY,bZ,b0){function b1(b2,b3,b4){return[b2,b3,bV(b4)];}return[bY,bZ,_.map(function(b2){return b1(b2[0],b2[1],b2[2]);},b0)];}return _.map(function(bY){return bX(bY[0],bY[1],bY[2]);},bW);};_2.RecreateEvents=function(bV,bW){function bX(bY,bZ){function b0(b1,b2){return[b1,bV(b2)];}return[bY,_.map(function(b1){return b0(b1[0],b1[1]);},bZ)];}return _.map(function(bY){return bX(bY[0],bY[1]);},bW);};_3=d.AppData=_5.Class({RecreateOnServer:function(bV,bW){var bX,bY,bZ;function b0(b1,b2){b2.Reconnect(bX);}bX=_.append(_2.RecreateEventsOnServer(bW,this.Events),_2.RecreatWidgetsOnServer(bW,this.Widgets));_.iter(function(b1){return b0(b1[0],b1[1]);},this.Rules);_.iter(function(b1){b1.StartRunner();},bX);bY={$:0,$0:h.CreateMessage(new i({$:4,$0:{$:0,$0:bV}})).WithKey("system")};bZ=h.Agent();bZ.mailbox.AddLast(bY);bZ.resume();return bX;},RecreateOnClientEventsRunning:function(bV,bW,bX){_2.RecreateOnClient(function(bY){bY.StartRunner();},bV,bW,bX,this.Events,this.Widgets,this.Rules);},RecreateOnClientEventsNotRunning:function(bV,bW,bX){_2.RecreateOnClient(a.ignore,bV,bW,bX,this.Events,this.Widgets,this.Rules);}},null,_3);_3.Create=function(bV,bW){var bX;bX=bV.Store(bW);return _3.New(bX[0],bX[1],bX[2]);};_3.empty=function(){return _3.New(_.T.Empty,_.T.Empty,_.T.Empty);};_3.New=function(bV,bW,bX){return new _3({Events:bV,Widgets:bW,Rules:bX});};}());
